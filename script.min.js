!function(){"use strict";function l(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function e(e,t){if(t)e:{var n=c;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&o(n,e,{configurable:!0,writable:!0,value:t})}}function u(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:l(e)}}function t(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function r(e){if(e.i)throw new TypeError("Generator is already running");e.i=!0}function h(e,t){e.h={F:t,G:!0},e.j=e.m}function d(e){this.g=new t,this.h=e}function f(t,e,n,i){try{var r=e.call(t.g.g,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.g.i=!1,r;var o=r.value}catch(e){return t.g.g=null,h(t.g,e),s(t)}return t.g.g=null,i.call(t.g,o),s(t)}function s(t){for(;t.g.j;)try{var e=t.h(t.g);if(e)return t.g.i=!1,{value:e.value,done:!1}}catch(e){t.g.o=void 0,h(t.g,e)}if(t.g.i=!1,t.g.h){if(e=t.g.h,t.g.h=null,e.G)throw e.F;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function p(i){this.next=function(e){return r(i.g),e=i.g.g?f(i,i.g.g.next,e,i.g.l):(i.g.l(e),s(i))},this.throw=function(e){return r(i.g),e=i.g.g?f(i,i.g.g.throw,e,i.g.l):(h(i.g,e),s(i))},this.return=function(e){return e=e,r((t=i).g),(n=t.g.g)?f(t,"return"in n?n.return:function(e){return{value:e,done:!0}},e,t.g.return):(t.g.return(e),s(t));var t,n},this[Symbol.iterator]=function(){return this}}function g(t){function r(e){return t.next(e)}function o(e){return t.throw(e)}return new Promise(function(n,i){!function e(t){t.done?n(t.value):Promise.resolve(t.value).then(r,o).then(e,i)}(t.next())})}e("Symbol",function(e){function n(e,t){this.g=e,o(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new n(i+(t||"")+"_"+r++,t)}}),e("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&o(i.prototype,e,{configurable:!0,writable:!0,value:function(){return(e={next:e=l(this)})[Symbol.iterator]=function(){return this},e;var e}})}return e}),t.prototype.l=function(e){this.o=e},t.prototype.return=function(e){this.h={return:e},this.j=this.m},e("Promise",function(e){function s(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.g=null}function a(t){return t instanceof s?t:new s(function(e){e(t)})}if(e)return e;t.prototype.h=function(e){var t;null==this.g&&(this.g=[],(t=this).i(function(){t.l()})),this.g.push(e)};var n=c.setTimeout,r=(t.prototype.i=function(e){n(e,0)},t.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},t.prototype.j=function(e){this.i(function(){throw e})},s.prototype.j=function(){function e(t){return function(e){i||(i=!0,t.call(n,e))}}var n=this,i=!1;return{resolve:e(this.A),reject:e(this.l)}},s.prototype.A=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof s)this.C(e);else{switch(typeof e){case"object":var t=null!=e;break;case"function":t=!0;break;default:t=!1}t?this.v(e):this.m(e)}},s.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.D(t,e):this.m(e)},s.prototype.l=function(e){this.u(2,e)},s.prototype.m=function(e){this.u(1,e)},s.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.B(),this.H()},s.prototype.B=function(){var t=this;n(function(){var e;!t.I()||void 0!==(e=c.console)&&e.error(t.i)},1)},s.prototype.I=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},s.prototype.H=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)r.h(this.g[e]);this.g=null}},new t);return s.prototype.C=function(e){var t=this.j();e.s(t.resolve,t.reject)},s.prototype.D=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},s.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){r(e)}}:e}var i,r,o=new s(function(e,t){i=e,r=t});return this.s(n(e,i),n(t,r)),o},s.prototype.catch=function(e){return this.then(void 0,e)},s.prototype.s=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?r.h(n):this.g.push(n),this.o=!0},s.resolve=a,s.reject=function(n){return new s(function(e,t){t(n)})},s.race=function(r){return new s(function(e,t){for(var n=u(r),i=n.next();!i.done;i=n.next())a(i.value).s(e,t)})},s.all=function(e){var t=u(e),o=t.next();return o.done?a([]):new s(function(n,e){for(var i=[],r=0;i.push(void 0),r++,a(o.value).s(function(t){return function(e){i[t]=e,0==--r&&n(i)}}(i.length-1),e),!(o=t.next()).done;);})},s});var v="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},m=(e("Object.assign",function(e){return e||v}),this||self),_={facingMode:"user",width:640,height:480};function y(e,t){this.video=e,this.i=0,this.h=Object.assign(Object.assign({},_),t)}function w(n){window.requestAnimationFrame(function(){var e,t;t=null,(e=n).video.paused||e.video.currentTime===e.i||(e.i=e.video.currentTime,t=e.h.onFrame()),t?t.then(function(){w(e)}):w(e)})}y.prototype.stop=function(){var t,n,i,r=this;return g(new p(new d(function(e){if(r.g){for(t=r.g.getTracks(),n=u(t),i=n.next();!i.done;i=n.next())i.value.stop();r.g=void 0}e.j=0})))},y.prototype.start=function(){var t,n=this;return g(new p(new d(function(e){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),t=n.h,e.return(navigator.mediaDevices.getUserMedia({video:{facingMode:t.facingMode,width:t.width,height:t.height},audio:!0}).then(function(e){var t;window.localStream=e,window.my_stream_id=window.localStream.id,window.updateState(window.my_stream_id,{vid:window.my_stream_id}),e=e,(t=n).g=e,t.video.srcObject=e,t.video.onloadedmetadata=function(){t.video.play(),w(t)}}).catch(function(e){var t="Failed to acquire camera feed: "+e;throw console.error(t),alert(t),e}))})))};var n,i=["Camera"],a=m;i[0]in a||void 0===a.execScript||a.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length?a=a[n]&&a[n]!==Object.prototype[n]?a[n]:a[n]={}:a[n]=y}.call(this),function(){"use strict";function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function e(e,t){if(t)e:{var n=o;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}function u(e){if(!(e instanceof Array)){e=c(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}e("Symbol",function(e){function n(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new n(i+(t||"")+"_"+r++,t)}}),e("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=o[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return(e={next:e=r(this)})[Symbol.iterator]=function(){return this},e;var e}})}return e});var i,l,h="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{e:{var d={};try{d.__proto__={a:!0},l=d.a;break e}catch(e){}l=!1}i=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var f=i;function p(){this.j=!1,this.h=null,this.l=void 0,this.g=1,this.o=0,this.i=null}function y(e){if(e.j)throw new TypeError("Generator is already running");e.j=!0}function w(e,t){e.i={L:t,M:!0},e.g=e.o}function s(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new p,this.h=e}function C(t,e,n,i){try{var r=e.call(t.g.h,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.g.j=!1,r;var o=r.value}catch(e){return t.g.h=null,w(t.g,e),S(t)}return t.g.h=null,i.call(t.g,o),S(t)}function S(t){for(;t.g.g;)try{var e=t.h(t.g);if(e)return t.g.j=!1,{value:e.value,done:!1}}catch(e){t.g.l=void 0,w(t.g,e)}if(t.g.j=!1,t.g.i){if(e=t.g.i,t.g.i=null,e.M)throw e.L;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function x(i){this.next=function(e){return y(i.g),e=i.g.h?C(i,i.g.h.next,e,i.g.m):(i.g.m(e),S(i))},this.throw=function(e){return y(i.g),e=i.g.h?C(i,i.g.h.throw,e,i.g.m):(w(i.g,e),S(i))},this.return=function(e){return e=e,y((t=i).g),(n=t.g.h)?C(t,"return"in n?n.return:function(e){return{value:e,done:!0}},e,t.g.return):(t.g.return(e),S(t));var t,n},this[Symbol.iterator]=function(){return this}}function g(e,t){return t=new x(new b(t)),f&&e.prototype&&f(t,e.prototype),t}p.prototype.m=function(e){this.l=e},p.prototype.return=function(e){this.i={return:e},this.g=this.o};var T="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function t(e){return e||Array.prototype.fill}e("Object.assign",function(e){return e||T}),e("Promise",function(e){function s(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.g=null}function a(t){return t instanceof s?t:new s(function(e){e(t)})}if(e)return e;t.prototype.h=function(e){var t;null==this.g&&(this.g=[],(t=this).i(function(){t.l()})),this.g.push(e)};var n=o.setTimeout,r=(t.prototype.i=function(e){n(e,0)},t.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},t.prototype.j=function(e){this.i(function(){throw e})},s.prototype.j=function(){function e(t){return function(e){i||(i=!0,t.call(n,e))}}var n=this,i=!1;return{resolve:e(this.G),reject:e(this.l)}},s.prototype.G=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof s)this.I(e);else{switch(typeof e){case"object":var t=null!=e;break;case"function":t=!0;break;default:t=!1}t?this.F(e):this.m(e)}},s.prototype.F=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.J(t,e):this.m(e)},s.prototype.l=function(e){this.u(2,e)},s.prototype.m=function(e){this.u(1,e)},s.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.H(),this.A()},s.prototype.H=function(){var t=this;n(function(){var e;!t.D()||void 0!==(e=o.console)&&e.error(t.i)},1)},s.prototype.D=function(){if(this.o)return!1;var e=o.CustomEvent,t=o.Event,n=o.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},s.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)r.h(this.g[e]);this.g=null}},new t);return s.prototype.I=function(e){var t=this.j();e.v(t.resolve,t.reject)},s.prototype.J=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},s.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){r(e)}}:e}var i,r,o=new s(function(e,t){i=e,r=t});return this.v(n(e,i),n(t,r)),o},s.prototype.catch=function(e){return this.then(void 0,e)},s.prototype.v=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?r.h(n):this.g.push(n),this.o=!0},s.resolve=a,s.reject=function(n){return new s(function(e,t){t(n)})},s.race=function(r){return new s(function(e,t){for(var n=c(r),i=n.next();!i.done;i=n.next())a(i.value).v(e,t)})},s.all=function(e){var t=c(e),o=t.next();return o.done?a([]):new s(function(n,e){for(var i=[],r=0;i.push(void 0),r++,a(o.value).v(function(t){return function(e){i[t]=e,0==--r&&n(i)}}(i.length-1),e),!(o=t.next()).done;);})},s}),e("Array.from",function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var i=[],r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof r){e=r.call(e);for(var o=0;!(r=e.next()).done;)i.push(t.call(n,r.value,o++))}else for(r=e.length,o=0;o<r;o++)i.push(t.call(n,e[o],o));return i}}),e("Array.prototype.fill",function(e){return e||function(e,t,n){var i=this.length||0;for(t<0&&(t=Math.max(0,i+t)),(null==n||i<n)&&(n=i),(n=Number(n))<0&&(n=Math.max(0,i+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}}),e("Int8Array.prototype.fill",t),e("Uint8Array.prototype.fill",t),e("Uint8ClampedArray.prototype.fill",t),e("Int16Array.prototype.fill",t),e("Uint16Array.prototype.fill",t),e("Int32Array.prototype.fill",t),e("Uint32Array.prototype.fill",t),e("Float32Array.prototype.fill",t),e("Float64Array.prototype.fill",t),e("Array.prototype.keys",function(e){return e||function(){return n=function(e){return e},(t=this)instanceof String&&(t+=""),i=0,r=!1,(e={next:function(){var e;return!r&&i<t.length?(e=i++,{value:n(e,t[e]),done:!1}):{done:r=!0,value:void 0}}})[Symbol.iterator]=function(){return e},e;var t,n,i,r,e}}),e("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(e[t]);return n}});var E=this||self;function n(e,t){e=e.split(".");var n,i=E;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function v(o,s){var a=void 0;return new(a=Promise)(function(e,t){function n(e){try{r(s.next(e))}catch(e){t(e)}}function i(e){try{r(s.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,i)}r((s=s.apply(o,void 0)).next())})}var k,P={};function m(e,t){if(t!==P)throw Error("Bad secret");this.g=e}function O(){}if((m.prototype=h(O.prototype)).constructor=m,f)f(m,O);else for(var M in O)"prototype"!=M&&(Object.defineProperties?(k=Object.getOwnPropertyDescriptor(O,M))&&Object.defineProperty(m,M,k):m[M]=O[M]);function I(e,t,n){if(e=document.createElement(e),t&&e.classList.add(t),n)for(n=(t=c(n)).next();!n.done;n=t.next())e.appendChild(n.value);return e}function _(e,t){return I("div",e,t)}function R(e,t){return I("span",e,t)}function A(e){var t=I("img","",void 0);return t.src=e||"",t}function j(e,t){var n=this;this.g=e,this.i={};var i,r=_("dropdown-wrapper",[i=_("dropdown",[_("dropdown-trigger",[this.h=R(),_("arrow")]),this.options=_("dropdown-options")])]);r.onclick=function(){e.C&&e.C(),i.classList.toggle("open"),i.g=function(){e.B&&e.B()}};for(var o={},s=c(e.options),a=s.next();!a.done;o={s:o.s},a=s.next())o.s=a.value,a=void 0,this.options.appendChild(a=R("dropdown-option")),(this.i[o.s.value]=a).textContent=o.s.name,o.s.prefix&&a.prepend(o.s.prefix),a.setAttribute("data-value",o.s.value),a.onclick=function(e){return function(){L(n,e.s.value)}}(o);window.addEventListener("click",function(e){i.contains(e.target)||i.classList.remove("open")}),t.appendChild(r)}function L(e,t){for(var n=c(e.g.options),i=n.next();!i.done;i=n.next()){var i=i.value,r=e.i[i.value];if(i.value===t&&!r.classList.contains("selected"))return(t=e.options.querySelector(".selected"))&&t.classList.remove("selected"),r.classList.add("selected"),e.h.textContent=r.textContent,e.g.onclick(i),1}}function D(e,t){var n=e.options.querySelector(".selected");n&&(n.classList.remove("selected"),e.h.textContent=void 0===t?"":t)}function N(e){this.g=e}function B(){this.i=this.counter=0,this.g=Array.from({length:10}).fill(0)}function F(e,t){e.g.shift(),e.g.push(t);var n=e.j;n.fillStyle="green",n.clearRect(0,0,n.canvas.width,n.canvas.height);for(var i=0;i<10;++i){var r=Math.min(100,Math.max(0,e.g[i]));n.fillRect(10*i+1,100-r+1,8,r)}n.setLineDash([2,2]),n.strokeStyle="#a0a0a0a0",n.lineWidth=2,n.beginPath(),n.moveTo(0,30),n.lineTo(100,30),n.stroke(),n.beginPath(),n.moveTo(0,60),n.lineTo(100,60),n.stroke(),e.h.textContent=t.toFixed(0)+" fps"}function z(e){this.g=e}function U(e,t){t=e.g.discrete?Object.values(e.g.discrete)[t]:t,e.h.textContent=""+t}m.prototype.toString=function(){return this.g},N.prototype.create=function(t,n,e){var i=this,r=e.appendChild(document.createElement("div"));r.classList.add("control-panel-entry"),r.classList.add("control-panel-slider"),(e=r.appendChild(document.createElement("span"))).classList.add("label"),e.textContent=this.g.title,e=new j({options:this.g.options.map(function(e){return Object.assign(Object.assign({},e),{data:null})}),C:function(){r.style.zIndex="1000"},onclick:function(e){n[i.g.field]=e.value,t(),i.g.onselectionchanged&&i.g.onselectionchanged(e)},B:function(){r.style.zIndex="100"}},r),0<this.g.options.length&&L(e,this.g.options[0].value)},N.prototype.update=function(){},B.prototype.create=function(e,t,n){(t=n.appendChild(document.createElement("div"))).classList.add("control-panel-entry"),t.classList.add("control-panel-fps"),e=t.appendChild(document.createElement("canvas")),this.h=t.appendChild(document.createElement("div")),this.h.classList.add("fps-text"),(n=t.appendChild(document.createElement("div"))).classList.add("fps-30"),n.textContent="30",(t=t.appendChild(document.createElement("div"))).classList.add("fps-60"),t.textContent="60",e.width=100,e.height=100,this.j=e.getContext("2d"),F(this,0)},B.prototype.update=function(){},B.prototype.tick=function(){var e=Math.floor(performance.now()/1e3);1<=e-this.i&&(F(this,this.counter),this.i=e,this.counter=0),++this.counter},z.prototype.create=function(t,e,n){var i=this,r=(this.options=e,e=this.g,(n=n.appendChild(document.createElement("div"))).classList.add("control-panel-entry"),n.classList.add("control-panel-slider"),n.appendChild(document.createElement("span"))),o=(r.classList.add("label"),(this.h=n.appendChild(document.createElement("span"))).classList.add("callout"),this.i=n.appendChild(document.createElement("input")));o.classList.add("value"),o.type="range",e.range?(o.min=""+e.range[0],o.max=""+e.range[1],o.step=void 0===e.step?"any":""+e.step):e.discrete&&(o.min="0",o.max=""+(Object.keys(e.discrete).length-1),o.step="1"),o.oninput=function(){U(i,Number(o.value))},o.onchange=function(){var e=Number(o.value);i.g.discrete&&(e=Object.keys(i.g.discrete)[e],Array.isArray(i.g.discrete)&&(e=Number(e))),i.options[i.g.field]=e,t()},r.textContent=e.title},z.prototype.update=function(){var e=this.options[this.g.field],e=this.g.discrete&&!Array.isArray(this.g.discrete)?Object.keys(this.g.discrete).indexOf(e):e;this.i.value=""+e,U(this,e)};var H={facingMode:"user",width:640,height:480},G={allowVideo:!0,allowImage:!0,examples:{videos:[],images:[]}};function V(e){return"https://fonts.gstatic.com/s/i/googlematerialicons/"+e+"/v8/white-24dp/1x/gm_"+e+"_white_24dp.png"}function q(e){this.l=[],this.A=0,this.j=!1,this.g=Object.assign(Object.assign({},G),e),this.g.cameraOptions=Object.assign(Object.assign({},this.g.cameraOptions||{}),H)}function W(e){window.requestAnimationFrame(function(){e.tick()})}function J(e){return v(e,function e(){var t,n,i,r,o=this;return g(e,function(e){return 1==e.g?s(e,v(t=o,function e(){var t,n,i,r,o;return g(e,function(e){if(1==e.g)return s(e,navigator.mediaDevices.getUserMedia({video:!0}),2);if(3!=e.g)return s(e,navigator.mediaDevices.enumerateDevices(),3);for(t=e.l,n=[],i=c(t),r=i.next();!r.done;r=i.next())""!==(o=r.value).label&&"videoinput"===o.kind&&n.push({label:o.label,deviceId:o.deviceId});return e.return(n)})}),2):(n=e.l.map(function(e){return{label:e.label,type:"webcam",N:e,start:function(){return r=e,v(t,function e(){var n,t,i=this;return g(e,function(e){return n=i,t=Object.assign({video:{deviceId:r.deviceId}},i.g.cameraOptions?{facingMode:i.g.cameraOptions.facingMode,width:i.g.cameraOptions.width,height:i.g.cameraOptions.height}:{}),e.return(navigator.mediaDevices.getUserMedia(t).then(function(e){var t;n.m=e,(t=n).video.srcObject=e,t.video.onloadedmetadata=function(){t.video.play(),t.j=!0,W(t)}}).catch(function(e){throw console.error("Failed to acquire camera feed: "+e),alert("Failed to acquire camera feed: "+e),e}))})});var r}}}),i=o.g.examples.videos.map(function(e){return{label:e.name,type:"video",video:t.video,start:function(){Y(t,e.src)}}}),r=o.g.examples.images.map(function(e){return{label:e.name,type:"image",image:t.h,start:function(){Z(t,e.src)}}}),e.return([].concat(u(n),u(i),u(r))))})})}function X(e,n){return v(e,function e(){var t=this;return g(e,function(e){return e=1==e.g?s(e,v(t,function e(){var t,n,i,r=this;return g(e,function(e){if(r.i.parent.style.display="none",r.j=!1,r.m){for(t=r.m.getTracks(),n=c(t),i=n.next();!i.done;i=n.next())i.value.stop();r.m=void 0}e.g=0})}),2):3!=e.g?t.g.onSourceChanged?s(e,t.g.onSourceChanged(n.label,n.type),3):void(e.g=3):s(e,n.start(),0)})})}function Z(e,t){e.h.onload=function(){return v(e,function e(){var t,n=this;return g(e,function(e){return e=(t=n).g.onFrame?s(e,X(n,{label:"file",type:"image",image:n.h,start:function(){return v(t,function e(){var t=this;return g(e,function(e){return s(e,(n=t.h,v(t,function e(){var t=this;return g(e,function(e){return e=t.g&&t.g.onFrame?s(e,t.g.onFrame(n,{width:n.naturalWidth,height:n.naturalHeight}),0):void(e.g=0)})})),0);var n})})}}),0):void(e.g=0)})})},e.h.src=t}function Y(e,t){e.video.onloadedmetadata=function(){return v(e,function e(){var t,n=this;return g(e,function(e){return(t=n).video.loop=!0,e=n.g.onFrame?s(e,X(n,{label:"file",type:"video",video:n.video,start:function(){return v(t,function e(){var t=this;return g(e,function(e){return 1==e.g?t.g&&t.g.onFrame?(t.i.parent.style.display="flex",K(t,0),s(e,t.video.play(),3)):void(e.g=0):(t.D(),t.j=!0,W(t),void(e.g=0))})})}}),0):void(e.g=0)})})},e.video.srcObject=null,e.video.src=t}function K(e,t){var n=e.i.K,i=e.i.track.getBoundingClientRect();e=e.i.parent.getBoundingClientRect(),n.style.left=i.left-e.left+i.width*t+"px"}function $(e){this.g=e}function Q(e){this.h=e}function ee(e,t){this.parent=e,this.options=t,this.g=[],this.h=this.parent.appendChild(document.createElement("div")),this.h.classList.add("control-panel")}function te(e){for(var t=c(e.g),n=t.next();!n.done;n=t.next())n.value.update();e.i&&e.i(e.options)}q.prototype.tick=function(){var e,t,n=this,i=null;this.j&&(this.video.paused||this.video.currentTime===this.A||(this.m||(K(this,this.video.currentTime/this.video.duration),this.i.time.textContent=(e=this.video.currentTime,t=1===(t=Math.floor(e%60).toString()).length?"0"+t:t,(e=1===(e=Math.floor(e/60).toString()).length?"0"+e:e)+":"+t)),this.A=this.video.currentTime,i=this.g.onFrame?this.g.onFrame(this.video,{width:this.video.videoWidth,height:this.video.videoHeight}):null),i?i.then(function(){W(n)}):W(this))},q.prototype.create=function(e,t,n){var d=this,f=this.u=n.appendChild(document.createElement("div")),p=(f.classList.add("control-panel-entry"),f.classList.add("control-panel-source-picker"),_("source-selection"));f.append(p),J(this).then(function(e){var t,l,a,o,n,s,c,u,i,r,h;d.l=e,n=p,(t=d).o=new j({options:t.l.map(function(e){var t=void 0;return"image"===e.type?t=A("https://fonts.gstatic.com/s/i/googlematerialicons/image/v12/gm_grey-24dp/1x/gm_image_gm_grey_24dp.png"):"video"===e.type&&(t=A("https://fonts.gstatic.com/s/i/googlematerialicons/videocam/v12/gm_grey-24dp/1x/gm_videocam_gm_grey_24dp.png")),{name:e.label,value:e.label,data:e,prefix:t}}),onclick:function(e){t.i.parent.style.display="none",e.data.start()},C:function(){t.u.style.zIndex="2000"},B:function(){t.u.style.zIndex="100"}},n),l=d,(a=(n=p).appendChild(document.createElement("input"))).type="file",a.style.display="none",n.appendChild(R("file-selection",[n=_("",[A(V("file_upload"))])])),n.onclick=function(){a.click()},a.onchange=function(){return v(l,function e(){var i,r,o,s=this;return g(e,function(e){if((i=a.files)&&0<i.length){r=i[0].type.toLowerCase(),r=r.substring(0,r.indexOf("/"));var t=i[0],n=t.type.match(/^([^;]+)(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i);if(2!==(null==n?void 0:n.length)||!(/^image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)$/i.test(n[1])||/^video\/(?:mpeg|mp4|ogg|webm|x-matroska|quicktime|x-ms-wmv)$/i.test(n[1])||/^audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)$/i.test(n[1])))throw Error("unsafe blob MIME type: "+t.type);if(!URL||!URL.createObjectURL)throw Error("cannot find createObjectURL");t=new m(URL.createObjectURL(t),P),o=t.toString(),"image"===r?(D(s.o,i[0].name),Z(s,o)):"video"===r&&Y(s,o)}e.g=0})})},(e=p.appendChild(document.createElement("div"))).classList.add("inputs"),d.video=e.appendChild(document.createElement("video")),d.video.setAttribute("crossorigin","anonymous"),d.video.setAttribute("playsinline","true"),d.h=e.appendChild(document.createElement("img")),d.h.setAttribute("crossorigin","anonymous"),o=d,r=V("pause"),h=V("play_arrow"),(n=f).append(u=_("video-controls",[i=A(r),c=_("video-track"),s=_("video-slider-ball"),n=R("video-time")])),o.i={parent:u,K:s,track:c,time:n},n.textContent="00:00",s.style.display="inline-block",s.onmousedown=function(r){function t(e){r.preventDefault();var t=u.getBoundingClientRect(),n=s.getBoundingClientRect(),i=c.getBoundingClientRect();(e=e.clientX-t.left-n.width/2)<(t=i.left-t.left)?e=t:e>t+i.width&&(e=t+i.width),s.style.left=e+"px",o.video.currentTime=(e-t)/i.width*o.video.duration}r.preventDefault();var n=o.video.paused;o.video.pause(),document.addEventListener("mousemove",t),document.addEventListener("mouseup",function e(){r.preventDefault(),document.removeEventListener("mousemove",t),n||o.video.play(),document.removeEventListener("mouseup",e)})},i.onclick=function(){o.video.paused?(o.video.play(),i.src=r):(o.video.pause(),i.src=h)},o.D=function(){o.video.paused&&(i.src=h),i.src=r},0<d.l.length&&(e=d.l[0],L(d.o,e.label)||D(d.o),e.start())})},q.prototype.update=function(){this.h&&!this.j&&this.g.onFrame&&this.g.onFrame(this.h,{width:this.h.naturalWidth,height:this.h.naturalHeight})},$.prototype.create=function(e,t,n){(e=n.appendChild(document.createElement("div"))).classList.add("control-panel-entry"),e.classList.add("control-panel-text"),e.textContent=this.g.title},$.prototype.update=function(){},Q.prototype.create=function(e,t,n){var i=this;this.i=e,this.options=t,this.g=n.appendChild(document.createElement("div")),this.g.classList.add("control-panel-entry"),this.g.classList.add("control-panel-toggle"),this.g.onclick=function(){i.options[i.h.field]=!i.options[i.h.field],i.i()},(e=this.g.appendChild(document.createElement("span"))).classList.add("label"),this.value=this.g.appendChild(document.createElement("span")),this.value.classList.add("value"),e.textContent=this.h.title},Q.prototype.update=function(){this.options[this.h.field]?(this.value.textContent="Yes",this.g.classList.add("yes"),this.g.classList.remove("no")):(this.value.textContent="No",this.g.classList.add("no"),this.g.classList.remove("yes"))},ee.prototype.add=function(e){for(var t=this,n=(e=c(e)).next();!n.done;n=e.next())n=n.value,this.g.push(n),n.create(function(){te(t)},this.options,this.h);return te(this),this},ee.prototype.on=function(e){return this.i=e,te(this),this},n("ControlPanel",ee),n("Slider",z),n("StaticText",$),n("Toggle",Q),n("SourcePicker",q),n("FPS",B),n("DropDownControl",N)}.call(this),function(){"use strict";var o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var s=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function e(e,t){if(t)e:{var n=s;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&o(n,e,{configurable:!0,writable:!0,value:t})}}function c(e){var t,n,i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return i?i.call(e):{next:(t=e,n=0,function(){return n<t.length?{done:!1,value:t[n++]}:{done:!0}})}}var t="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function n(e){return e||Array.prototype.fill}e("Object.assign",function(e){return e||t}),e("Array.prototype.fill",function(e){return e||function(e,t,n){var i=this.length||0;for(t<0&&(t=Math.max(0,i+t)),(null==n||i<n)&&(n=i),(n=Number(n))<0&&(n=Math.max(0,i+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}}),e("Int8Array.prototype.fill",n),e("Uint8Array.prototype.fill",n),e("Uint8ClampedArray.prototype.fill",n),e("Int16Array.prototype.fill",n),e("Uint16Array.prototype.fill",n),e("Int32Array.prototype.fill",n),e("Uint32Array.prototype.fill",n),e("Float32Array.prototype.fill",n),e("Float64Array.prototype.fill",n);var r=this||self;function i(e,t){e=e.split(".");var n,i=r;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}var h={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function u(e){return e=e||{},Object.assign(Object.assign(Object.assign({},h),{fillColor:e.color}),e)}function l(e,t){return e instanceof Function?e(t):e}function a(e,t,n){return Math.max(Math.min(t,n),Math.min(Math.max(t,n),e))}i("clamp",a),i("drawLandmarks",function(e,t,n){if(t){n=u(n),e.save();for(var i,r=e.canvas,o=0,s=(t=c(t)).next();!s.done;s=t.next())void 0!==(s=s.value)&&(void 0===s.visibility||s.visibility>n.visibilityMin)&&(e.fillStyle=l(n.fillColor,{index:o,from:s}),e.strokeStyle=l(n.color,{index:o,from:s}),e.lineWidth=l(n.lineWidth,{index:o,from:s}),(i=new Path2D).arc(s.x*r.width,s.y*r.height,l(n.radius,{index:o,from:s}),0,2*Math.PI),e.fill(i),e.stroke(i),++o);e.restore()}}),i("drawConnectors",function(e,t,n,i){if(t&&n){i=u(i),e.save();for(var r=e.canvas,o=0,s=(n=c(n)).next();!s.done;s=n.next()){var a=s.value;e.beginPath(),s=t[a[0]],a=t[a[1]],s&&a&&(void 0===s.visibility||s.visibility>i.visibilityMin)&&(void 0===a.visibility||a.visibility>i.visibilityMin)&&(e.strokeStyle=l(i.color,{index:o,from:s,to:a}),e.lineWidth=l(i.lineWidth,{index:o,from:s,to:a}),e.moveTo(s.x*r.width,s.y*r.height),e.lineTo(a.x*r.width,a.y*r.height)),++o,e.stroke()}e.restore()}}),i("drawRectangle",function(e,t,n){n=u(n),e.save();var i=e.canvas;e.beginPath(),e.lineWidth=l(n.lineWidth,{}),e.strokeStyle=l(n.color,{}),e.fillStyle=l(n.fillColor,{}),e.translate(t.xCenter*i.width,t.yCenter*i.height),e.rotate(t.rotation*Math.PI/180),e.rect(-t.width/2*i.width,-t.height/2*i.height,t.width*i.width,t.height*i.height),e.translate(-t.xCenter*i.width,-t.yCenter*i.height),e.stroke(),e.fill(),e.restore()}),i("lerp",function(e,t,n,i,r){return a(i*(1-(e-t)/(n-t))+r*(1-(n-e)/(n-t)),i,r)})}.call(this),function(){"use strict";var e;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var n=c;e=e.split(".");for(var i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))break e;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&o(n,e,{configurable:!0,writable:!0,value:t})}}function E(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}function u(e){if(!(e instanceof Array)){e=E(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}i("Symbol",function(e){function n(e,t){this.g=e,o(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new n(i+(t||"")+"_"+r++,t)}}),i("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&o(i.prototype,e,{configurable:!0,writable:!0,value:function(){return(e={next:e=r(this)})[Symbol.iterator]=function(){return this},e;var e}})}return e});var a,l="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)Ct=Object.setPrototypeOf;else{e:{var d={};try{d.__proto__={a:!0},a=d.a;break e}catch(e){}a=!1}Ct=a?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var f=Ct;function p(e,t){if(e.prototype=l(t.prototype),e.prototype.constructor=e,f)f(e,t);else for(var n in t){var i;"prototype"!=n&&(Object.defineProperties?(i=Object.getOwnPropertyDescriptor(t,n))&&Object.defineProperty(e,n,i):e[n]=t[n])}e.da=t.prototype}function g(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function v(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function m(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function k(e,t,n){return e.g=n,{value:t}}function _(e){this.g=new g,this.h=e}function y(t,e,n,i){try{var r=e.call(t.g.i,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.g.l=!1,r;var o=r.value}catch(e){return t.g.i=null,m(t.g,e),w(t)}return t.g.i=null,i.call(t.g,o),w(t)}function w(t){for(;t.g.g;)try{var e=t.h(t.g);if(e)return t.g.l=!1,{value:e.value,done:!1}}catch(e){t.g.h=void 0,m(t.g,e)}if(t.g.l=!1,t.g.j){if(e=t.g.j,t.g.j=null,e.V)throw e.U;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function b(i){this.next=function(e){return v(i.g),e=i.g.i?y(i,i.g.i.next,e,i.g.o):(i.g.o(e),w(i))},this.throw=function(e){return v(i.g),e=i.g.i?y(i,i.g.i.throw,e,i.g.o):(m(i.g,e),w(i))},this.return=function(e){return e=e,v((t=i).g),(n=t.g.i)?y(t,"return"in n?n.return:function(e){return{value:e,done:!0}},e,t.g.return):(t.g.return(e),w(t));var t,n},this[Symbol.iterator]=function(){return this}}function C(t){function r(e){return t.next(e)}function o(e){return t.throw(e)}return new Promise(function(n,i){!function e(t){t.done?n(t.value):Promise.resolve(t.value).then(r,o).then(e,i)}(t.next())})}function P(e){return C(new b(new _(e)))}g.prototype.o=function(e){this.h=e},g.prototype.return=function(e){this.j={return:e},this.g=this.s},i("Promise",function(e){function s(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.g=null}function a(t){return t instanceof s?t:new s(function(e){e(t)})}if(e)return e;t.prototype.h=function(e){var t;null==this.g&&(this.g=[],(t=this).i(function(){t.l()})),this.g.push(e)};var n=c.setTimeout,r=(t.prototype.i=function(e){n(e,0)},t.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},t.prototype.j=function(e){this.i(function(){throw e})},s.prototype.j=function(){function e(t){return function(e){i||(i=!0,t.call(n,e))}}var n=this,i=!1;return{resolve:e(this.C),reject:e(this.l)}},s.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof s)this.F(e);else{switch(typeof e){case"object":var t=null!=e;break;case"function":t=!0;break;default:t=!1}t?this.v(e):this.m(e)}},s.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},s.prototype.l=function(e){this.s(2,e)},s.prototype.m=function(e){this.s(1,e)},s.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},s.prototype.D=function(){var t=this;n(function(){var e;!t.B()||void 0!==(e=c.console)&&e.error(t.i)},1)},s.prototype.B=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},s.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)r.h(this.g[e]);this.g=null}},new t);return s.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},s.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},s.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){r(e)}}:e}var i,r,o=new s(function(e,t){i=e,r=t});return this.J(n(e,i),n(t,r)),o},s.prototype.catch=function(e){return this.then(void 0,e)},s.prototype.J=function(e,t){function n(){switch(i.h){case 1:e(i.i);break;case 2:t(i.i);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?r.h(n):this.g.push(n),this.o=!0},s.resolve=a,s.reject=function(n){return new s(function(e,t){t(n)})},s.race=function(r){return new s(function(e,t){for(var n=E(r),i=n.next();!i.done;i=n.next())a(i.value).J(e,t)})},s.all=function(e){var t=E(e),o=t.next();return o.done?a([]):new s(function(n,e){for(var i=[],r=0;i.push(void 0),r++,a(o.value).J(function(t){return function(e){i[t]=e,0==--r&&n(i)}}(i.length-1),e),!(o=t.next()).done;);})},s});var x="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},T=(i("Object.assign",function(e){return e||x}),i("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),i("Array.prototype.includes",function(e){return e||function(e,t){var n=this,i=(n=n instanceof String?String(n):n).length;for((t=t||0)<0&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}}),i("String.prototype.includes",function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}}),i("Array.prototype.keys",function(e){return e||function(){return n=function(e){return e},(t=this)instanceof String&&(t+=""),i=0,r=!1,(e={next:function(){var e;return!r&&i<t.length?(e=i++,{value:n(e,t[e]),done:!1}):{done:r=!0,value:void 0}}})[Symbol.iterator]=function(){return e},e;var t,n,i,r,e}}),this||self);function t(e,t){e=e.split(".");var n,i=T;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}function M(e){var t;t=e,T.setTimeout(function(){throw t},0)}function I(e,t){M(Error("Invalid wire type: "+e+" (at position "+t+")"))}function R(){M(Error("Failed to read varint, encoding is invalid."))}function A(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var j,L,D="undefined"!=typeof TextDecoder,N="undefined"!=typeof TextEncoder;function B(e){if(N)e=(L=L||new TextEncoder).encode(e);else{for(var t=void 0!==(t=void 0)&&t,n=0,i=new Uint8Array(3*e.length),r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o<128)i[n++]=o;else{if(o<2048)i[n++]=o>>6|192;else{if(55296<=o&&o<=57343){if(o<=56319&&r<e.length){var s=e.charCodeAt(++r);if(56320<=s&&s<=57343){i[n++]=(o=1024*(o-55296)+s-56320+65536)>>18|240,i[n++]=o>>12&63|128,i[n++]=o>>6&63|128,i[n++]=63&o|128;continue}r--}if(t)throw Error("Found an unpaired surrogate");o=65533}i[n++]=o>>12|224,i[n++]=o>>6&63|128}i[n++]=63&o|128}}e=i.subarray(0,n)}return e}var F={},z=null;function U(e){void 0===t&&(t=0),G();for(var t=F[t],n=Array(Math.floor(e.length/3)),i=t[64]||"",r=0,o=0;r<e.length-2;r+=3){var s=e[r],a=e[r+1],c=e[r+2],u=t[s>>2],s=t[(3&s)<<4|a>>4],a=t[(15&a)<<2|c>>6],c=t[63&c];n[o++]=u+s+a+c}switch(u=0,c=i,e.length-r){case 2:c=t[(15&(u=e[r+1]))<<2]||i;case 1:e=e[r],n[o]=t[e>>2]+t[(3&e)<<4|u>>4]+c+i}return n.join("")}function H(e){var t=e.length,n=3*t/4,i=(n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1),new Uint8Array(n)),r=0,o=e,s=function(e){i[r++]=e};function a(e){for(;l<o.length;){var t=o.charAt(l++),n=z[t];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(t))throw Error("Unknown base64 encoding at char: "+t)}return e}G();for(var l=0;;){var h=a(-1),d=a(0),c=a(64),u=a(64);if(64===u&&-1===h)break;s(h<<2|d>>4),64!=c&&(s(d<<4&240|c>>2),64!=u&&s(c<<6&192|u))}return i.subarray(0,r)}function G(){if(!z){z={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;n<5;n++){var i=e.concat(t[n].split(""));F[n]=i;for(var r=0;r<i.length;r++){var o=i[r];void 0===z[o]&&(z[o]=r)}}}}var V,q="function"==typeof Uint8Array;function W(e){if(null!==(this.g=e)&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}W.prototype.toJSON=function(){var e=null==this.g?"":(e=this.g,this.g=null==e||"string"==typeof e?e:q&&e instanceof Uint8Array?U(e):null);return e};var J="function"==typeof Uint8Array.prototype.slice;function X(e,t,n){return t===n?V=V||new Uint8Array(0):J?e.slice(t,n):new Uint8Array(e.subarray(t,n))}function Z(e,t){t=void 0!==(t=void 0===t?{}:t).u&&t.u,this.h=null,this.g=this.i=this.m=0,this.l=!1,this.u=t,e&&Y(this,e)}function Y(e,t){e.h=function(e){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return H(e);var t,n;if(e.constructor===W)return t=null==e.g?V=V||new Uint8Array(0):(t=Uint8Array,n=null==(n=e.g)||q&&null!=n&&n instanceof Uint8Array?n:"string"==typeof n?H(n):null,new t(e=e.g=n));if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t),e.m=0,e.i=e.h.length,e.g=e.m}function K(e){for(var t=128,n=0,i=0,r=0;r<4&&128<=t;r++)n|=(127&(t=e.h[e.g++]))<<7*r;if(128<=t&&(n|=(127&(t=e.h[e.g++]))<<28,i|=(127&t)>>4),128<=t)for(r=0;r<5&&128<=t;r++)i|=(127&(t=e.h[e.g++]))<<7*r+3;if(t<128)return e=n>>>0,(i=2147483648&(t=i>>>0))&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=4294967296*t+(e>>>0),i?-e:e;e.l=!0,R()}function h(e){e.g>e.i&&(e.l=!0,M(Error("Tried to read past the end of the data "+e.g+" > "+e.i)))}Z.prototype.reset=function(){this.g=this.m},Z.prototype.j=function(){var e=this.h,t=e[this.g],n=127&t;return t<128?(this.g+=1,h(this),n):(n|=(127&(t=e[this.g+1]))<<7,t<128?(this.g+=2,h(this),n):(n|=(127&(t=e[this.g+2]))<<14,t<128?(this.g+=3,h(this),n):(n|=(127&(t=e[this.g+3]))<<21,t<128?(this.g+=4,h(this),n):(n|=(15&(t=e[this.g+4]))<<28,t<128?(this.g+=5,h(this),n>>>0):(this.g+=5,128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]&&128<=e[this.g++]?(this.l=!0,R()):h(this),n)))))},Z.prototype.o=function(){var e=this.h[this.g],t=this.h[this.g+1],n=this.h[this.g+2],i=this.h[this.g+3];return this.g+=4,h(this),e=2*((n=(e<<0|t<<8|n<<16|i<<24)>>>0)>>31)+1,t=n>>>23&255,n&=8388607,255==t?n?NaN:1/0*e:0==t?e*Math.pow(2,-149)*n:e*Math.pow(2,t-150)*(n+Math.pow(2,23))};var $=[];function Q(){this.g=new Uint8Array(64),this.h=0}function ee(e,t){var n;e.h+1<e.g.length||(n=e.g,e.g=new Uint8Array(Math.ceil(1+2*e.g.length)),e.g.set(n)),e.g[e.h++]=t}function te(e,t){for(;127<t;)ee(e,127&t|128),t>>>=7;ee(e,t)}function ne(e){var t={},n=void 0!==t.N&&t.N;this.m={u:void 0!==t.u&&t.u},this.N=n,t=this.m,e=$.length?(n=$.pop(),t&&(n.u=t.u),e&&Y(n,e),n):new Z(e,t),this.g=e,this.l=this.g.g,this.h=this.i=-1,this.j=!1}function ie(e){var t,n=e.g;if(!(n=!(n=n.g==n.i)&&!(n=e.j)?(n=e.g).l||n.g<0||n.g>n.i:n))return e.l=e.g.g,t=e.g.j(),n=t>>>3,0<=(t&=7)&&t<=5?(e.i=n,e.h=t,1):(e.j=!0,I(t,e.l),0)}function re(e){switch(e.h){case 0:if(0!=e.h)re(e);else e:{for(var t=(e=e.g).g,n=0;n<10;n++){if(0==(128&e.h[t])){e.g=t+1,h(e);break e}t++}e.l=!0,R()}break;case 1:(e=e.g).g+=8,h(e);break;case 2:2!=e.h?re(e):(t=e.g.j(),(e=e.g).g+=t,h(e));break;case 5:(e=e.g).g+=4,h(e);break;case 3:for(t=e.i;;){if(!ie(e)){e.j=!0,M(Error("Unmatched start-group tag: stream EOF"));break}if(4==e.h){e.i!=t&&(e.j=!0,M(Error("Unmatched end-group tag")));break}re(e)}break;default:e.j=!0,I(e.h,e.l)}}function oe(e,t,n){e.N||(e=X(e.g.h,n,e.g.g),(n=t.o)?n.push(e):t.o=[e])}function se(e,t,n){var i=e.g.i,r=e.g.j(),o=e.g.g+r;if(e.g.i=o,n(t,e),0!==(n=o-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-n)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=o,e.g.i=i,t}function ae(e,t,n){for(var i=e.g.j(),i=e.g.g+i;e.g.g<i;)n.push(t.call(e.g))}Q.prototype.length=function(){return this.h},Q.prototype.end=function(){var e=this.g,t=this.h;return X(e,this.h=0,t)},ne.prototype.reset=function(){this.g.reset(),this.h=this.i=-1};var ce=[];function ue(){this.h=[],this.i=0,this.g=new Q}function le(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function he(e,t,n){te(e.g,8*t+2),te(e.g,n.length),le(e,e.g.end()),le(e,n)}var de,fe="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function pe(e,t){Object.isFrozen(e)||(fe?e[fe]|=t:void 0!==e.g?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function ge(e){if(!e)return 0;e=fe?e[fe]:e.g;return null==e?0:e}function ve(e){return Array.isArray(e)&&pe(e,1),e}function me(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");pe(e,2)}function _e(e){return null!==e&&"object"==typeof e&&e.constructor===Object}function ye(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":return q&&null!=e&&e instanceof Uint8Array?U(e):e;default:return e}}function we(e,t){if(null!=e)return Array.isArray(e)||_e(e)?be(e,t):t(e)}function be(e,t){if(Array.isArray(e)){for(var n=Array(e.length),i=0;i<e.length;i++)n[i]=we(e[i],t);return 1&ge(e)&&ve(n),n}for(i in n={},e)n[i]=we(e[i],t);return n}function n(e,t,n){var i=de;if(de=null,e=e||i,i=this.constructor.ba,e=e||(i?[i]:[]),this.j=(i?0:-1)-(this.constructor.$||0),this.m=this.g=null,this.h=e,e=(i=this.h.length)-1,i&&_e(i=this.h[e])?(this.l=e-this.j,this.i=i):void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)(e=n[t])<this.l?(e+=this.j,(i=this.h[e])?ve(i):this.h[e]=Se):(xe(this),(i=this.i[e])?ve(i):this.i[e]=Se)}var Ce,Se=Object.freeze(ve([]));function xe(e){var t=e.l+e.j;e.h[t]||(e.i=e.h[t]={})}function O(e,t,n){return-1===t?null:void 0!==n&&n||t>=e.l?e.i?e.i[t]:void 0:e.h[t+e.j]}function Te(e,t,n){n=void 0===n||n;var i=void 0!==i&&i,r=O(e,t,i);return(r=null==r?Se:r)===Se?S(e,t,r=ve([]),i):n&&Array.isArray(r)&&2&ge(r)&&S(e,t,r=r.slice(),i),r}function Ee(e){var t=Te(e,3,!1);if(e.m||(e.m={}),!e.m[3]){for(var n=0;n<t.length;n++)t[n]=+t[n];e.m[3]=!0}return t}function ke(e,t,n){return null==(e=O(e,t))?n:e}function Pe(e,t,n){return null==(e=null==(e=O(e,t))?e:+e)?void 0===n?0:n:e}function S(e,t,n,i){void 0!==i&&i||t>=e.l?(xe(e),e.i[t]=n):e.h[t+e.j]=n}function Oe(e,t,n){if(-1===n)return null;e.g||(e.g={});var i=e.g[n];if(i)return i;var r=O(e,n,!1);return null==r?i:(t=new t(r),e.g[n]=t)}function Me(e,t,n){if(e.g||(e.g={}),!(r=e.g[n])){for(var i=Te(e,n,!1),r=[],o=!!Array.isArray(i)&&!!(2&ge(i)),s=0;s<i.length;s++)r[s]=new t(i[s]),o&&me(r[s].h);o&&(me(r),Object.freeze(r)),e.g[n]=r}return r}function Ie(e,t,n,i,r){var o=Me(e,i,t);n=n||new i,e=Te(e,t),null!=r?(o.splice(r,0,n),e.splice(r,0,Re(n))):(o.push(n),e.push(Re(n)))}function Re(e){if(e.g)for(var t in e.g){var n=e.g[t];if(Array.isArray(n))for(var i=0;i<n.length;i++)n[i]&&Re(n[i]);else n&&Re(n)}return e.h}function Ae(e,t){if(e=e.o){le(t,t.g.end());for(var n=0;n<e.length;n++)le(t,e[n])}}function je(e,t,n){for(;ie(t)&&4!=t.h;){var i,r=t.i,o=n[r];o&&(o=Array.isArray(o)?n[r]=function(e){var i=e[0];switch(e.length){case 2:var r=e[1];return function(e,t,n){return i(e,t,n,r)};case 3:var o=e[1],s=e[2];return function(e,t,n){return i(e,t,n,o,s)};case 4:var a=e[1],c=e[2],u=e[3];return function(e,t,n){return i(e,t,n,a,c,u)};default:throw Error("unsupported number of parameters, expected [2-4], got "+e.length)}}(o):o)(t,e,r)||(o=e,i=(r=t).l,re(r),oe(r,o,i))}return e}function Le(e,t){var n=new ue;if(t(e,n),0===(e=n.i+n.g.length()))n=new Uint8Array(0);else{e=new Uint8Array(e);for(var i=n.h,r=i.length,o=t=0;o<r;o++){var s=i[o];0!==s.length&&(e.set(s,t),t+=s.length)}0!==(r=(i=n.g).h)&&(e.set(i.g.subarray(0,r),t),i.h=0),n.h=[e],n=e}return n}function De(e,t,n){var i;e=ce.length?(i=ce.pop(),e&&(Y(i.g,e),i.i=-1,i.h=-1),i):new ne(e);try{return n(new t,e)}finally{(t=e.g).h=null,t.m=0,t.i=0,t.g=0,t.l=!1,t.u=!1,e.i=-1,e.h=-1,e.j=!1,ce.length<100&&ce.push(e)}}function s(e,t,n){var i;null!=(t=O(t,n))&&(te(e.g,8*n+5),i=(n=(i=t)<0?1:0)?-i:i,ee(e=e.g,(n=0===i?0<1/i?0:2147483648:isNaN(i)?2147483647:34028234663852886e22<i?(n<<31|2139095040)>>>0:i<11754943508222875e-54?(n<<31|(i=Math.round(i/Math.pow(2,-149))))>>>0:(t=Math.floor(Math.log(i)/Math.LN2),i*=Math.pow(2,-t),16777216<=(i=Math.round(8388608*i))&&++t,(n<<31|t+127<<23|8388607&i)>>>0))>>>0&255),ee(e,n>>>8&255),ee(e,n>>>16&255),ee(e,n>>>24&255))}function Ne(e,t,n){return 5===e.h&&(S(t,n,e.g.o()),!0)}function Be(e,t,n){return(5===e.h||2===e.h)&&(t=Te(t,n),2==e.h?ae(e,Z.prototype.o,t):t.push(e.g.o()),!0)}function Fe(e,t,n){return 0===e.h&&(S(t,n,K(e.g)),!0)}function ze(e,t,n){return 0===e.h&&(S(t,n,e.g.j()),!0)}function Ue(e,t,l){if(2!==e.h)return!1;var n,i=e.g.j(),r=(e=e.g).g;if(e.g+=i,h(e),e=e.h,D)n=(n=!(n=j)?j=new TextDecoder("utf-8",{fatal:!1}):n).decode(e.subarray(r,r+i));else{for(var o,s,a,i=r+i,c=[],u=null;r<i;)(o=e[r++])<128?c.push(o):o<224?i<=r?c.push(65533):(s=e[r++],o<194||128!=(192&s)?(r--,c.push(65533)):c.push((31&o)<<6|63&s)):o<240?i-1<=r?c.push(65533):128!=(192&(s=e[r++]))||224===o&&s<160||237===o&&160<=s||128!=(192&(n=e[r++]))?(r--,c.push(65533)):c.push((15&o)<<12|(63&s)<<6|63&n):!(o<=244)||i-2<=r?c.push(65533):128!=(192&(s=e[r++]))||0!=s-144+(o<<28)>>30||128!=(192&(n=e[r++]))||128!=(192&(a=e[r++]))?(r--,c.push(65533)):(o=(7&o)<<18|(63&s)<<12|(63&n)<<6|63&a,c.push(55296+((o-=65536)>>10&1023),56320+(1023&o))),8192<=c.length&&(u=A(u,c),c.length=0);n=A(u,c)}return S(t,l,n),!0}function He(e,t,n,i,r){if(2!==e.h)return!1;e=se(e,new i,r);var o=void 0!==o&&o;return t.g||(t.g={}),i=e&&Re(e),t.g[n]=e,S(t,n,i,o),!0}function Ge(e,t,n,i,r){return 2===e.h&&(Ie(t,n,e=se(e,new i,r),i,void 0),!0)}function Ve(e,t,n){return(0===e.h||2===e.h)&&(t=Te(t,n),2==e.h?ae(e,Z.prototype.j,t):t.push(e.g.j()),!0)}function qe(e,t,n){return 0===e.h&&(S(t,n,K(e.g)),!0)}function We(e){n.call(this,e,-1,Ye)}function Je(e,t){return je(e,t,Ce=Ce||{1:ze,2:ze,3:Be,4:qe})}n.prototype.toJSON=function(){return be(Re(this),ye)},n.prototype.toString=function(){return Re(this).toString()},p(We,n),We.prototype.getRows=function(){return O(this,1)},We.prototype.getCols=function(){return O(this,2)},We.prototype.getPackedDataList=function(){return Ee(this)},We.prototype.getLayout=function(){return ke(this,4,0)};var Xe,Ze,Ye=[3];function Ke(e){n.call(this,e)}function $e(e,t){var n=O(e,1);if(null!=n){te(t.g,8);var i=t.g;if(0<=n)te(i,n);else{for(var r=0;r<9;r++)ee(i,127&n|128),n>>=7;ee(i,1)}}s(t,e,2),null!=(i=O(e,3))&&he(t,3,B(i)),null!=(i=O(e,4))&&he(t,4,B(i)),Ae(e,t)}function Qe(e,t){return je(e,t,Xe=Xe||{1:ze,2:Ne,3:Ue,4:Ue})}function et(e){n.call(this,e,-1,rt)}function tt(e,t){return je(e,t,Ze=Ze||{1:[Ge,Ke,Qe]})}p(Ke,n),p(et,n),et.prototype.addClassification=function(e,t){return Ie(this,1,e,Ke,t),this};var nt,it,rt=[1];function ot(e){n.call(this,e)}function st(e,t){s(t,e,1),s(t,e,2),s(t,e,3),s(t,e,4),s(t,e,5),Ae(e,t)}function at(e,t){return je(e,t,nt=nt||{1:Ne,2:Ne,3:Ne,4:Ne,5:Ne})}function ct(e){n.call(this,e,-1,dt)}function ut(e,t){return je(e,t,it=it||{1:[Ge,ot,at]})}p(ot,n),p(ct,n);var lt,ht,dt=[1];function ft(e){n.call(this,e)}function pt(e,t){if(s(t,e,1),s(t,e,2),s(t,e,3),s(t,e,4),s(t,e,5),null!=(r=O(e,6))){te(t.g,48);var n=t.g,i=r,r=i<0,o=(i=Math.abs(i))>>>0;for(i=Math.floor((i-o)/4294967296),i>>>=0,r&&(i=~i>>>0,4294967295<(o=1+(~o>>>0))&&(o=0,4294967295<++i&&(i=0))),r=o,o=i;0<o||127<r;)ee(n,127&r|128),r=(r>>>7|o<<25)>>>0,o>>>=7;ee(n,r)}Ae(e,t)}function gt(e,t){return je(e,t,lt=lt||{1:Ne,2:Ne,3:Ne,4:Ne,5:Ne,6:Fe})}function vt(e){n.call(this,e,-1,yt)}function mt(e,t){return je(e,t,ht=ht||{1:qe,2:qe,3:Be,4:Ve})}p(ft,n),p(vt,n),vt.prototype.getVertexType=function(){return ke(this,1,0)},vt.prototype.getPrimitiveType=function(){return ke(this,2,0)},vt.prototype.getVertexBufferList=function(){return Ee(this)},vt.prototype.getIndexBufferList=function(){return Te(this,4)};var _t,yt=[3,4];function wt(e){n.call(this,e)}function bt(e,t){return je(e,t,_t=_t||{1:[He,vt,mt],2:[He,We,Je]})}p(wt,n),wt.prototype.getMesh=function(){return Oe(this,vt,1)},wt.prototype.getPoseTransformMatrix=function(){return Oe(this,We,2)};var Ct=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],St=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],xt=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Tt=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Et=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],kt=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],Pt=[].concat(u(Ct),u(St),u(xt),u(Tt),u(Et),u(kt));function Ot(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Mt(e){return{x:Pe(e,1),y:Pe(e,2),z:Pe(e,3),visibility:null!=O(e,4)?Pe(e,4):void 0}}function It(e){return Me(De(e,ct,ut),ot,1).map(Mt)}function Rt(e,t){this.h=e,this.g=t,this.l=0}function At(t,e,n){var i=t,r=i.g;if(void 0===i.m){var o=Ot(r,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),s=Ot(r,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),a=r.createProgram();if(r.attachShader(a,o),r.attachShader(a,s),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+r.getProgramInfoLog(a));o=i.m=a,r.useProgram(o),s=r.getUniformLocation(o,"sampler0"),i.j={I:r.getAttribLocation(o,"aVertex"),H:r.getAttribLocation(o,"aTex"),ca:s},i.s=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,i.s),r.enableVertexAttribArray(i.j.I),r.vertexAttribPointer(i.j.I,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),i.o=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,i.o),r.enableVertexAttribArray(i.j.H),r.vertexAttribPointer(i.j.H,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.uniform1i(s,0)}return o=i.j,r.useProgram(i.m),r.canvas.width=e.width,r.canvas.height=e.height,r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),i.h.bindTexture2d(e.glName),r.enableVertexAttribArray(o.I),r.bindBuffer(r.ARRAY_BUFFER,i.s),r.vertexAttribPointer(o.I,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(o.H),r.bindBuffer(r.ARRAY_BUFFER,i.o),r.vertexAttribPointer(o.H,2,r.FLOAT,!1,0,0),r.bindFramebuffer(r.DRAW_FRAMEBUFFER||r.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.colorMask(!0,!0,!0,!0),r.drawArrays(r.TRIANGLE_FAN,0,4),r.disableVertexAttribArray(o.I),r.disableVertexAttribArray(o.H),r.bindBuffer(r.ARRAY_BUFFER,null),i.h.bindTexture2d(0),"function"==typeof t.g.canvas.transferToImageBitmap?Promise.resolve(t.g.canvas.transferToImageBitmap()):n?Promise.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new Promise(function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)}))}function jt(e){this.g=e}var Lt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Dt(e,t){return t+e}function Nt(e,t){window[e]=t}function Bt(e){if(this.g=e,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=e&&e.locateFile||Dt,"object"==typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=t,e.options)for(var n=(t=E(Object.keys(e.options))).next();!n.done;n=t.next()){var n=n.value,i=e.options[n].default;void 0!==i&&(this.j[n]="function"==typeof i?i():i)}}function Ft(r){var t,n,i,o,s,a;return P(function(e){switch(e.g){case 1:return r.R?(t=void 0===r.g.files?[]:"function"==typeof r.g.files?r.g.files(r.j):r.g.files,k(e,P(function(e){switch(e.g){case 1:return e.m=2,k(e,WebAssembly.instantiate(Lt),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}}),2)):e.return();case 2:if(n=e.h,"object"==typeof window)return Nt("createMediapipeSolutionsWasm",{locateFile:r.locateFile}),Nt("createMediapipeSolutionsPackedAssets",{locateFile:r.locateFile}),i=t.filter(function(e){return void 0!==e.data}),o=t.filter(function(e){return void 0===e.data}),i=Promise.all(i.map(function(e){var t,n=Ut(r,e.url);return void 0!==e.path&&(t=e.path,n=n.then(function(e){return r.overrideFile(t,e),Promise.resolve(e)})),n})),o=Promise.all(o.map(function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n?(e=r.locateFile(e.url,r.S),(t=document.createElement("script")).setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise(function(e){t.addEventListener("load",function(){e()},!1),t.addEventListener("error",function(){e()},!1),document.body.appendChild(t)})):Promise.resolve();var t})).then(function(){var t,n,i;return P(function(e){return 1==e.g?(t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,i=r,k(e,t(n),2)):(i.h=e.h,void(e.g=0))})}),s=P(function(e){return e=r.g.graph&&r.g.graph.url?k(e,Ut(r,r.g.graph.url),0):void(e.g=0)}),k(e,Promise.all([o,i,s]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return o=t.filter(function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n}).map(function(e){return r.locateFile(e.url,r.S)}),importScripts.apply(null,u(o)),i=r,k(e,createMediapipeSolutionsWasm(Module),6);case 6:i.h=e.h,r.l=new OffscreenCanvas(1,1),r.h.canvas=r.l,s=r.h.GL.createContext(r.l,{antialias:!1,alpha:!1,aa:"undefined"!=typeof WebGL2RenderingContext?2:1}),r.h.GL.makeContextCurrent(s),e.g=4;break;case 7:if(r.l=document.createElement("canvas"),!(a=r.l.getContext("webgl2",{}))&&!(a=r.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),e.return();r.D=a,r.h.canvas=r.l,r.h.createContext(r.l,!0,!0,{});case 4:r.i=new r.h.SolutionWasm,r.R=!1,e.g=0}})}function zt(t){var n,i,r,o,s,a,c;return P(function(e){if(1==e.g)return t.g.graph&&t.g.graph.url&&t.P===t.g.graph.url?e.return():(t.o=!0,t.g.graph&&t.g.graph.url?(t.P=t.g.graph.url,k(e,Ut(t,t.g.graph.url),3)):void(e.g=2));for(2!=e.g&&(c=e.h,t.i.loadGraph(c)),n=E(Object.keys(t.B)),i=n.next();!i.done;i=n.next())r=i.value,t.i.overrideFile(r,t.B[r]);if(t.B={},t.g.listeners)for(o=E(t.g.listeners),s=o.next();!s.done;s=o.next())a=s.value,function(o,s){for(var n=s.name||"$",a=[].concat(u(s.wants)),e=new o.h.StringList,t=E(s.wants),i=t.next();!i.done;i=t.next())e.push_back(i.value);t=o.h.PacketListener.implement({onResults:function(e){for(var i={},t=0;t<s.wants.length;++t)i[a[t]]=e.get(t);var h,d,f,p,b,C,g,v,S,m,_,y,w,x,T,r=o.listeners[n];r&&(o.C=(h=o,d=i,f=s.outs,P(function(e){switch(e.g){case 1:if(!f)return e.return(d);for(p={},b=0,C=E(Object.keys(f)),g=C.next();!g.done;g=C.next())v=g.value,"string"!=typeof(v=f[v])&&"texture"===v.type&&void 0!==d[v.stream]&&++b;1<b&&(h.G=!1),S=E(Object.keys(f)),g=S.next();case 2:if(g.done){e.g=4;break}if(m=g.value,"string"==typeof(_=f[m]))return x=p,k(e,(s=h,a=T=m,c=d[_],P(function(e){return"number"==typeof c||c instanceof Uint8Array||c instanceof s.h.Uint8BlobList?e.return(c):c instanceof s.h.Texture2dDataOut?((u=s.s[a])||(u=new Rt(s.h,s.D),s.s[a]=u),e.return(At(u,c,s.G))):e.return(void 0)})),14);if(y=d[_.stream],"detection_list"===_.type){if(y){for(var t=y.getRectList(),n=y.getLandmarksList(),l=y.getClassificationsList(),i=[],r=0;r<t.size();++r){var o={T:{X:Pe(o=De(t.get(r),ft,gt),1),Y:Pe(o,2),height:Pe(o,3),width:Pe(o,4),rotation:Pe(o,5,0),W:ke(o,6,0)},O:It(n.get(r)),M:Me(De(l.get(r),et,tt),Ke,1).map(function(e){return{index:ke(e,1,0),score:Pe(e,2),label:null!=O(e,3)?ke(e,3,""):void 0,displayName:null!=O(e,4)?ke(e,4,""):void 0}})};i.push(o)}t=i}else t=[];p[m]=t,e.g=7;break}if("proto_list"===_.type){if(y){for(t=Array(y.size()),n=0;n<y.size();n++)t[n]=y.get(n);y.delete()}else t=[];p[m]=t,e.g=7;break}if(void 0===y){e.g=3;break}if("float_list"===_.type){p[m]=y,e.g=7;break}if("proto"===_.type){p[m]=y,e.g=7;break}if("texture"!==_.type)throw Error("Unknown output config type: '"+_.type+"'");return(w=h.s[m])||(w=new Rt(h.h,h.D),h.s[m]=w),k(e,At(w,y,h.G),13);case 13:w=e.h,p[m]=w;case 7:_.transform&&p[m]&&(p[m]=_.transform(p[m])),e.g=3;break;case 14:x[T]=e.h;case 3:g=S.next(),e.g=2;break;case 4:return e.return(p)}var s,a,c,u}).then(function(e){e=r(e);for(var t=0;t<s.wants.length;++t){var n=i[a[t]];"object"==typeof n&&n.hasOwnProperty&&n.hasOwnProperty("delete")&&n.delete()}e&&(o.C=e)})))}}),o.i.attachMultiListener(e,t),e.delete()}(t,a);c=t.j,t.j={},t.setOptions(c),e.g=0})}function Ut(t,n){var i;return P(function(e){return n in t.F?e.return(t.F[n]):(i=t.locateFile(n,""),i=fetch(i).then(function(e){return e.arrayBuffer()}),t.F[n]=i,e.return(i))})}function Ht(e){return e.map(Gt)}function Gt(e){var t=(e=De(e,wt,bt)).getMesh();if(!t)return e;var n=new Float32Array(t.getVertexBufferList()),i=(t.getVertexBufferList=function(){return n},new Uint32Array(t.getIndexBufferList()));return t.getIndexBufferList=function(){return i},e}function Vt(e){var o=this;this.g=new Bt({locateFile:(e=e||{}).locateFile,files:[{url:"holistic_solution_packed_assets_loader.js"},{simd:!1,url:"holistic_solution_wasm_bin.js"},{simd:!0,url:"holistic_solution_simd_wasm_bin.js"}],graph:{url:"holistic.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:"left_hand_landmarks right_hand_landmarks face_landmarks pose_landmarks world_landmarks segmentation_mask image_transformed multi_face_geometry".split(" "),outs:{image:{type:"texture",stream:"image_transformed"},leftHandLandmarks:{type:"proto",stream:"left_hand_landmarks",transform:It},rightHandLandmarks:{type:"proto",stream:"right_hand_landmarks",transform:It},faceLandmarks:{type:"proto",stream:"face_landmarks",transform:It},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:It},ea:{type:"proto",stream:"world_landmarks",transform:It},segmentationMask:{type:"texture",stream:"segmentation_mask"},multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:Ht}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,default:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(t){var n,i,r;return P(function(e){if(1!=e.g)return 2!=e.g?k(e,e.h.arrayBuffer(),2):(r=e.h,o.g.overrideFile(i,r),k(e,o.g.reset(),0));switch(n="",t){case 1:n="pose_landmark_full.tflite";break;case 2:n="pose_landmark_heavy.tflite";break;default:n="pose_landmark_lite.tflite"}return i="third_party/mediapipe/modules/pose_landmark/"+n,r=o.g.locateFile(n,""),k(e,fetch(r),3)})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},refineFaceLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineFaceLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}})}(e=Bt.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},e.reset=function(){var t=this;return P(function(e){t.i&&(t.i.reset(),t.m={},t.s={}),e.g=0})},e.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var i=[],r=[],o={},s=E(Object.keys(e)),a=s.next();!a.done;o={K:o.K,L:o.L},a=s.next()){var c=a.value;c in this.j&&this.j[c]===e[c]||(this.j[c]=e[c],void 0!==(a=t[c])&&(a.onChange&&(o.K=a.onChange,o.L=e[c],i.push(function(t){return function(){return P(function(e){return 1==e.g?k(e,t.K(t.L),2):(!0===e.h&&(n.o=!0),void(e.g=0))})}}(o))),a.graphOptionXref&&(c={valueNumber:1===a.type?e[c]:0,valueBoolean:0===a.type&&e[c],valueString:2===a.type?e[c]:""},a=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),a.graphOptionXref),c),r.push(a))))}0===i.length&&0===r.length||(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(r),this.v=(void 0===this.v?[]:this.v).concat(i))}},e.initialize=function(){var c=this;return P(function(e){return 1==e.g?k(e,Ft(c),2):3!=e.g?k(e,zt(c),3):k(e,(t=c,P(function(e){switch(e.g){case 1:if(!t.o)return e.return();if(!t.v){e.g=2;break}n=E(t.v),i=n.next();case 3:if(i.done){e.g=5;break}return k(e,(0,i.value)(),4);case 4:i=n.next(),e.g=3;break;case 5:t.v=void 0;case 2:if(t.A){for(r=new t.h.GraphOptionChangeRequestList,o=E(t.A),s=o.next();!s.done;s=o.next())a=s.value,r.push_back(a);t.i.changeOptions(r),r.delete(),t.A=void 0}t.o=!1,e.g=0}})),0);var t,n,i,r,o,s,a})},e.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(b,C){var h,d,f,p,g,v,m,_,y,w=this;return P(function(e){switch(e.g){case 1:return w.g.inputs?(h=1e3*(null==C?performance.now():C),k(e,w.C,2)):e.return();case 2:return k(e,w.initialize(),3);case 3:for(d=new w.h.PacketDataList,f=E(Object.keys(b)),p=f.next();!p.done;p=f.next())if(g=p.value,v=w.g.inputs[g]){e:{var t=b[g];switch(v.type){case"video":var n,i=w.m[v.stream];i||(i=new Rt(w.h,w.D),w.m[v.stream]=i),0===i.l&&(i.l=i.h.createTexture()),n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?(r=t.videoWidth,t.videoHeight):"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?(r=t.naturalWidth,t.naturalHeight):(r=t.width,t.height),n={glName:i.l,width:r,height:n},(r=i.g).canvas.width=n.width,r.canvas.height=n.height,r.activeTexture(r.TEXTURE0),i.h.bindTexture2d(i.l),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),i.h.bindTexture2d(0),i=n;break e;case"detections":for((i=w.m[v.stream])||(i=new jt(w.h),w.m[v.stream]=i),i.data||(i.data=new i.g.DetectionListData),i.data.reset(t.length),n=0;n<t.length;++n){var r=t[n],o=i.data,s=o.setBoundingBox,l=n,a=r.T;if(S(c=new ft,1,a.X),S(c,2,a.Y),S(c,3,a.height),S(c,4,a.width),S(c,5,a.rotation),S(c,6,a.W),a=Le(c,pt),s.call(o,l,a),r.O)for(o=0;o<r.O.length;++o){var c,u=!!(c=r.O[o]).visibility,l=(s=i.data).addNormalizedLandmark,a=n;c=Object.assign(Object.assign({},c),{visibility:u?c.visibility:0}),S(u=new ot,1,c.x),S(u,2,c.y),S(u,3,c.z),c.visibility&&S(u,4,c.visibility),c=Le(u,st),l.call(s,a,c)}if(r.M)for(o=0;o<r.M.length;++o)l=(s=i.data).addClassification,a=n,c=r.M[o],S(u=new Ke,2,c.score),c.index&&S(u,1,c.index),c.label&&S(u,3,c.label),c.displayName&&S(u,4,c.displayName),c=Le(u,$e),l.call(s,a,c)}i=i.data;break e;default:i={}}}switch(m=i,_=v.stream,v.type){case"video":d.pushTexture2d(Object.assign(Object.assign({},m),{stream:_,timestamp:h}));break;case"detections":(y=m).stream=_,y.timestamp=h,d.pushDetectionList(y);break;default:throw Error("Unknown input config type: '"+v.type+"'")}}return w.i.send(d),k(e,w.C,4);case 4:d.delete(),e.g=0}})},e.onResults=function(e,t){this.listeners[t||"$"]=e},t("Solution",Bt),t("OptionType",{BOOL:0,NUMBER:1,Z:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=Vt.prototype).close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(e){this.g.onResults(e)},e.initialize=function(){var t=this;return P(function(e){return k(e,t.g.initialize(),0)})},e.reset=function(){this.g.reset()},e.send=function(t){var n=this;return P(function(e){return k(e,n.g.send(t),0)})},e.setOptions=function(e){this.g.setOptions(e)},t("Holistic",Vt),t("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),t("FACEMESH_LIPS",Ct),t("FACEMESH_LEFT_EYE",St),t("FACEMESH_LEFT_EYEBROW",xt),t("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),t("FACEMESH_RIGHT_EYE",Tt),t("FACEMESH_RIGHT_EYEBROW",Et),t("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),t("FACEMESH_FACE_OVAL",kt),t("FACEMESH_CONTOURS",Pt),t("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),t("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),t("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),t("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),t("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),t("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),t("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),t("matrixDataToMatrix",function(e){for(var t=e.getCols(),n=e.getRows(),i=e.getPackedDataList(),r=[],o=0;o<n;o++)r.push(Array(t));for(o=0;o<n;o++)for(var s=0;s<t;s++){var a=1===e.getLayout()?o*t+s:s*n+o;r[o][s]=i[a]}return r}),t("VERSION","0.5.1635989137")}.call(this),parcelRequire=function(r,o,e){var t,s="function"==typeof parcelRequire&&parcelRequire,a="function"==typeof require&&require;function c(t,e){if(!o[t]){if(!r[t]){var n="function"==typeof parcelRequire&&parcelRequire;if(!e&&n)return n(t,!0);if(s)return s(t,!0);if(a&&"string"==typeof t)return a(t);e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}i.resolve=function(e){return r[t][1][e]||e},i.cache={};n=o[t]=new c.Module(t);r[t][0].call(n.exports,i,n,n.exports,this)}return o[t].exports;function i(e){return c(i.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=r,c.cache=o,c.parent=s,c.register=function(e,n){r[e]=[function(e,t){t.exports=n},{}]};for(var n,i=0;i<e.length;i++)try{c(e[i])}catch(r){t=t||r}if(e.length&&(n=c(e[e.length-1]),"object"==typeof exports&&"undefined"!=typeof module?module.exports=n:"function"==typeof define&&define.amd&&define(function(){return n})),parcelRequire=c,t)throw t;return c}({EgBh:[function(e,t,n){var i={},r=(i.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),i.useArrayBufferView=!i.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=i,t.exports.BlobBuilder);function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){var e;0<this._pieces.length&&(e=new Uint8Array(this._pieces),i.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[])},o.prototype.getBuffer=function(){if(this.flush(),i.useBlobBuilder){for(var e=new r,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var i=e("./bufferbuilder").BufferBuilder,r=e("./bufferbuilder").binaryFeatures;function o(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new i}function a(e){e=e.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}t.exports={unpack:function(e){return new o(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}},o.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},o.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},o.prototype.unpack_uint16=function(){var e=this.read(2),e=256*(255&e[0])+(255&e[1]);return this.index+=2,e},o.prototype.unpack_uint32=function(){var e=this.read(4),e=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,e},o.prototype.unpack_uint64=function(){var e=this.read(8),e=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,e},o.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},o.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},o.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},o.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},o.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},o.prototype.unpack_string=function(e){for(var t,n,i=this.read(e),r=0,o="";r<e;)(t=i[r])<128?(o+=String.fromCharCode(t),r++):(192^t)<32?(n=(192^t)<<6|63&i[r+1],o+=String.fromCharCode(n),r+=2):(n=(15&t)<<12|(63&i[r+1])<<6|63&i[r+2],o+=String.fromCharCode(n),r+=3);return this.index+=e,o},o.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},o.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var i=this.unpack(),r=this.unpack();t[i]=r}return t},o.prototype.unpack_float=function(){var e=this.unpack_uint32();return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,(e>>23&255)-127-23)},o.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},o.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{t=e.constructor;if(t==Array)this.pack_array(e);else if(t==Blob||t==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(t==ArrayBuffer)r.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)r.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(t==Object||t.toString().startsWith("class"))this.pack_object(e);else if(t==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+t.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=600<(t=e).length?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,a).length;if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(255&e);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-0x8000000000000000<=e&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(0<=e&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0,n=(e<0&&(t=1,e=-e),Math.floor(Math.log(e)/Math.LN2)),e=e/Math.pow(2,n)-1,e=Math.floor(e*Math.pow(2,52)),i=Math.pow(2,32),t=t<<31|n+1023<<20|e/i&1048575,n=e%i;this.bufferBuilder.append(203),this.pack_int32(t),this.pack_int32(n)},s.prototype.pack_object=function(e){var t,n=Object.keys(e).length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this.bufferBuilder.append(222),this.pack_uint16(n);else{if(!(n<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(n)}for(t in e)e.hasOwnProperty(t)&&(this.pack(t),this.pack(e[t]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){e&=4294967295;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),e=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),e=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,u,t){"use strict";function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.extractVersion=o,t.wrapPeerConnectionEvent=function(e,i,r){{var o,s;e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,o=e.addEventListener,e.addEventListener=function(e,t){if(e!==i)return o.apply(this,arguments);function n(e){(e=r(e))&&(t.handleEvent?t.handleEvent(e):t(e))}return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(t,n),o.apply(this,[e,n])},s=e.removeEventListener,e.removeEventListener=function(e,t){if(e!==i||!this._eventMap||!this._eventMap[i])return s.apply(this,arguments);if(!this._eventMap[i].has(t))return s.apply(this,arguments);var n=this._eventMap[i].get(t);return this._eventMap[i].delete(t),0===this._eventMap[i].size&&delete this._eventMap[i],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,n])},Object.defineProperty(e,"on"+i,{get:function(){return this["_on"+i]},set:function(e){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),e&&this.addEventListener(i,this["_on"+i]=e)},enumerable:!0,configurable:!0}))}},t.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+n(e)+". Please use a boolean."):(i=e)?"adapter.js logging disabled":"adapter.js logging enabled"},t.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+n(e)+". Please use a boolean."):(r=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},t.log=function(){"object"===("undefined"==typeof window?"undefined":n(window))&&(i||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments))},t.deprecated=function(e,t){r&&console.warn(e+" is deprecated, please use "+t+" instead.")},t.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e["navigator"];if(n.mozGetUserMedia)t.browser="firefox",t.version=o(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=o(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=o(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=o(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},t.compactObject=function r(o){return a(o)?Object.keys(o).reduce(function(e,t){var n=a(o[t]),i=n?r(o[t]):o[t],n=n&&!Object.keys(i).length;return void 0===i||n?e:Object.assign(e,s({},t,i))},{}):o},t.walkStats=c,t.filterStats=function(n,t,e){var i=e?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;var o=[];return n.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(function(t){n.forEach(function(e){e.type===i&&e.trackId===t.id&&c(n,e,r)})}),r};var i=!0,r=!0;function o(e,t,n){e=e.match(t);return e&&e.length>=n&&parseInt(e[n],10)}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(t,n,i){n&&!i.has(n.id)&&(i.set(n.id,n),Object.keys(n).forEach(function(e){e.endsWith("Id")?c(t,t.get(n[e]),i):e.endsWith("Ids")&&n[e].forEach(function(e){c(t,t.get(e),i)})}))}},{}],s6SN:[function(e,t,n){"use strict";function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var s=e&&e.navigator;{var a,i,r,n;s.mediaDevices&&(a=function(r){if("object"!==c(r)||r.mandatory||r.optional)return r;var o={};return Object.keys(r).forEach(function(t){var n,i,e;"require"!==t&&"advanced"!==t&&"mediaSource"!==t&&(void 0!==(n="object"===c(r[t])?r[t]:{ideal:r[t]}).exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact),i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t},void 0!==n.ideal&&(o.optional=o.optional||[],e={},"number"==typeof n.ideal?(e[i("min",t)]=n.ideal,o.optional.push(e),(e={})[i("max",t)]=n.ideal):e[i("",t)]=n.ideal,o.optional.push(e)),void 0!==n.exact&&"number"!=typeof n.exact?(o.mandatory=o.mandatory||{},o.mandatory[i("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(o.mandatory=o.mandatory||{},o.mandatory[i(e,t)]=n[e])}))}),r.advanced&&(o.optional=(o.optional||[]).concat(r.advanced)),o},i=function(n,i){if(61<=t.version)return i(n);if((n=JSON.parse(JSON.stringify(n)))&&"object"===c(n.audio)&&((e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=a(n.audio)),n&&"object"===c(n.video)){var r,o=(o=n.video.facingMode)&&("object"===c(o)?o:{ideal:o}),e=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||e)&&(delete n.video.facingMode,"environment"===o.exact||"environment"===o.ideal?r=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(r=["front"]),r))return s.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return r.some(function(e){return t.label.toLowerCase().includes(e)})});return(t=!t&&e.length&&r.includes("back")?e[e.length-1]:t)&&(n.video.deviceId=o.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=a(n.video),u("chrome: "+JSON.stringify(n)),i(n)});n.video=a(n.video)}return u("chrome: "+JSON.stringify(n)),i(n)},r=function(e){return 64<=t.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},s.getUserMedia=function(e,t,n){i(e,function(e){s.webkitGetUserMedia(e,t,function(e){n&&n(r(e))})})}.bind(s),s.mediaDevices.getUserMedia&&(n=s.mediaDevices.getUserMedia.bind(s.mediaDevices),s.mediaDevices.getUserMedia=function(e){return i(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(r(e))})})}))}};var u=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils.js")).log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(o,e){o.navigator.mediaDevices&&"getDisplayMedia"in o.navigator.mediaDevices||o.navigator.mediaDevices&&("function"==typeof e?o.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(function(e){var t=r.video&&r.video.width,n=r.video&&r.video.height,i=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:i||3}},t&&(r.video.mandatory.maxWidth=t),n&&(r.video.mandatory.maxHeight=n),o.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},t.shimOnTrack=function(o){{var e;"object"!==a(o)||!o.RTCPeerConnection||"ontrack"in o.RTCPeerConnection.prototype?r.wrapPeerConnectionEvent(o,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}):(Object.defineProperty(o.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0}),e=o.RTCPeerConnection.prototype.setRemoteDescription,o.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(i){i.stream.addEventListener("addtrack",function(t){var e=o.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track},n=new Event("track");n.track=t.track,n.receiver=e,n.transceiver={receiver:e},n.streams=[i.stream],r.dispatchEvent(n)}),i.stream.getTracks().forEach(function(t){var e=o.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t},n=new Event("track");n.track=t,n.receiver=e,n.transceiver={receiver:e},n.streams=[i.stream],r.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)})}},t.shimGetSendersWithDtmf=function(e){{var i,r,t,n,o,s;"object"===a(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype?(i=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}},e.RTCPeerConnection.prototype.getSenders||(e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()},r=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=r.apply(this,arguments);return n||(n=i(this,e),this._senders.push(n)),n},t=e.RTCPeerConnection.prototype.removeTrack,e.RTCPeerConnection.prototype.removeTrack=function(e){t.apply(this,arguments);e=this._senders.indexOf(e);-1!==e&&this._senders.splice(e,1)}),n=e.RTCPeerConnection.prototype.addStream,e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(i(t,e))})},o=e.RTCPeerConnection.prototype.removeStream,e.RTCPeerConnection.prototype.removeStream=function(e){var n=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(t){var e=n._senders.find(function(e){return e.track===t});e&&n._senders.splice(n._senders.indexOf(e),1)})}):"object"===a(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&(s=e.RTCPeerConnection.prototype.getSenders,e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=s.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}}))}},t.shimGetStats=function(e){{var s;e.RTCPeerConnection&&(s=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var n=this,[e,t,i]=arguments;if(0<arguments.length&&"function"==typeof e)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof e))return s.apply(this,[]);function r(e){var i={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),i[n.id]=n}),i}function o(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}return 2<=arguments.length?s.apply(this,[function(e){t(o(r(e)))},e]):new Promise(function(t,e){s.apply(n,[function(e){t(o(r(e)))},e])}).then(t,i)})}},t.shimSenderReceiverGetStats=function(e){{var n,t,i,o;"object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver&&("getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return r.filterStats(e,t.track,!0)})}),"getStats"in e.RTCRtpReceiver.prototype||((i=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=i.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),r.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return r.filterStats(e,t.track,!1)})}),"getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype&&(o=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var t,n,i,r;return 0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack?(r=arguments[0],this.getSenders().forEach(function(e){e.track===r&&(t?i=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===r&&(n?i=!0:n=e),e.track===r}),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))):o.apply(this,arguments)}))}},t.shimAddTrackRemoveTrackWithNative=u,t.shimAddTrackRemoveTrack=function(r,e){if(r.RTCPeerConnection){if(r.RTCPeerConnection.prototype.addTrack&&65<=e.version)return u(r);var n=r.RTCPeerConnection.prototype.getLocalStreams,i=(r.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})},r.RTCPeerConnection.prototype.addStream),t=(r.RTCPeerConnection.prototype.addStream=function(e){var t,n=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this._reverseStreams[e.id]||(t=new r.MediaStream(e.getTracks()),this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t),i.apply(this,[e])},r.RTCPeerConnection.prototype.removeStream),o=(r.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[(this._streams[e.id]||e).id],delete this._streams[e.id]},r.RTCPeerConnection.prototype.addTrack=function(t,e){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[e.id];return i?(i.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(i=new r.MediaStream([t]),this._streams[e.id]=i,this._reverseStreams[i.id]=e,this.addStream(i)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e],t=c({},e,function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[function(e){e=a(t,e);n[0].apply(null,[e])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):i.apply(this,arguments).then(function(e){return a(t,e)})});r.RTCPeerConnection.prototype[e]=t[e]}),r.RTCPeerConnection.prototype.setLocalDescription),s=(r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=(n=this,i=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];i=i.replace(new RegExp(e.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i}))),o.apply(this,arguments);var n,e,i},Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription"));Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:a(this,e)}}),r.RTCPeerConnection.prototype.removeTrack=function(t){var n,i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(e){i._streams[e].getTracks().find(function(e){return t.track===e})&&(n=i._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function a(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];i=i.replace(new RegExp(t.id,"g"),e.id)}),new RTCSessionDescription({type:e.type,sdp:i})}},t.shimPeerConnection=function(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=i.RTCPeerConnection.prototype[e],n=c({},e,function(){return arguments[0]=new("addIceCandidate"===e?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});i.RTCPeerConnection.prototype[e]=n[e]})},t.fixNegotiationNeeded=function(e,n){r.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if(!(n.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return e})},Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}}),Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils.js")),n=e("./getusermedia"),i=e("./getdisplaymedia");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var i=e.RTCPeerConnection.prototype.addTrack,r=(e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=i.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(n)&&this._shimmedLocalStreams[t.id].push(n):this._shimmedLocalStreams[t.id]=[t,n],n},e.RTCPeerConnection.prototype.addStream),t=(e.RTCPeerConnection.prototype.addStream=function(e){var n=this,t=(this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this.getSenders()),i=(r.apply(this,arguments),this.getSenders().filter(function(e){return-1===t.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)},e.RTCPeerConnection.prototype.removeStream),o=(e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)},e.RTCPeerConnection.prototype.removeTrack);e.RTCPeerConnection.prototype.removeTrack=function(n){var i=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=i._shimmedLocalStreams[e].indexOf(n);-1!==t&&i._shimmedLocalStreams[e].splice(t,1),1===i._shimmedLocalStreams[e].length&&delete i._shimmedLocalStreams[e]}),o.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){var t,n;if(e&&(e.urls||e.url))return n=e.urls||e.url,e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls"),n=(n=(t="string"==typeof n)?[n]:n).filter(function(e){if(0===e.indexOf("stun:"))return!1;e=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return e&&!i&&(i=!0)}),delete e.url,e.urls=t?n[0]:n,!!n.length})};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var u={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};u.localCName=u.generateIdentifier(),u.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},u.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},u.getDescription=function(e){e=u.splitSections(e);return e&&e[0]},u.getMediaSections=function(e){e=u.splitSections(e);return e.shift(),e},u.matchPrefix=function(e,t){return u.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},u.parseCandidate=function(e){for(var t,n={foundation:(t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},u.writeCandidate=function(e){var t=[],n=(t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port),e.type);return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},u.parseIceOptions=function(e){return e.substr(14).split(" ")},u.parseRtpMap=function(e){var e=e.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)},e=e[0].split("/");return t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},u.writeRtpMap=function(e){var t=e.payloadType,n=(void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),e.channels||e.numChannels||1);return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},u.parseExtmap=function(e){e=e.substr(9).split(" ");return{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},u.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},u.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(t=i[r].trim().split("="))[0].trim()]=t[1];return n},u.writeFmtp=function(t){var n,e="",i=t.payloadType;return void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length&&(n=[],Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+i+" "+n.join(";")+"\r\n"),e},u.parseRtcpFb=function(e){e=e.substr(e.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},u.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},u.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return-1<i?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},u.parseSsrcGroup=function(e){e=e.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},u.getMid=function(e){e=u.matchPrefix(e,"a=mid:")[0];if(e)return e.substr(6)},u.parseFingerprint=function(e){e=e.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},u.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:u.matchPrefix(e+t,"a=fingerprint:").map(u.parseFingerprint)}},u.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},u.parseCryptoLine=function(e){e=e.substr(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},u.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?u.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},u.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;e=e.substr(7).split("|");return{keyMethod:"inline",keySalt:e[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},u.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},u.getCryptoParameters=function(e,t){return u.matchPrefix(e+t,"a=crypto:").map(u.parseCryptoLine)},u.getIceParameters=function(e,t){var n=u.matchPrefix(e+t,"a=ice-ufrag:")[0],e=u.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&e?{usernameFragment:n.substr(12),password:e.substr(10)}:null},u.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},u.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=u.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var r=n[i],o=u.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(o){var s=u.parseRtpMap(o),o=u.matchPrefix(e,"a=fmtp:"+r+" ");switch(s.parameters=o.length?u.parseFmtp(o[0]):{},s.rtcpFeedback=u.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(u.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return u.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(u.parseExtmap(e))}),t},u.writeRtpDescription=function(e,t){var n="",i=(n=(n=(n=(n+="m="+e+" ")+(0<t.codecs.length?"9":"0")+" UDP/TLS/RTP/SAVPF ")+(t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n"))+"c=IN IP4 0.0.0.0\r\n"+"a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n=(n=(n+=u.writeRtpMap(e))+u.writeFmtp(e))+u.writeRtcpFb(e)}),0);return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),0<i&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=u.writeExtmap(e)}),n},u.parseRtpEncodingParameters=function(e){var t,n=[],i=u.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),a=0<s.length&&s[0].ssrc,s=u.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})}),c=(0<s.length&&1<s[0].length&&s[0][0]===a&&(t=s[0][1]),i.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)},a&&t&&(e.rtx={ssrc:t}),n.push(e),r&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},n.push(e)))}),0===n.length&&a&&n.push({ssrc:a}),u.matchPrefix(e,"b="));return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=c})),n},u.parseRtcpParameters=function(e){var t={},n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0],n=(n&&(t.cname=n.value,t.ssrc=n.ssrc),u.matchPrefix(e,"a=rtcp-rsize")),n=(t.reducedSize=0<n.length,t.compound=0===n.length,u.matchPrefix(e,"a=rtcp-mux"));return t.mux=0<n.length,t},u.parseMsid=function(e){var t,n=u.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<n.length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},u.parseSctpDescription=function(e){var t,n=u.parseMLine(e),i=u.matchPrefix(e,"a=max-message-size:"),i=(0<i.length&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536),u.matchPrefix(e,"a=sctp-port:"));return 0<i.length?{port:parseInt(i[0].substr(12),10),protocol:n.fmt,maxMessageSize:t}:0<u.matchPrefix(e,"a=sctpmap:").length?(i=u.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" "),{port:parseInt(i[0],10),protocol:i[1],maxMessageSize:t}):void 0},u.writeSctpDescription=function(e,t){var n=[],n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"];return void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},u.generateSessionId=function(){return Math.random().toString().substr(2,21)},u.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||u.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},u.writeMediaSection=function(e,t,n,i){t=u.writeRtpDescription(e.kind,t);return t=(t=(t+=u.writeIceParameters(e.iceGatherer.getLocalParameters()))+u.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"))+("a=mid:"+e.mid)+"\r\n",e.direction?t+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(t=t+"a="+(n="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+n,e.sendEncodingParameters[0].rtx&&(t=(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+n)+("a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"))),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+u.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+u.localCName+"\r\n"),t},u.getDirection=function(e,t){for(var n=u.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?u.getDirection(t):"sendrecv"},u.getKind=function(e){return u.splitLines(e)[0].split(" ")[0].substr(2)},u.isRejected=function(e){return"0"===e.split(" ",2)[1]},u.parseMLine=function(e){e=u.splitLines(e)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},u.parseOLine=function(e){e=u.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},u.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=u.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=u)},{}],NJ2u:[function(e,t,n){"use strict";var I=e("sdp");function s(e,t,n,i,r){t=I.writeRtpDescription(e.kind,t);return t=(t=(t+=I.writeIceParameters(e.iceGatherer.getLocalParameters()))+I.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"))+("a=mid:"+e.mid)+"\r\n",e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(n=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=n,t=t+"a="+(r="msid:"+(i?i.id:"-")+" "+n+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t=(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r)+("a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"))),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+I.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+I.localCName+"\r\n"),t}function R(i,r){function o(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]}var s={codecs:[],headerExtensions:[],fecMechanisms:[]};return i.codecs.forEach(function(n){for(var e=0;e<r.codecs.length;e++){var t=r.codecs[e];if(n.name.toLowerCase()===t.name.toLowerCase()&&n.clockRate===t.clockRate&&("rtx"!==n.name.toLowerCase()||!n.parameters||!t.parameters.apt||function(e,t,n,i){e=o(e.parameters.apt,n),n=o(t.parameters.apt,i);return e&&n&&e.name.toLowerCase()===n.name.toLowerCase()}(n,t,i.codecs,r.codecs))){(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(n.numChannels,t.numChannels),s.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),i.headerExtensions.forEach(function(e){for(var t=0;t<r.headerExtensions.length;t++){var n=r.headerExtensions[t];if(e.uri===n.uri){s.headerExtensions.push(n);break}}}),s}function o(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function A(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function d(e,t){t=new Error(t);return t.name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}t.exports=function(P,O){function M(e,t){t.addTrack(e),t.dispatchEvent(new P.MediaStreamTrackEvent("addtrack",{track:e}))}function r(e,t,n,i){var r=new Event("track");r.track=t,r.receiver=n,r.transceiver={receiver:n},r.streams=i,P.setTimeout(function(){e._dispatchEvent("track",r)})}function i(e){var t,i,r,n=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=o[e].bind(o)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw d("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=(t=e.iceServers||[],i=O,r=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){var t,n;if(e&&(e.urls||e.url))return n=e.urls||e.url,e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead."),n=(n=(t="string"==typeof n)?[n]:n).filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&14393<=i&&-1===e.indexOf("?transport=udp"):r=!0}),delete e.url,e.urls=t?n[0]:n,!!n.length})),this._iceGatherers=[],e.iceCandidatePoolSize)for(var s=e.iceCandidatePoolSize;0<s;s--)this._iceGatherers.push(new P.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=I.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}return Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=0<this.transceivers.length,e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};return this.usingBundle&&n?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(n=this._createIceAndDtlsTransports(),e.iceTransport=n.iceTransport,e.dtlsTransport=n.dtlsTransport),t||this.transceivers.push(e),e},i.prototype.addTrack=function(t,e){if(this._isClosed)throw d("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw d("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n=n||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),n.track=t,n.stream=e,n.rtpSender=new P.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},i.prototype.addStream=function(t){var i,n=this;15025<=O?t.getTracks().forEach(function(e){n.addTrack(e,t)}):(i=t.clone(),t.getTracks().forEach(function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),i.getTracks().forEach(function(e){n.addTrack(e,i)}))},i.prototype.removeTrack=function(t){if(this._isClosed)throw d("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof P.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw d("InvalidAccessError","Sender was not created by this connection.");var n=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&-1<this.localStreams.indexOf(n)&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var n=this;e.getTracks().forEach(function(t){var e=n.getSenders().find(function(e){return e.track===t});e&&n.removeTrack(e)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},i.prototype._createIceGatherer=function(n,e){var i=this;if(e&&0<n)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new P.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[n].bufferedCandidateEvents=[],this.transceivers[n].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;r.state=t?"completed":"gathering",null!==i.transceivers[n].bufferedCandidateEvents&&i.transceivers[n].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[n].bufferCandidates),r},i.prototype._gather=function(i,r){var e,o=this,s=this.transceivers[r].iceGatherer;s.onlocalcandidate||(e=this.transceivers[r].bufferedCandidateEvents,this.transceivers[r].bufferedCandidateEvents=null,s.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),s.onlocalcandidate=function(e){var t,n;o.usingBundle&&0<r||((t=new Event("icecandidate")).candidate={sdpMid:i,sdpMLineIndex:r},(n=!(e=e.candidate)||0===Object.keys(e).length)?"new"!==s.state&&"gathering"!==s.state||(s.state="completed"):("new"===s.state&&(s.state="gathering"),e.component=1,e.ufrag=s.getLocalParameters().usernameFragment,e=I.writeCandidate(e),t.candidate=Object.assign(t.candidate,I.parseCandidate(e)),t.candidate.candidate=e,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}),(e=I.getMediaSections(o._localDescription.sdp))[t.candidate.sdpMLineIndex]+=n?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",o._localDescription.sdp=I.getDescription(o._localDescription.sdp)+e.join(""),e=o.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}),"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),n||o._dispatchEvent("icecandidate",t),e&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange()))},P.setTimeout(function(){e.forEach(function(e){s.onlocalcandidate(e)})},0))},i.prototype._createIceAndDtlsTransports=function(){var e=this,t=new P.RTCIceTransport(null),n=(t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()},new P.RTCDtlsTransport(t));return n.ondtlsstatechange=function(){e._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:n}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer,t=(t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer),this.transceivers[e].iceTransport),t=(t&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport),this.transceivers[e].dtlsTransport);t&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,t,n){var i=R(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:I.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&0<i.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&O<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,u,l,h=this;return-1===["offer","answer"].indexOf(e.type)?Promise.reject(d("TypeError",'Unsupported type "'+e.type+'"')):!o("setLocalDescription",e.type,h.signalingState)||h._isClosed?Promise.reject(d("InvalidStateError","Can not set local "+e.type+" in state "+h.signalingState)):("offer"===e.type?(t=I.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){e=I.parseRtpParameters(e);h.transceivers[t].localCapabilities=e}),h.transceivers.forEach(function(e,t){h._gather(e.mid,t)})):"answer"===e.type&&(u=(t=I.splitSections(h._remoteDescription.sdp)).shift(),l=0<I.matchPrefix(u,"a=ice-lite").length,t.forEach(function(e,t){var n,i=h.transceivers[t],r=i.iceGatherer,o=i.iceTransport,s=i.dtlsTransport,a=i.localCapabilities,c=i.remoteCapabilities;I.isRejected(e)&&0===I.matchPrefix(e,"a=bundle-only").length||i.rejected||(n=I.getIceParameters(e,u),e=I.getDtlsParameters(e,u),l&&(e.role="server"),h.usingBundle&&0!==t||(h._gather(i.mid,t),"new"===o.state&&o.start(r,n,l?"controlling":"controlled"),"new"===s.state&&s.start(e)),t=R(a,c),h._transceive(i,0<t.codecs.length,!1))})),h._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?h._updateSignalingState("have-local-offer"):h._updateSignalingState("stable"),Promise.resolve())},i.prototype.setRemoteDescription=function(b){var C=this;if(-1===["offer","answer"].indexOf(b.type))return Promise.reject(d("TypeError",'Unsupported type "'+b.type+'"'));if(!o("setRemoteDescription",b.type,C.signalingState)||C._isClosed)return Promise.reject(d("InvalidStateError","Can not set remote "+b.type+" in state "+C.signalingState));var S={},x=(C.remoteStreams.forEach(function(e){S[e.id]=e}),[]),e=I.splitSections(b.sdp),T=e.shift(),E=0<I.matchPrefix(T,"a=ice-lite").length,k=0<I.matchPrefix(T,"a=group:BUNDLE ").length,t=(C.usingBundle=k,I.matchPrefix(T,"a=ice-options:")[0]);return C.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var n,l,i,h,d,r,f,p,g,v,m,_,o,s=I.splitLines(e),y=I.getKind(e),a=I.isRejected(e)&&0===I.matchPrefix(e,"a=bundle-only").length,s=s[0].substr(2).split(" ")[2],c=I.getDirection(e,T),u=I.parseMsid(e),w=I.getMid(e)||I.generateIdentifier();a||"application"===y&&("DTLS/SCTP"===s||"UDP/DTLS/SCTP"===s)?C.transceivers[t]={mid:w,kind:y,protocol:s,rejected:!0}:(!a&&C.transceivers[t]&&C.transceivers[t].rejected&&(C.transceivers[t]=C._createTransceiver(y,!0)),s=I.parseRtpParameters(e),a||(f=I.getIceParameters(e,T),(p=I.getDtlsParameters(e,T)).role="client"),h=I.parseRtpEncodingParameters(e),g=I.parseRtcpParameters(e),v=0<I.matchPrefix(e,"a=end-of-candidates",T).length,e=I.matchPrefix(e,"a=candidate:").map(function(e){return I.parseCandidate(e)}).filter(function(e){return 1===e.component}),("offer"===b.type||"answer"===b.type)&&!a&&k&&0<t&&C.transceivers[t]&&(C._disposeIceAndDtlsTransports(t),C.transceivers[t].iceGatherer=C.transceivers[0].iceGatherer,C.transceivers[t].iceTransport=C.transceivers[0].iceTransport,C.transceivers[t].dtlsTransport=C.transceivers[0].dtlsTransport,C.transceivers[t].rtpSender&&C.transceivers[t].rtpSender.setTransport(C.transceivers[0].dtlsTransport),C.transceivers[t].rtpReceiver&&C.transceivers[t].rtpReceiver.setTransport(C.transceivers[0].dtlsTransport)),"offer"!==b.type||a?"answer"!==b.type||a||(a=(n=C.transceivers[t]).iceGatherer,o=n.iceTransport,l=n.dtlsTransport,i=n.rtpReceiver,m=n.sendEncodingParameters,d=n.localCapabilities,C.transceivers[t].recvEncodingParameters=h,C.transceivers[t].remoteCapabilities=s,C.transceivers[t].rtcpParameters=g,e.length&&"new"===o.state&&(!E&&!v||k&&0!==t?e.forEach(function(e){A(n.iceTransport,e)}):o.setRemoteCandidates(e)),k&&0!==t||("new"===o.state&&o.start(a,f,"controlling"),"new"===l.state&&l.start(p)),!R(n.localCapabilities,n.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,C._transceive(n,"sendrecv"===c||"recvonly"===c,"sendrecv"===c||"sendonly"===c),!i||"sendrecv"!==c&&"sendonly"!==c?delete n.rtpReceiver:(r=i.track,u?(S[u.stream]||(S[u.stream]=new P.MediaStream),M(r,S[u.stream]),x.push([r,i,S[u.stream]])):(S.default||(S.default=new P.MediaStream),M(r,S.default),x.push([r,i,S.default])))):((n=C.transceivers[t]||C._createTransceiver(y)).mid=w,n.iceGatherer||(n.iceGatherer=C._createIceGatherer(t,k)),e.length&&"new"===n.iceTransport.state&&(!v||k&&0!==t?e.forEach(function(e){A(n.iceTransport,e)}):n.iceTransport.setRemoteCandidates(e)),d=P.RTCRtpReceiver.getCapabilities(y),O<15019&&(d.codecs=d.codecs.filter(function(e){return"rtx"!==e.name})),m=n.sendEncodingParameters||[{ssrc:1001*(2*t+2)}],o=!1,"sendrecv"===c||"sendonly"===c?(o=!n.rtpReceiver,i=n.rtpReceiver||new P.RTCRtpReceiver(n.dtlsTransport,y),o&&(r=i.track,(_=!u||"-"!==u.stream?u?(S[u.stream]||(S[u.stream]=new P.MediaStream,Object.defineProperty(S[u.stream],"id",{get:function(){return u.stream}})),Object.defineProperty(r,"id",{get:function(){return u.track}}),S[u.stream]):(S.default||(S.default=new P.MediaStream),S.default):_)&&(M(r,_),n.associatedRemoteMediaStreams.push(_)),x.push([r,i,_]))):n.rtpReceiver&&n.rtpReceiver.track&&(n.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===n.rtpReceiver.track.id});t&&((e=e).removeTrack(t=t),e.dispatchEvent(new P.MediaStreamTrackEvent("removetrack",{track:t})))}),n.associatedRemoteMediaStreams=[]),n.localCapabilities=d,n.remoteCapabilities=s,n.rtpReceiver=i,n.rtcpParameters=g,n.sendEncodingParameters=m,n.recvEncodingParameters=h,C._transceive(C.transceivers[t],!1,o)))}),void 0===C._dtlsRole&&(C._dtlsRole="offer"===b.type?"active":"passive"),C._remoteDescription={type:b.type,sdp:b.sdp},"offer"===b.type?C._updateSignalingState("have-remote-offer"):C._updateSignalingState("stable"),Object.keys(S).forEach(function(e){var t,i=S[e];i.getTracks().length&&(-1===C.remoteStreams.indexOf(i)&&(C.remoteStreams.push(i),(t=new Event("addstream")).stream=i,P.setTimeout(function(){C._dispatchEvent("addstream",t)})),x.forEach(function(e){var t=e[0],n=e[1];i.id===e[2].id&&r(C,t,n,[i])}))}),x.forEach(function(e){e[2]||r(C,e[0],e[1],[])}),P.setTimeout(function(){C&&C.transceivers&&C.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,P.setTimeout(function(){var e;t.needNegotiation&&(t.needNegotiation=!1,e=new Event("negotiationneeded"),t._dispatchEvent("negotiationneeded",e))},0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState&&(this.iceConnectionState=e,e=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",e))},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected&&(e="connected"),e!==this.connectionState&&(this.connectionState=e,e=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",e))},i.prototype.createOffer=function(){var o=this;if(o._isClosed)return Promise.reject(d("InvalidStateError","Can not call createOffer after close"));var t=o.transceivers.filter(function(e){return"audio"===e.kind}).length,n=o.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(n=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(o.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--n<0&&(e.wantReceive=!1)});0<t||0<n;)0<t&&(o._createTransceiver("audio"),t--),0<n&&(o._createTransceiver("video"),n--);var i=I.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++),e=(o.transceivers.forEach(function(e,t){var n=e.track,i=e.kind,r=e.mid||I.generateIdentifier(),r=(e.mid=r,e.iceGatherer||(e.iceGatherer=o._createIceGatherer(t,o.usingBundle)),P.RTCRtpSender.getCapabilities(i)),t=(O<15019&&(r.codecs=r.codecs.filter(function(e){return"rtx"!==e.name})),r.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),r.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})}),e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}]);n&&15019<=O&&"video"===i&&!t[0].rtx&&(t[0].rtx={ssrc:t[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new P.RTCRtpReceiver(e.dtlsTransport,i)),e.localCapabilities=r,e.sendEncodingParameters=t}),"max-compat"!==o._config.bundlePolicy&&(i+="a=group:BUNDLE "+o.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n",o.transceivers.forEach(function(e,t){i=i+s(e,e.localCapabilities,"offer",e.stream,o._dtlsRole)+"a=rtcp-rsize\r\n",!e.iceGatherer||"new"===o.iceGatheringState||0!==t&&o.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,i+="a="+I.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(i+="a=end-of-candidates\r\n"))}),new P.RTCSessionDescription({type:"offer",sdp:i}));return Promise.resolve(e)},i.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(d("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(d("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var r=I.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++),o=(i.usingBundle&&(r+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n",I.getMediaSections(i._remoteDescription.sdp).length),e=(i.transceivers.forEach(function(e,t){if(!(o<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");e.stream&&("audio"===e.kind?n=e.stream.getAudioTracks()[0]:"video"===e.kind&&(n=e.stream.getVideoTracks()[0]),n&&15019<=O&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n,t=R(e.localCapabilities,e.remoteCapabilities);!t.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=s(e,t,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}),new P.RTCSessionDescription({type:"answer",sdp:r}));return Promise.resolve(e)},i.prototype.addIceCandidate=function(a){var c,u=this;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!u._remoteDescription)return t(d("InvalidStateError","Can not add ICE candidate without a remote description"));if(a&&""!==a.candidate){var n=a.sdpMLineIndex;if(a.sdpMid)for(var i=0;i<u.transceivers.length;i++)if(u.transceivers[i].mid===a.sdpMid){n=i;break}var r=u.transceivers[n];if(!r)return t(d("OperationError","Can not add ICE candidate"));if(r.rejected)return e();var o=0<Object.keys(a.candidate).length?I.parseCandidate(a.candidate):{};if("tcp"===o.protocol&&(0===o.port||9===o.port))return e();if(o.component&&1!==o.component)return e();if((0===n||0<n&&r.iceTransport!==u.transceivers[0].iceTransport)&&!A(r.iceTransport,o))return t(d("OperationError","Can not add ICE candidate"));r=a.candidate.trim();0===r.indexOf("a=")&&(r=r.substr(2)),(c=I.getMediaSections(u._remoteDescription.sdp))[n]+="a="+(o.type?r:"end-of-candidates")+"\r\n",u._remoteDescription.sdp=I.getDescription(u._remoteDescription.sdp)+c.join("")}else for(var s=0;s<u.transceivers.length&&(u.transceivers[s].rejected||(u.transceivers[s].iceTransport.addRemoteCandidate({}),(c=I.getMediaSections(u._remoteDescription.sdp))[s]+="a=end-of-candidates\r\n",u._remoteDescription.sdp=I.getDescription(u._remoteDescription.sdp)+c.join(""),!u.usingBundle));s++);e()})},i.prototype.getStats=function(t){if(t&&t instanceof P.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw d("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&i.push(t[e].getStats())})}),Promise.all(i).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t,e=P[e];e&&e.prototype&&e.prototype.getStats&&(t=e.prototype.getStats,e.prototype.getStats=function(){return t.apply(this).then(function(n){var i=new Map;return Object.keys(n).forEach(function(e){var t;n[e].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(t=n[e]).type]||t.type,i.set(e,n[e])}),i})})}),["createOffer","createAnswer"].forEach(function(e){var n=i.prototype[e];i.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?n.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=i.prototype[e];i.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?n.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):n.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),i}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=(e=e&&e.navigator).mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject({name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}})})}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e,t){{var n;e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)&&(n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled"),Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}}))}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,s.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,o.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils")),o=e("./filtericeservers"),s=(n=e("rtcpeerconnection-shim"))&&n.__esModule?n:{default:n},i=e("./getusermedia"),a=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var i=e&&e.navigator,e=e&&e.MediaStreamTrack;{var n,r,o,s;i.getUserMedia=function(e,t,n){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},55<t.version&&"autoGainControl"in i.mediaDevices.getSupportedConstraints()||(n=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},r=i.mediaDevices.getUserMedia.bind(i.mediaDevices),i.mediaDevices.getUserMedia=function(e){return"object"===c(e)&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),r(e)},e&&e.prototype.getSettings&&(o=e.prototype.getSettings,e.prototype.getSettings=function(){var e=o.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}),e&&e.prototype.applyConstraints&&(s=e.prototype.applyConstraints,e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===c(e)&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}))}};var a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){return e&&e.video?(!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e)):((e=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",e.code=8,Promise.reject(e))})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===a(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(o,i){{var r,s;"object"===a(o)&&(o.RTCPeerConnection||o.mozRTCPeerConnection)&&(!o.RTCPeerConnection&&o.mozRTCPeerConnection&&(o.RTCPeerConnection=o.mozRTCPeerConnection),i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t,n,i,r=o.RTCPeerConnection.prototype[e];i=function(){return arguments[0]=new("addIceCandidate"===e?o.RTCIceCandidate:o.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)},(n=e)in(t={})?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,o.RTCPeerConnection.prototype[e]=t[e]}),r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=o.RTCPeerConnection.prototype.getStats,o.RTCPeerConnection.prototype.getStats=function(){var[e,t,n]=arguments;return s.apply(this,[e||null]).then(function(n){if(i.version<53&&!t)try{n.forEach(function(e){e.type=r[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:r[e.type]||e.type}))})}return n}).then(t,n)})}},n.shimSenderGetStats=function(e){{var n,t;"object"!==a(e)||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)})}},n.shimReceiverGetStats=function(e){{var n;"object"!==a(e)||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype||((n=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),i.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)})}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){var n=this;i.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){{var r;"object"!==a(e)||!e.RTCPeerConnection||(r=e.RTCPeerConnection.prototype.addTransceiver)&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e,t=arguments[1],n=t&&"sendEncodings"in t,i=(n&&t.sendEncodings.forEach(function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")}),r.apply(this,arguments));return n&&(e=i["sender"],"encodings"in(n=e.getParameters())&&(1!==n.encodings.length||0!==Object.keys(n.encodings[0]).length)||(n.encodings=t.sendEncodings,e.sendEncodings=t.sendEncodings,this.setParametersPromises.push(e.setParameters(n).then(function(){delete e.sendEncodings}).catch(function(){delete e.sendEncodings})))),i})}},n.shimGetParameters=function(e){{var t;"object"!==a(e)||!e.RTCRtpSender||(t=e.RTCRtpSender.prototype.getParameters)&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}},n.shimCreateOffer=function(e){{var n;"object"===a(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createOffer,e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})}},n.shimCreateAnswer=function(e){{var n;"object"===a(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createAnswer,e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils")),r=e("./getusermedia"),o=e("./getdisplaymedia");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){{var o;"object"===c(e)&&e.RTCPeerConnection&&("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"addStream"in e.RTCPeerConnection.prototype||(o=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return o.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return o.call(n,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var t=this,n=arguments.length,i=new Array(1<n?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach(function(e){t._localStreams?t._localStreams.includes(e)||t._localStreams.push(e):t._localStreams=[e]}),o.apply(this,arguments)}),"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,n=this,i=(this._localStreams||(this._localStreams=[]),this._localStreams.indexOf(e));-1!==i&&(this._localStreams.splice(i,1),t=e.getTracks(),this.getSenders().forEach(function(e){t.includes(e.track)&&n.removeTrack(e)}))}))}},n.shimRemoteStreamsAPI=function(e){{var t;"object"!==c(e)||!e.RTCPeerConnection||("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams||[]}),"onaddstream"in e.RTCPeerConnection.prototype)||(Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var n=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.includes(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})})}}),t=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),0<=n._remoteStreams.indexOf(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})}),t.apply(n,arguments)})}},n.shimCallbacksAPI=function(e){{var i,r,o,s,a,t;"object"===c(e)&&e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,i=e.createOffer,r=e.createAnswer,o=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate,e.createOffer=function(e,t){var n=i.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},e.createAnswer=function(e,t){var n=r.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},t=function(e,t,n){e=o.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setLocalDescription=t,t=function(e,t,n){e=s.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setRemoteDescription=t,t=function(e,t,n){e=a.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.addIceCandidate=t)}},n.shimGetUserMedia=function(e){var i=e&&e.navigator;{var t;i.mediaDevices&&i.mediaDevices.getUserMedia&&(e=i.mediaDevices,t=e.getUserMedia.bind(e),i.mediaDevices.getUserMedia=function(e){return t(r(e))})}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=function(e,t,n){i.mediaDevices.getUserMedia(e).then(t,n)}.bind(i))},n.shimConstraints=r,n.shimRTCIceServerUrls=function(e){{var o;e.RTCPeerConnection&&(o=e.RTCPeerConnection,e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var r=e.iceServers[i];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(r=JSON.parse(JSON.stringify(r))).urls=r.url,delete r.url,n.push(r)):n.push(e.iceServers[i])}e.iceServers=n}return new o(e,t)},e.RTCPeerConnection.prototype=o.prototype,"generateCertificate"in o&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}}))}},n.shimTrackEventTransceiver=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t;return e&&(void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio),t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind}),!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),t=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveVideo||t||this.addTransceiver("video")),n.apply(this,arguments)}},n.shimAudioContext=function(e){"object"!==c(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)};var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("../utils"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return e&&void 0!==e.video?Object.assign({},e,{video:s.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(t){{var r;!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype||(r=t.RTCIceCandidate,t.RTCIceCandidate=function(e){var t,n,i;return"object"===o(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length?(t=new r(e),n=a.default.parseCandidate(e.candidate),(i=Object.assign(t,n)).toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i):new r(e)},t.RTCIceCandidate.prototype=r.prototype,i.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))}},n.shimMaxMessageSize=function(e,o){{var s;e.RTCPeerConnection&&("sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}}),s=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,t,n,i,r;return this._sctp=null,"chrome"===o.browser&&76<=o.version&&(n=this.getConfiguration()["sdpSemantics"],"plan-b"===n&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})),function(e){if(e&&e.sdp)return e=a.default.splitSections(e.sdp),e.shift(),e.some(function(e){e=a.default.parseMLine(e);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")})}(arguments[0])&&(n=function(e){e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;e=parseInt(e[1],10);return e!=e?-1:e}(arguments[0]),r=65536,r=r="firefox"===o.browser?o.version<57?-1===n?16384:2147483637:o.version<60?57===o.version?65535:65536:2147483637:r,t=arguments[0],n=n,i=65536,"firefox"===o.browser&&57===o.version&&(i=65535),0<(t=a.default.matchPrefix(t.sdp,"a=max-message-size:")).length?i=parseInt(t[0].substr(19),10):"firefox"===o.browser&&-1!==n&&(i=2147483637),t=i,e=0===r&&0===t?Number.POSITIVE_INFINITY:0===r||0===t?Math.max(r,t):Math.min(r,t),i={},Object.defineProperty(i,"maxMessageSize",{get:function(){return e}}),this._sctp=i),s.apply(this,arguments)})}},n.shimSendThrowTypeError=function(e){{var t;e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype&&(t=e.RTCPeerConnection.prototype.createDataChannel,e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",function(e){return n(e.channel,e.target),e}))}function n(t,n){var i=t.send;t.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===t.readyState&&n.sctp&&e>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(t,arguments)}}},n.shimConnectionState=function(e){{var n;!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype||(n=e.RTCPeerConnection.prototype,Object.defineProperty(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t,n=e.target;return n._lastConnectionState!==n.connectionState&&(n._lastConnectionState=n.connectionState,t=new Event("connectionstatechange",e),n.dispatchEvent(t)),e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))}},n.removeExtmapAllowMixed=function(n,e){{var i;n.RTCPeerConnection&&!("chrome"===e.browser&&71<=e.version||"safari"===e.browser&&605<=e.version)&&(i=n.RTCPeerConnection.prototype.setRemoteDescription,n.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t;return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(t=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n"),n.RTCSessionDescription&&e instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:e.type,sdp:t}):e.sdp=t),i.apply(this,arguments)})}},n.shimAddIceCandidateNullOrEmpty=function(e,t){{var n;e.RTCPeerConnection&&e.RTCPeerConnection.prototype&&((n=e.RTCPeerConnection.prototype.addIceCandidate)&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}))}};var a=(n=e("sdp"))&&n.__esModule?n:{default:n},i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n,i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;Object.prototype.hasOwnProperty.call(e,n)&&((o=r?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n])}return i.default=e,t&&t.set(e,i),i}(e("./utils"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,i,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["window"],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=o.log,i=o.detectBrowser(e),r={browserDetails:i,commonShim:l,extractVersion:o.extractVersion,disableLog:o.disableLog,disableWarnings:o.disableWarnings};switch(i.browser){case"chrome":if(!s||!s.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=s,l.shimAddIceCandidateNullOrEmpty(e,i),s.shimGetUserMedia(e,i),s.shimMediaStream(e,i),s.shimPeerConnection(e,i),s.shimOnTrack(e,i),s.shimAddTrackRemoveTrack(e,i),s.shimGetSendersWithDtmf(e,i),s.shimGetStats(e,i),s.shimSenderReceiverGetStats(e,i),s.fixNegotiationNeeded(e,i),l.shimRTCIceCandidate(e,i),l.shimConnectionState(e,i),l.shimMaxMessageSize(e,i),l.shimSendThrowTypeError(e,i),l.removeExtmapAllowMixed(e,i);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=c,l.shimAddIceCandidateNullOrEmpty(e,i),c.shimGetUserMedia(e,i),c.shimPeerConnection(e,i),c.shimOnTrack(e,i),c.shimRemoveStream(e,i),c.shimSenderGetStats(e,i),c.shimReceiverGetStats(e,i),c.shimRTCDataChannel(e,i),c.shimAddTransceiver(e,i),c.shimGetParameters(e,i),c.shimCreateOffer(e,i),c.shimCreateAnswer(e,i),l.shimRTCIceCandidate(e,i),l.shimConnectionState(e,i),l.shimMaxMessageSize(e,i),l.shimSendThrowTypeError(e,i);break;case"edge":if(!a||!a.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),r;n("adapter.js shimming edge."),(r.browserShim=a).shimGetUserMedia(e,i),a.shimGetDisplayMedia(e,i),a.shimPeerConnection(e,i),a.shimReplaceTrack(e,i),l.shimMaxMessageSize(e,i),l.shimSendThrowTypeError(e,i);break;case"safari":if(!u||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=u,l.shimAddIceCandidateNullOrEmpty(e,i),u.shimRTCIceServerUrls(e,i),u.shimCreateOfferLegacy(e,i),u.shimCallbacksAPI(e,i),u.shimLocalStreamsAPI(e,i),u.shimRemoteStreamsAPI(e,i),u.shimTrackEventTransceiver(e,i),u.shimGetUserMedia(e,i),u.shimAudioContext(e,i),l.shimRTCIceCandidate(e,i),l.shimMaxMessageSize(e,i),l.shimSendThrowTypeError(e,i),l.removeExtmapAllowMixed(e,i);break;default:n("Unsupported browser!")}return r};var o=n(e("./utils")),s=n(e("./chrome/chrome_shim")),a=n(e("./edge/edge_shim")),c=n(e("./firefox/firefox_shim")),u=n(e("./safari/safari_shim")),l=n(e("./common_shim"));function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var n,i,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]);return r.default=e,t&&t.set(e,r),r}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=(n.default=void 0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});n.default=e},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(n,"__esModule",{value:!0}),n.webRTCAdapter=void 0,i(e("webrtc-adapter")));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Supports=void 0;var i=e("./adapter");function r(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}n.Supports=(r.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},r.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},r.prototype.getBrowser=function(){return i.webRTCAdapter.browserDetails.browser},r.prototype.getVersion=function(){return i.webRTCAdapter.browserDetails.version||0},r.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=i.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&59<=n)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;t=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),t=!0}catch(e){}finally{e&&e.close()}return t},r.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},new r)},{"./adapter":"sXtV"}],BHXf:[function(e,u,c){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){e[i=void 0===i?n:i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},n=(Object.defineProperty(c,"__esModule",{value:!0}),c.util=void 0,t(e("peerjs-js-binarypack"))),o=e("./supports"),s={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};function a(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=s,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(s),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=n.pack,this.unpack=n.unpack,this._dataCount=1}c.util=(a.prototype.noop=function(){},a.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},a.prototype.chunk=function(e){for(var t=[],n=e.size,i=Math.ceil(n/c.util.chunkedMTU),r=0,o=0;o<n;){var s=Math.min(n,o+c.util.chunkedMTU),a=e.slice(o,s),a={__peerData:this._dataCount,n:r,data:a,total:i};t.push(a),o=s,r++}return this._dataCount++,t},a.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},a.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},a.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},a.prototype.isSecure=function(){return"https:"===location.protocol},new a)},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,a){"use strict";var i=Object.prototype.hasOwnProperty,f="~";function n(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,n,i,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");n=new o(n,i||e,r),i=f?f+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],n]:e._events[i].push(n):(e._events[i]=n,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(f=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(f?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var e=f?f+e:e,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,i=t.length,r=new Array(i);n<i;n++)r[n]=t[n].fn;return r},s.prototype.listenerCount=function(e){e=f?f+e:e,e=this._events[e];return e?e.fn?1:e.length:0},s.prototype.emit=function(e,t,n,i,u,l){var h=f?f+e:e;if(!this._events[h])return!1;var r,o=this._events[h],s=arguments.length;if(o.fn){switch(o.once&&this.removeListener(e,o.fn,void 0,!0),s){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,t),!0;case 3:return o.fn.call(o.context,t,n),!0;case 4:return o.fn.call(o.context,t,n,i),!0;case 5:return o.fn.call(o.context,t,n,i,u),!0;case 6:return o.fn.call(o.context,t,n,i,u,l),!0}for(c=1,r=new Array(s-1);c<s;c++)r[c-1]=arguments[c];o.fn.apply(o.context,r)}else for(var a,d=o.length,c=0;c<d;c++)switch(o[c].once&&this.removeListener(e,o[c].fn,void 0,!0),s){case 1:o[c].fn.call(o[c].context);break;case 2:o[c].fn.call(o[c].context,t);break;case 3:o[c].fn.call(o[c].context,t,n);break;case 4:o[c].fn.call(o[c].context,t,n,i);break;default:if(!r)for(a=1,r=new Array(s-1);a<s;a++)r[a-1]=arguments[a];o[c].fn.apply(o[c].context,r)}return!0},s.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,n,i){e=f?f+e:e;if(!this._events[e])return this;if(!t)return c(this,e),this;var r=this._events[e];if(r.fn)r.fn!==t||i&&!r.once||n&&r.context!==n||c(this,e);else{for(var o=0,s=[],a=r.length;o<a;o++)(r[o].fn!==t||i&&!r[o].once||n&&r[o].context!==n)&&s.push(r[o]);s.length?this._events[e]=1===s.length?s[0]:s:c(this,e)}return this},s.prototype.removeAllListeners=function(e){return e?(e=f?f+e:e,this._events[e]&&c(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=f,s.EventEmitter=s,void 0!==t&&(t.exports=s)},{}],WOs9:[function(e,t,n){"use strict";var o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},s=this&&this.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e};Object.defineProperty(n,"__esModule",{value:!0}),n.LogLevel=void 0;(i=a=n.LogLevel||(n.LogLevel={}))[i.Disabled=0]="Disabled",i[i.Errors=1]="Errors",i[i.Warnings=2]="Warnings",i[i.All=3]="All",Object.defineProperty(r.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),r.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.All&&this._print.apply(this,s([a.All],o(e)))},r.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.Warnings&&this._print.apply(this,s([a.Warnings],o(e)))},r.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=a.Errors&&this._print.apply(this,s([a.Errors],o(e)))},r.prototype.setLogFunction=function(e){this._print=e},r.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i,r=s(["PeerJS: "],o(t));for(i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=a.All?console.log.apply(console,s([],o(r))):e>=a.Warnings?console.warn.apply(console,s(["WARNING"],o(r))):e>=a.Errors&&console.error.apply(console,s(["ERROR"],o(r)))};var a,i=r;function r(){this._logLevel=a.Disabled}n.default=new i},{}],ZRYf:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),n.ServerMessageType=n.SocketEventType=n.SerializationType=n.PeerErrorType=n.PeerEventType=n.ConnectionType=n.ConnectionEventType=void 0,(i=n.ConnectionEventType||(n.ConnectionEventType={})).Open="open",i.Stream="stream",i.Data="data",i.Close="close",i.Error="error",i.IceStateChanged="iceStateChanged",(i=n.ConnectionType||(n.ConnectionType={})).Data="data",i.Media="media",(i=n.PeerEventType||(n.PeerEventType={})).Open="open",i.Close="close",i.Connection="connection",i.Call="call",i.Disconnected="disconnected",i.Error="error",(i=n.PeerErrorType||(n.PeerErrorType={})).BrowserIncompatible="browser-incompatible",i.Disconnected="disconnected",i.InvalidID="invalid-id",i.InvalidKey="invalid-key",i.Network="network",i.PeerUnavailable="peer-unavailable",i.SslUnavailable="ssl-unavailable",i.ServerError="server-error",i.SocketError="socket-error",i.SocketClosed="socket-closed",i.UnavailableID="unavailable-id",i.WebRTC="webrtc",(i=n.SerializationType||(n.SerializationType={})).Binary="binary",i.BinaryUTF8="binary-utf8",i.JSON="json",(i=n.SocketEventType||(n.SocketEventType={})).Message="message",i.Disconnected="disconnected",i.Error="error",i.Close="close",(i=n.ServerMessageType||(n.ServerMessageType={})).Heartbeat="HEARTBEAT",i.Candidate="CANDIDATE",i.Offer="OFFER",i.Answer="ANSWER",i.Open="OPEN",i.Error="ERROR",i.IdTaken="ID-TAKEN",i.InvalidKey="INVALID-KEY",i.Leave="LEAVE",i.Expire="EXPIRE"},{}],wJlv:[function(e,l,t){"use strict";var i,a,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},c=this&&this.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},h=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},f=(Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0,e("eventemitter3")),r=d(e("./logger")),o=e("./enums");function u(e,t,n,i,r,o){void 0===o&&(o=5e3);var s=a.call(this)||this,o=(s.pingInterval=o,s._disconnected=!0,s._messagesQueue=[],e?"wss://":"ws://");return s._baseUrl=o+t+":"+n+i+"peerjs?key="+r,s}a=f.EventEmitter,n(u,a),u.prototype.start=function(e,t){var n=this,e=(this._id=e,this._baseUrl+"&id="+e+"&token="+t);!this._socket&&this._disconnected&&(this._socket=new WebSocket(e),this._disconnected=!1,this._socket.onmessage=function(t){var e;try{e=JSON.parse(t.data),r.default.log("Server message received:",e)}catch(e){return void r.default.log("Invalid server message",t.data)}n.emit(o.SocketEventType.Message,e)},this._socket.onclose=function(e){n._disconnected||(r.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(o.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),r.default.log("Socket open"),n._scheduleHeartbeat())})},u.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout(function(){e._sendHeartbeat()},this.pingInterval)},u.prototype._sendHeartbeat=function(){var e;this._wsOpen()?(e=JSON.stringify({type:o.ServerMessageType.Heartbeat}),this._socket.send(e),this._scheduleHeartbeat()):r.default.log("Cannot send heartbeat, because socket closed")},u.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},u.prototype._sendQueuedMessages=function(){var t,e,n=c([],s(this._messagesQueue));this._messagesQueue=[];try{for(var i=h(n),r=i.next();!r.done;r=i.next()){var o=r.value;this.send(o)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},u.prototype.send=function(e){var t;this._disconnected||(this._id?e.type?this._wsOpen()&&(t=JSON.stringify(e),this._socket.send(t)):this.emit(o.SocketEventType.Error,"Invalid message"):this._messagesQueue.push(e))},u.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},u.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t.Socket=u},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,o,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,s,a,c){return new(a=a||Promise)(function(n,t){function i(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(i,r)}o((c=c.apply(e,s||[])).next())})},c=this&&this.__generator||function(i,r){var o,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,s=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(i,c)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=(Object.defineProperty(t,"__esModule",{value:!0}),t.Negotiator=void 0,e("./util")),u=i(e("./logger")),l=e("./enums");function r(e){this.connection=e}r.prototype.startConnection=function(e){var t,n,i=this._startPeerConnection();this.connection.peerConnection=i,this.connection.type===l.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,i),e.originator?(this.connection.type===l.ConnectionType.Data&&(t=this.connection,n={ordered:!!e.reliable},i=i.createDataChannel(t.label,n),t.initialize(i)),this._makeOffer()):this.handleSDP("OFFER",e.sdp)},r.prototype._startPeerConnection=function(){u.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},r.prototype._setupListeners=function(e){var n=this,i=this.connection.peer,r=this.connection.connectionId,t=this.connection.type,o=this.connection.provider;u.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(u.default.log("Received ICE candidates for "+i+":",e.candidate),o.socket.send({type:l.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:t,connectionId:r},dst:i}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":u.default.log("iceConnectionState is failed, closing connections to "+i),n.connection.emit(l.ConnectionEventType.Error,new Error("Negotiation of connection to "+i+" failed.")),n.connection.close();break;case"closed":u.default.log("iceConnectionState is closed, closing connections to "+i),n.connection.emit(l.ConnectionEventType.Error,new Error("Connection to "+i+" closed.")),n.connection.close();break;case"disconnected":u.default.log("iceConnectionState changed to disconnected on the connection with "+i);break;case"completed":e.onicecandidate=a.util.noop}n.connection.emit(l.ConnectionEventType.IceStateChanged,e.iceConnectionState)},u.default.log("Listening for data channel"),e.ondatachannel=function(e){u.default.log("Received data channel");e=e.channel;o.getConnection(i,r).initialize(e)},u.default.log("Listening for remote stream"),e.ontrack=function(e){u.default.log("Received remote stream");var e=e.streams[0],t=o.getConnection(i,r);t.type===l.ConnectionType.Media&&n._addStreamToMediaConnection(e,t)}},r.prototype.cleanup=function(){u.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e,t,n,i=this.connection.peerConnection;i&&(this.connection.peerConnection=null,i.onicecandidate=i.oniceconnectionstatechange=i.ondatachannel=i.ontrack=function(){},e="closed"!==i.signalingState,t=!1,this.connection.type!==l.ConnectionType.Data||(n=this.connection.dataChannel)&&(t=!!n.readyState&&"closed"!==n.readyState),(e||t)&&i.close())},r.prototype._makeOffer=function(){return n(this,void 0,Promise,function(){var t,n,i,r,o;return c(this,function(e){switch(e.label){case 0:t=this.connection.peerConnection,n=this.connection.provider,e.label=1;case 1:return e.trys.push([1,7,,8]),[4,t.createOffer(this.connection.options.constraints)];case 2:i=e.sent(),u.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,t.setLocalDescription(i)];case 4:return e.sent(),u.default.log("Set localDescription:",i,"for:"+this.connection.peer),o={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:a.util.browser},this.connection.type===l.ConnectionType.Data&&(r=this.connection,o=s(s({},o),{label:r.label,reliable:r.reliable,serialization:r.serialization})),n.socket.send({type:l.ServerMessageType.Offer,payload:o,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(r=e.sent())&&(n.emitError(l.PeerErrorType.WebRTC,r),u.default.log("Failed to setLocalDescription, ",r)),[3,6];case 6:return[3,8];case 7:return o=e.sent(),n.emitError(l.PeerErrorType.WebRTC,o),u.default.log("Failed to createOffer, ",o),[3,8];case 8:return[2]}})})},r.prototype._makeAnswer=function(){return n(this,void 0,Promise,function(){var t,n,i,r;return c(this,function(e){switch(e.label){case 0:t=this.connection.peerConnection,n=this.connection.provider,e.label=1;case 1:return e.trys.push([1,7,,8]),[4,t.createAnswer()];case 2:i=e.sent(),u.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,t.setLocalDescription(i)];case 4:return e.sent(),u.default.log("Set localDescription:",i,"for:"+this.connection.peer),n.socket.send({type:l.ServerMessageType.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,browser:a.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=e.sent(),n.emitError(l.PeerErrorType.WebRTC,r),u.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return r=e.sent(),n.emitError(l.PeerErrorType.WebRTC,r),u.default.log("Failed to create answer, ",r),[3,8];case 8:return[2]}})})},r.prototype.handleSDP=function(o,s){return n(this,void 0,Promise,function(){var t,n,i,r;return c(this,function(e){switch(e.label){case 0:s=new RTCSessionDescription(s),t=this.connection.peerConnection,n=this.connection.provider,u.default.log("Setting remote description",s),i=this,e.label=1;case 1:return e.trys.push([1,5,,6]),[4,t.setRemoteDescription(s)];case 2:return e.sent(),u.default.log("Set remoteDescription:"+o+" for:"+this.connection.peer),"OFFER"!==o?[3,4]:[4,i._makeAnswer()];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:return r=e.sent(),n.emitError(l.PeerErrorType.WebRTC,r),u.default.log("Failed to setRemoteDescription, ",r),[3,6];case 6:return[2]}})})},r.prototype.handleCandidate=function(a){return n(this,void 0,Promise,function(){var t,n,i,r,o,s;return c(this,function(e){switch(e.label){case 0:u.default.log("handleCandidate:",a),t=a.candidate,n=a.sdpMLineIndex,i=a.sdpMid,r=this.connection.peerConnection,o=this.connection.provider,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:n,candidate:t}))];case 2:return e.sent(),u.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=e.sent(),o.emitError(l.PeerErrorType.WebRTC,s),u.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}})})},r.prototype._addTracksToConnection=function(t,n){if(u.default.log("add tracks from stream "+t.id+" to peer connection"),!n.addTrack)return u.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach(function(e){n.addTrack(e,t)})},r.prototype._addStreamToMediaConnection=function(e,t){u.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},t.Negotiator=r},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var i,r,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),e=(Object.defineProperty(n,"__esModule",{value:!0}),n.BaseConnection=void 0,e("eventemitter3"));function s(e,t,n){var i=r.call(this)||this;return i.peer=e,i.provider=t,i.options=n,i._open=!1,i.metadata=n.metadata,i}r=e.EventEmitter,o(s,r),Object.defineProperty(s.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),n.BaseConnection=s},{eventemitter3:"JJlS"}],dbHP:[function(e,l,t){"use strict";var i,r,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},h=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},d=(Object.defineProperty(t,"__esModule",{value:!0}),t.MediaConnection=void 0,e("./util")),c=o(e("./logger")),f=e("./negotiator"),s=e("./enums"),o=e("./baseconnection");function u(e,t,n){e=r.call(this,e,t,n)||this;return e._localStream=e.options._stream,e.connectionId=e.options.connectionId||u.ID_PREFIX+d.util.randomToken(),e._negotiator=new f.Negotiator(e),e._localStream&&e._negotiator.startConnection({_stream:e._localStream,originator:!0}),e}r=o.BaseConnection,n(u,r),Object.defineProperty(u.prototype,"type",{get:function(){return s.ConnectionType.Media},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"localStream",{get:function(){return this._localStream},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!1,configurable:!0}),u.prototype.addStream=function(e){c.default.log("Receiving stream",e),this._remoteStream=e,r.prototype.emit.call(this,s.ConnectionEventType.Stream,e)},u.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case s.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case s.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},u.prototype.answer=function(e,t){var n,i;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(a(a({},this.options._payload),{_stream:e}));t=this.provider._getMessages(this.connectionId);try{for(var r=h(t),o=r.next();!o.done;o=r.next()){var s=o.value;this.handleMessage(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this._open=!0}},u.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,r.prototype.emit.call(this,s.ConnectionEventType.Close))},u.ID_PREFIX="mc_",t.MediaConnection=u},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,u,t){"use strict";var i,n,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.EncodingQueue=void 0,e("eventemitter3")),a=o(e("./logger"));function c(){var t=n.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}n=s.EventEmitter,r(c,n),Object.defineProperty(c.prototype,"queue",{get:function(){return this._queue},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"size",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),c.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},c.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},c.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t.EncodingQueue=c},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,l,t){"use strict";var i,r,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.DataConnection=void 0,e("./util")),a=o(e("./logger")),d=e("./negotiator"),c=e("./enums"),o=e("./baseconnection"),f=e("./encodingQueue");function u(e,t,n){var i=r.call(this,e,t,n)||this;return i.stringify=JSON.stringify,i.parse=JSON.parse,i._buffer=[],i._bufferSize=0,i._buffering=!1,i._chunkedData={},i._encodingQueue=new f.EncodingQueue,i.connectionId=i.options.connectionId||u.ID_PREFIX+s.util.randomToken(),i.label=i.options.label||i.connectionId,i.serialization=i.options.serialization||c.SerializationType.Binary,i.reliable=!!i.options.reliable,i._encodingQueue.on("done",function(e){i._bufferedSend(e)}),i._encodingQueue.on("error",function(){a.default.error("DC#"+i.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),i.close()}),i._negotiator=new d.Negotiator(i),i._negotiator.startConnection(i.options._payload||{originator:!0}),i}r=o.BaseConnection,n(u,r),Object.defineProperty(u.prototype,"type",{get:function(){return c.ConnectionType.Data},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!1,configurable:!0}),u.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},u.prototype._configureDataChannel=function(){var t=this;s.util.supports.binaryBlob&&!s.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){a.default.log("DC#"+t.connectionId+" dc connection success"),t._open=!0,t.emit(c.ConnectionEventType.Open)},this.dataChannel.onmessage=function(e){a.default.log("DC#"+t.connectionId+" dc onmessage:",e.data),t._handleDataMessage(e)},this.dataChannel.onclose=function(){a.default.log("DC#"+t.connectionId+" dc closed for:",t.peer),t.close()}},u.prototype._handleDataMessage=function(e){var t=this,e=e.data,n=e.constructor,i=e;if(this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8){if(n===Blob)return void s.util.blobToArrayBuffer(e,function(e){e=s.util.unpack(e);t.emit(c.ConnectionEventType.Data,e)});n===ArrayBuffer?i=s.util.unpack(e):n===String&&(n=s.util.binaryStringToArrayBuffer(e),i=s.util.unpack(n))}else this.serialization===c.SerializationType.JSON&&(i=this.parse(e));i.__peerData?this._handleChunk(i):r.prototype.emit.call(this,c.ConnectionEventType.Data,i)},u.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};n.data[e.n]=e.data,n.count++,(this._chunkedData[t]=n).total===n.count&&(delete this._chunkedData[t],e=new Blob(n.data),this._handleDataMessage({data:e}))},u.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,r.prototype.emit.call(this,c.ConnectionEventType.Close))},u.prototype.send=function(e,t){var n;this.open?this.serialization===c.SerializationType.JSON?this._bufferedSend(this.stringify(e)):this.serialization===c.SerializationType.Binary||this.serialization===c.SerializationType.BinaryUTF8?(n=s.util.pack(e),!t&&n.size>s.util.chunkedMTU?this._sendChunks(n):s.util.supports.binaryBlob?this._bufferedSend(n):this._encodingQueue.enque(n)):this._bufferedSend(e):r.prototype.emit.call(this,c.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},u.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},u.prototype._trySend=function(e){var t=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>u.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(function(){t._buffering=!1,t._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(e){return a.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},u.prototype._tryBuffer=function(){var e;this.open&&0!==this._buffer.length&&(e=this._buffer[0],this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer()))},u.prototype._sendChunks=function(e){var t,n,e=s.util.chunk(e);a.default.log("DC#"+this.connectionId+" Try to send "+e.length+" chunks...");try{for(var i=h(e),r=i.next();!r.done;r=i.next()){var o=r.value;this.send(o,!0)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},u.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case c.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case c.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:a.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},u.ID_PREFIX="dc_",u.MAX_BUFFERED_AMOUNT=8388608,t.DataConnection=u},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,s,a,c){return new(a=a||Promise)(function(n,t){function i(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(i,r)}o((c=c.apply(e,s||[])).next())})},r=this&&this.__generator||function(i,r){var o,s,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,s=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(i,c)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=(Object.defineProperty(n,"__esModule",{value:!0}),n.API=void 0,e("./util")),a=o(e("./logger"));function c(e){this._options=e}c.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+("?ts="+(new Date).getTime()+Math.random())},c.prototype.retrieveId=function(){return i(this,void 0,Promise,function(){var t,n,i;return r(this,function(e){switch(e.label){case 0:t=this._buildUrl("id"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200!==(n=e.sent()).status)throw new Error("Error. Status:"+n.status);return[2,n.text()];case 3:throw n=e.sent(),a.default.error("Error retrieving ID",n),i="","/"===this._options.path&&this._options.host!==s.util.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i);case 4:return[2]}})})},c.prototype.listAllPeers=function(){return i(this,void 0,Promise,function(){var t,n,i;return r(this,function(e){switch(e.label){case 0:t=this._buildUrl("peers"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(t)];case 2:if(200===(n=e.sent()).status)return[2,n.json()];if(401===n.status)throw i=this._options.host===s.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+i);throw new Error("Error. Status:"+n.status);case 3:throw i=e.sent(),a.default.error("Error retrieving list peers",i),new Error("Could not get list peers from the server."+i);case 4:return[2]}})})},n.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,n,t){"use strict";var i,r,c=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},d=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},h=(Object.defineProperty(t,"__esModule",{value:!0}),t.Peer=void 0,e("eventemitter3")),s=e("./util"),f=l(e("./logger")),g=e("./socket"),v=e("./mediaconnection"),m=e("./dataconnection"),p=e("./enums"),_=e("./api");function a(e,t){var n,i=r.call(this)||this;return i._id=null,i._lastServerId=null,i._destroyed=!1,i._disconnected=!1,i._open=!1,i._connections=new Map,i._lostMessages=new Map,e&&e.constructor==Object?t=e:e&&(n=e.toString()),t=o({debug:0,host:s.util.CLOUD_HOST,port:s.util.CLOUD_PORT,path:"/",key:a.DEFAULT_KEY,token:s.util.randomToken(),config:s.util.defaultConfig},t),i._options=t,"/"===i._options.host&&(i._options.host=window.location.hostname),i._options.path&&("/"!==i._options.path[0]&&(i._options.path="/"+i._options.path),"/"!==i._options.path[i._options.path.length-1]&&(i._options.path+="/")),void 0===i._options.secure&&i._options.host!==s.util.CLOUD_HOST?i._options.secure=s.util.isSecure():i._options.host==s.util.CLOUD_HOST&&(i._options.secure=!0),i._options.logFunction&&f.default.setLogFunction(i._options.logFunction),f.default.logLevel=i._options.debug||0,i._api=new _.API(t),i._socket=i._createServerConnection(),s.util.supports.audioVideo||s.util.supports.data?n&&!s.util.validateId(n)?i._delayedAbort(p.PeerErrorType.InvalidID,'ID "'+n+'" is invalid'):n?i._initialize(n):i._api.retrieveId().then(function(e){return i._initialize(e)}).catch(function(e){return i._abort(p.PeerErrorType.ServerError,e)}):i._delayedAbort(p.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),i}r=h.EventEmitter,c(a,r),Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"open",{get:function(){return this._open},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"socket",{get:function(){return this._socket},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"connections",{get:function(){var t,e,n=Object.create(null);try{for(var i=d(this._connections),r=i.next();!r.done;r=i.next()){var o=u(r.value,2),s=o[0],a=o[1];n[s]=a}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!1,configurable:!0}),a.prototype._createServerConnection=function(){var t=this,e=new g.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(p.SocketEventType.Message,function(e){t._handleMessage(e)}),e.on(p.SocketEventType.Error,function(e){t._abort(p.PeerErrorType.SocketError,e)}),e.on(p.SocketEventType.Disconnected,function(){t.disconnected||(t.emitError(p.PeerErrorType.Network,"Lost connection to server."),t.disconnect())}),e.on(p.SocketEventType.Close,function(){t.disconnected||t._abort(p.PeerErrorType.SocketClosed,"Underlying socket is already closed.")}),e},a.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},a.prototype._handleMessage=function(e){var t,n,i=e.type,r=e.payload,o=e.src;switch(i){case p.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(p.PeerEventType.Open,this.id);break;case p.ServerMessageType.Error:this._abort(p.PeerErrorType.ServerError,r.msg);break;case p.ServerMessageType.IdTaken:this._abort(p.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case p.ServerMessageType.InvalidKey:this._abort(p.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case p.ServerMessageType.Leave:f.default.log("Received leave message from "+o),this._cleanupPeer(o),this._connections.delete(o);break;case p.ServerMessageType.Expire:this.emitError(p.PeerErrorType.PeerUnavailable,"Could not connect to peer "+o);break;case p.ServerMessageType.Offer:var s=r.connectionId;if((u=this.getConnection(o,s))&&(u.close(),f.default.warn("Offer received for existing Connection ID:"+s)),r.type===p.ConnectionType.Media)u=new v.MediaConnection(o,this,{connectionId:s,_payload:r,metadata:r.metadata}),this._addConnection(o,u),this.emit(p.PeerEventType.Call,u);else{if(r.type!==p.ConnectionType.Data)return void f.default.warn("Received malformed connection type:"+r.type);u=new m.DataConnection(o,this,{connectionId:s,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable}),this._addConnection(o,u),this.emit(p.PeerEventType.Connection,u)}var l=this._getMessages(s);try{for(var a=d(l),c=a.next();!c.done;c=a.next()){var h=c.value;u.handleMessage(h)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}break;default:if(!r)return void f.default.warn("You received a malformed message from "+o+" of type "+i);var u,s=r.connectionId;(u=this.getConnection(o,s))&&u.peerConnection?u.handleMessage(e):s?this._storeMessage(s,e):f.default.warn("You received an unrecognized message:",e)}},a.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},a.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},a.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return f.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(p.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");t=new m.DataConnection(e,this,t);return this._addConnection(e,t),t},a.prototype.call=function(e,t,n){return void 0===n&&(n={}),this.disconnected?(f.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(p.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.")):t?(n._stream=t,t=new v.MediaConnection(e,this,n),this._addConnection(e,t),t):void f.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},a.prototype._addConnection=function(e,t){f.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},a.prototype._removeConnection=function(e){var t,n=this._connections.get(e.peer);!n||-1!==(t=n.indexOf(e))&&n.splice(t,1),this._lostMessages.delete(e.connectionId)},a.prototype.getConnection=function(e,t){var n,i,e=this._connections.get(e);if(!e)return null;try{for(var r=d(e),o=r.next();!o.done;o=r.next()){var s=o.value;if(s.connectionId===t)return s}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return null},a.prototype._delayedAbort=function(e,t){var n=this;setTimeout(function(){n._abort(e,t)},0)},a.prototype._abort=function(e,t){f.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},a.prototype.emitError=function(e,t){f.default.error("Error:",t),(t="string"==typeof t?new Error(t):t).type=e,this.emit(p.PeerEventType.Error,t)},a.prototype.destroy=function(){this.destroyed||(f.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(p.PeerEventType.Close))},a.prototype._cleanup=function(){var t,e;try{for(var n=d(this._connections.keys()),i=n.next();!i.done;i=n.next()){var r=i.value;this._cleanupPeer(r),this._connections.delete(r)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.socket.removeAllListeners()},a.prototype._cleanupPeer=function(e){var t,n,e=this._connections.get(e);if(e)try{for(var i=d(e),r=i.next();!r.done;r=i.next())r.value.close()}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},a.prototype.disconnect=function(){var e;this.disconnected||(e=this.id,f.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(p.PeerEventType.Disconnected,e))},a.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)f.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");f.default.error("In a hurry? We're still trying to make the initial connection!")}},a.prototype.listAllPeers=function(t){var n=this;void 0===t&&(t=function(e){}),this._api.listAllPeers().then(function(e){return t(e)}).catch(function(e){return n._abort(p.PeerErrorType.ServerError,e)})},a.DEFAULT_KEY="peerjs",t.Peer=a},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.peerjs=void 0;var i=e("./util"),e=e("./peer");n.peerjs={Peer:e.Peer,util:i.util},n.default=e.Peer,window.peerjs=n.peerjs,window.Peer=e.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"]),document.addEventListener("DOMContentLoaded",function(e){window.metaMode=0,window.bgState=!1,window.fgState=!1,window.canvasState=!1,window.peer_reject={},window.peer_conns={},window.peer_streams={},window.all_peer_states=window.all_peer_states||{},window.canvas_elems={},window.view_cols={};var o,n,s,i,c="view-col center-block col-md-12 col-lg-12",r=(window.toggleMetaView=()=>{if(2==window.metaMode){1!=window.canvasState&&(window.frame_rate=3);var t,n=document.getElementsByClassName("view-col");let e=document.getElementById("meta-col");for(t of n)if(!(t.id in window.view_cols)){let e=t.className;window.view_cols[t.id]=e,e.includes("hidden")||(t.className+=" hidden")}window.view_cols.state||(window.view_cols.state={bgState:window.bgState,fgState:window.fgState,canvasState:window.bgState||window.fgState,frame_rate:window.frame_rate},window.frame_rate=3,window.canvasState=!0),e.className="col-md-12 col-lg-12"}else if(1==window.metaMode){var i,n=window.bgState||window.fgState||1==window.metaMode,n=(window.canvasState!=n&&(window.frame_rate=n?3:10),document.getElementsByClassName("view-col"));for(i of n){let e=i.className;i.id.startsWith("camera")?e.includes(" hidden")||(i.className=e+" hidden"):i.className=e.replace(" hidden","")}window.canvasState=!0}else{let e=document.getElementById("meta-col");var r,n=document.getElementsByClassName("view-col"),o=(window.view_cols.state&&(window.canvasState=window.bgState||window.fgState,window.canvasState?window.frame_rate=3:window.frame_rate=10),window.bgState||window.fgState||1==window.metaMode);for(r of n){var s=r.id.slice(11);r.className;let e=o,t="view-col col-md-6 col-lg-6 col-md-offset-3 col-lg-offset-3";s&&(e=window.peer_streams[s].canvas,t=c),r.id.startsWith("canvas")?(s=t+(e?"":" hidden"),r.className=s):(s=t+(e?" hidden":""),r.className=s)}e.className="col-md-12 col-lg-12 hidden",window.view_cols={}}},new Peer({host:"test-0pra.onrender.com",port:"",secure:true,path:"/peerjs",debug:0,config:{iceServers:[{url:"stun:stun1.l.google.com:19302"}]}}));function a(e,t){var a;"my-camera"==t?(document.getElementById(t).srcObject=e,window.peer_stream=e):e.id in window.peer_streams&&window.peer_streams[e.id].stream||(h(e.id,{stream:e}),a=document.getElementById("camera_streams"),t=Math.max(4,Math.floor(12/Object.keys(window.peer_streams).length)),c=`view-col center-block col-md-${t} col-lg-`+t,Object.entries(window.peer_streams).forEach(e=>{var t=e[0],n="peer-camera-"+t,i=document.getElementById("camera-col-"+t),r=document.getElementById("canvas-col-"+t),e=e[1],o=c+(e.canvas?" hidden":""),s=c+(e.canvas?"":" hidden");i?i.id in window.view_cols||(i.className=o,r.className=s):(i=e.username||"",a.innerHTML+=`
                    <div id="camera-col-${t}" class="${o}">
                        <div class="text-center">
                            <video id="${n}" width="320" height="180" autoplay="autoplay" class="center-block" style="-webkit-transform: scaleX(-1); transform: scaleX(-1);"></video>
                            <span class="label label-info" id="connected_peer1-${t}">${i}</span>
                        </div>
                    </div>
                    <div id="canvas-col-${t}" class="${s}">
                        <div class="text-center">
                            <canvas id="canvas-${t}" class="output_canvas center-block" width="320px" height="180px" style="-webkit-transform: scaleX(-1); transform: scaleX(-1);"></canvas>
                            <span class="label label-info" id="connected_peer2-${t}">${i}</span>
                        </div>
                    </div>
                    `)}),Object.entries(window.peer_streams).forEach(e=>{var t="peer-camera-"+e[0],t=(document.getElementById(t).srcObject=e[1].stream,"canvas-"+e[0]);window.canvas_elems[e[0]]=document.getElementById(t).getContext("2d")}),window.toggleMetaView())}r.on("open",function(){o=r.id,document.getElementById("peer-id-label").innerHTML=r.id}),r.on("connection",function(t){if(!window.peer_reject[t.metadata.id]){n=(i=t).peer;let e={type:"init",stream_id:window.my_stream_id,canvas:(2==window.metaMode?window.view_cols.state:window).canvasState,xpos:2==window.metaMode?window.getState(window.my_stream_id).xpos:void 0,vid:1==window.metaMode?window.getState(window.my_stream_id).vid:void 0,username:s};t.metadata.init&&(e.peer_ids=Object.keys(window.peer_conns),e.metaMode=window.metaMode),window.peer_conns[n]=i,window.updateState(t.metadata.stream_id,{xpos:t.metadata.xpos,vid:t.metadata.vid}),h(t.metadata.stream_id,{canvas:t.metadata.canvas,username:t.metadata.username}),i.on("open",()=>i.send(e)),i.on("data",u)}}),r.on("error",function(e){alert("An error ocurred with peer: "+e),console.error(e)}),r.on("call",function(e){var t=confirm(e.metadata.username+" wants to make a call with you, do you want to accept it ?");window.peer_reject[e.metadata.id]=!t,t?(s||(document.getElementById("connection-form").className+=" hidden",document.getElementById("join-chat-form").className="form-horizontal"),e.answer(window.localStream),e.on("stream",function(e){a(window.peer_stream=e,"peer-camera")}),e.on("close",function(){alert("The videocall has finished")})):(i.close(),delete window.peer_conns[e.metadata.id],delete window.peer_streams[e.metadata.stream_id])});performance.now();function u(t){if("message"==t.type){var e="text-left",e='<a href="javascript:void(0);" class="list-group-item'+(e=t.from==s?"text-right":e)+'">',e=(e+='<h4 class="list-group-item-heading">'+t.from+"</h4>")+('<p class="list-group-item-text">'+t.text+"</p>")+"</a>";document.getElementById("messages").innerHTML+=e,document.getElementById("messages-container").scrollTop=9999}else if("image"==t.type){var n,i=performance.now();2==window.metaMode?window.updateState(t.from,{image:t.data,xpos:t.xpos}):t.data?((n=new Image).onload=function(){let e=window.canvas_elems[t.from];e&&(e.clearRect(0,0,window.canvas_width,window.canvas_height),e.drawImage(n,0,0,window.canvas_width,window.canvas_height)),0},n.src=t.data):t.data_fg&&window.updateState(t.from,{image_fg:t.data_fg})}else if("init"==t.type){var r=Object.keys(window.peer_conns);if(window.updateState(t.stream_id,{xpos:t.xpos,vid:t.vid}),h(t.stream_id,{canvas:t.canvas,username:t.username}),t.peer_ids){t.peer_ids.forEach(e=>{e==o||e in r||l(e)}),window.metaMode=t.metaMode;let e=document.getElementById("room-id");0==window.metaMode?e.innerHTML=e.innerHTML.replaceAll("Metaverse","Room"):e.innerHTML=e.innerHTML.replaceAll("Room","Metaverse")}window.toggleMetaView()}else if("config"==t.type){window.metaMode=t.config.metaMode;let e=document.getElementById("room-id");0==window.metaMode?e.innerHTML=e.innerHTML.replaceAll("Metaverse","Room"):e.innerHTML=e.innerHTML.replaceAll("Room","Metaverse"),window.frame_rate=t.config.frame_rate,window.toggleMetaView()}else"state"==t.type&&(null!=t.canvas?h(t.stream_id,{canvas:t.canvas}):null!=t.username?h(t.stream_id,{username:t.username}):null!=t.xpos?window.updateState(t.stream_id,{xpos:t.xpos}):window.updateState(t.stream_id,{vid:t.vid}))}function l(e,t=!1){i=r.connect(e,{metadata:{id:o,username:s,init:t,stream_id:window.my_stream_id,canvas:(2==window.metaMode?window.view_cols.state:window).canvasState,xpos:2==window.metaMode?window.getState(window.my_stream_id).xpos:void 0,vid:1==window.metaMode?window.getState(window.my_stream_id).vid:void 0}}),(window.peer_conns[e]=i).on("data",u),i.on("close",()=>{delete window.peer_conns[e]}),r.call(e,window.localStream,{metadata:{id:o,username:s,stream_id:window.my_stream_id}}).on("stream",function(e){a(window.peer_stream=e,"peer-camera")})}function h(e,t){var n=window.peer_streams[e]||{};Object.assign(n,t),window.peer_streams[e]=n;let i=document.getElementById("camera-col-"+e),r=document.getElementById("canvas-col-"+e),o=document.getElementById("connected_peer1-"+e),s=document.getElementById("connected_peer2-"+e);i&&(i.id in window.view_cols||(t=Math.max(4,Math.floor(12/Object.keys(window.peer_streams).length)),c=`view-col center-block col-md-${t} col-lg-`+t,i.className=c+(n.canvas?" hidden":""),r.className=c+(n.canvas?"":" hidden")),n.username&&(o.innerHTML=n.username,s.innerHTML=n.username))}window.getState=function(e){return window.all_peer_states[e]||{}},window.updateState=function(e,t){var n=window.getState(e);return Object.assign(n,t),window.all_peer_states[e]=n},window.sendMessage=function(){var t,e=document.getElementById("message").value;e.trim()&&(t={type:"message",from:s,text:e},Object.entries(window.peer_conns).forEach(e=>e[1].send(t)),u(t),document.getElementById("message").value="")},document.getElementById("send-message").addEventListener("click",window.sendMessage,!1),document.getElementById("connection-form").onsubmit=function(e){return s=e.target.elements.name.value,n=e.target.elements.peer_id.value,s&&n&&(l(n,!0),document.getElementById("chat").className="",document.getElementById("connection-form").className+=" hidden"),!1},document.getElementById("join-chat-form").onsubmit=function(e){if(s=e.target.elements.name2.value){let t={type:"state",stream_id:window.my_stream_id,username:s};Object.entries(window.peer_conns).forEach(e=>e[1].send(t)),document.getElementById("chat").className="",document.getElementById("join-chat-form").className+=" hidden"}return!1}},!1);var paper=function(w,B){var p,o,s,f,g,v,n,O=(w=w||require("./node/self.js")).window,M=w.document,F=new function(){function r(e,t){for(var n in this)this.hasOwnProperty(n)&&e.call(t,this[n],n,this)}function n(e,t,n){var i;return e&&((i=d(e,"length"))&&"number"==typeof i.value?u:r).call(e,t,n=n||e),n}var o=/^(statics|enumerable|beans|preserve)$/,e=[],c=e.slice,s=Object.create,d=Object.getOwnPropertyDescriptor,f=Object.defineProperty,u=e.forEach||function(e,t){for(var n=0,i=this.length;n<i;n++)e.call(t,this[n],n,this)},i=Object.assign||function(e){for(var t=1,n=arguments.length;t<n;t++){var i,r=arguments[t];for(i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e};function a(s,a,c,u,l){var h={};function e(e,t){var n,i="function"==typeof(t="string"==typeof(t=t||(t=d(a,e))&&(t.get?t:t.value))&&"#"===t[0]?s[t.substring(1)]||t:t),r=t,o=l||i&&!t.base?t&&t.get?e in s:s[e]:null;l&&o||(i&&o&&(t.base=o),i&&!1!==u&&(n=e.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(h[n[3].toLowerCase()+n[4]]=n[2]),r&&!i&&r.get&&"function"==typeof r.get&&p.isPlainObject(r)||(r={value:r,writable:!0}),(d(s,e)||{configurable:!0}).configurable&&(r.configurable=!0,r.enumerable=null!=c?c:!n),f(s,e,r))}if(a){for(var t in a)a.hasOwnProperty(t)&&!o.test(t)&&e(t);for(var t in h){var n=h[t],i=s["set"+n],n=s["get"+n]||i&&s["is"+n];!n||!0!==u&&0!==n.length||e(t,{get:n,set:i})}}return s}function p(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e];n&&i(this,n)}return this}return a(p,{inject:function(e){var t,n,i;e&&(t=!0===e.statics?e:e.statics,n=e.beans,i=e.preserve,t!==e&&a(this.prototype,e,e.enumerable,n,i),a(this,t,null,n,i));for(var r=1,o=arguments.length;r<o;r++)this.inject(arguments[r]);return this},extend:function(){for(var e,t,n,i=this,r=0,o=arguments.length;r<o&&(!e||!t);r++)n=arguments[r],e=e||n.initialize,t=t||n.prototype;return t=(e=e||function(){i.apply(this,arguments)}).prototype=t||s(this.prototype),f(t,"constructor",{value:e,writable:!0,configurable:!0}),a(e,this),arguments.length&&this.inject.apply(e,arguments),e.base=i,e}}).inject({enumerable:!1,initialize:p,set:p,inject:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e];n&&a(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var e=s(this);return e.inject.apply(e,arguments)},each:function(e,t){return n(this,e,t)},clone:function(){return new this.constructor(this)},statics:{set:i,each:n,create:s,define:f,describe:d,clone:function(e){return i(new e.constructor,e)},isPlainObject:function(e){e=null!=e&&e.constructor;return e&&(e===Object||e===p||"Object"===e.name)},pick:function(e,t){return e!==B?e:t},slice:function(e,t,n){return c.call(e,t,n)}}})},e=("undefined"!=typeof module&&(module.exports=F),F.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+F.each(this,function(e,t){/^_/.test(t)||this.push(t+": "+("number"==(t=typeof e)?b.instance.number(e):"string"==t?"'"+e+"'":e))},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(e){return F.importJSON(e,this)},exportJSON:function(e){return F.exportJSON(this,e)},toJSON:function(){return F.serialize(this)},set:function(e,t){return e&&F.filter(this,e,t,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function e(){var t=e.base.apply(this,arguments),n=t.prototype._class;return n&&!F.exports[n]&&(F.exports[n]=t),t},equals:function(e,t){if(e===t)return!0;if(e&&e.equals)return e.equals(t);if(t&&t.equals)return t.equals(e);if(e&&t&&"object"==typeof e&&"object"==typeof t){if(Array.isArray(e)&&Array.isArray(t)){if((n=e.length)!==t.length)return!1;for(;n--;)if(!F.equals(e[n],t[n]))return!1}else{var n,i=Object.keys(e);if((n=i.length)!==Object.keys(t).length)return!1;for(;n--;){var r=i[n];if(!t.hasOwnProperty(r)||!F.equals(e[r],t[r]))return!1}}return!0}return!1},read:function(e,t,n,i){if(this===F)return r=this.peek(e,t),e.__index++,r;var r=this.prototype,o=r._readIndex,t=t||o&&e.__index||0,s=e.length,a=e[t];return i=i||s-t,a instanceof this||n&&n.readNull&&null==a&&i<=1?(o&&(e.__index=t+1),a&&n&&n.clone?a.clone():a):(a=F.create(r),o&&(a.__read=!0),a=a.initialize.apply(a,0<t||t+i<s?F.slice(e,t,t+i):e)||a,o&&(e.__index=t+a.__read,(n=a.__filtered)&&(e.__filtered=n,a.__filtered=B),a.__read=B),a)},peek:function(e,t){return e[e.__index=t||e.__index||0]},remain:function(e){return e.length-(e.__index||0)},readList:function(e,t,n,i){for(var r,o=[],t=t||0,s=i?t+i:e.length,a=t;a<s;a++)o.push(Array.isArray(r=e[a])?this.read(r,0,n):this.read(e,a,n,1));return o},readNamed:function(e,t,n,i,r){var o,s,a=this.getNamed(e,t),c=a!==B;return c&&((s=e.__filtered)||(o=this.getSource(e),(s=e.__filtered=F.create(o)).__unfiltered=o),s[t]=B),this.read(c?[a]:e,n,i,r)},readSupported:function(n,i){var e=this.getSource(n),r=this,o=!1;return e&&Object.keys(e).forEach(function(e){var t;e in i&&((t=r.readNamed(n,e))!==B&&(i[e]=t),o=!0)}),o},getSource:function(e){var t,n=e.__source;return n===B&&(t=1===e.length&&e[0],n=e.__source=t&&F.isPlainObject(t)?t:null),n},getNamed:function(e,t){var n=this.getSource(e);if(n)return t?n[t]:e.__filtered||n},hasNamed:function(e,t){return!!this.getNamed(e,t)},filter:function(n,i,r,e){var o;function t(e){var t;r&&e in r||o&&e in o||(t=i[e])!==B&&(n[e]=t)}if(e){for(var s,a={},c=0,u=e.length;c<u;c++)(s=e[c])in i&&(t(s),a[s]=!0);o=a}return Object.keys(i.__unfiltered||i).forEach(t),n},isPlainValue:function(e,t){return F.isPlainObject(e)||Array.isArray(e)||t&&"string"==typeof e},serialize:function(e,t,n,i){t=t||{};var r=!i;if(r&&(t.formatter=new b(t.precision),i={length:0,definitions:{},references:{},add:function(e,t){var n="#"+e._id,i=this.references[n];return i||(this.length++,t=t.call(e),(e=e._class)&&t[0]!==e&&t.unshift(e),this.definitions[n]=t,i=this.references[n]=[n]),i}}),e&&e._serialize){var o=e._serialize(t,i),s=e._class;!s||e._compactSerialize||!r&&n||o[0]===s||o.unshift(s)}else if(Array.isArray(e)){o=[];for(var a=0,c=e.length;a<c;a++)o[a]=F.serialize(e[a],t,n,i)}else if(F.isPlainObject(e)){o={};for(var u=Object.keys(e),a=0,c=u.length;a<c;a++){var l=u[a];o[l]=F.serialize(e[l],t,n,i)}}else o="number"==typeof e?t.formatter.number(e,t.precision):e;return r&&0<i.length?[["dictionary",i.definitions],o]:o},deserialize:function(e,t,n,l,h){var i=e,r=!n,o=r&&e&&e.length&&"dictionary"===e[0][0];if(n=n||{},Array.isArray(e)){var s=e[0],d="dictionary"===s;if(1==e.length&&/^#/.test(s))return n.dictionary[s];i=[];for(var a,c=(s=F.exports[s])?1:0,f=e.length;c<f;c++)i.push(F.deserialize(e[c],t,n,d,o));s&&(a=i,i=t?t(s,a,r||h):new s(a))}else if(F.isPlainObject(e))for(var u in i={},l&&(n.dictionary=i),e)i[u]=F.deserialize(e[u],t,n);return o?i[1]:i},exportJSON:function(e,t){e=F.serialize(e,t);return t&&0==t.asString?e:JSON.stringify(e)},importJSON:function(e,o){return F.deserialize("string"==typeof e?JSON.parse(e):e,function(e,t,n){var i,n=n&&o&&o.constructor===e,r=n?o:F.create(e.prototype);return!(1===t.length&&r instanceof U)||!n&&r instanceof h||(i=t[0],F.isPlainObject(i)&&(i.insert=!1,n&&(t=t.concat([{insert:!0}])))),(n?r.set:e).apply(r,t),n&&(o=null),r})},push:function(e,t){var n=t.length;if(n<4096)e.push.apply(e,t);else{var i=e.length;e.length+=n;for(var r=0;r<n;r++)e[i+r]=t[r]}return e},splice:function(e,t,n,i){var r=t&&t.length,o=n===B;(n=o?e.length:n)>e.length&&(n=e.length);for(var s=0;s<r;s++)t[s]._index=n+s;if(o)return F.push(e,t),[];for(var o=[n,i],a=(t&&F.push(o,t),e.splice.apply(e,o)),s=0,c=a.length;s<c;s++)a[s]._index=B;for(s=n+r,c=e.length;s<c;s++)e[s]._index=s;return a},capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}}),{on:function(e,t){var n,i;return"string"!=typeof e?F.each(e,function(e,t){this.on(t,e)},this):(n=(n=this._eventTypes)&&n[e],-1===(i=(i=this._callbacks=this._callbacks||{})[e]=i[e]||[]).indexOf(t)&&(i.push(t),n&&n.install&&1===i.length&&n.install.call(this,e))),this},off:function(e,t){var n,i,r;{if("string"==typeof e)return n=(n=this._eventTypes)&&n[e],(i=this._callbacks&&this._callbacks[e])&&(!t||-1!==(r=i.indexOf(t))&&1===i.length?(n&&n.uninstall&&n.uninstall.call(this,e),delete this._callbacks[e]):-1!==r&&i.splice(r,1)),this;F.each(e,function(e,t){this.off(t,e)},this)}},once:function(t,n){return this.on(t,function e(){n.apply(this,arguments),this.off(t,e)})},emit:function(e,t){if(!(r=this._callbacks&&this._callbacks[e]))return!1;var n=F.slice(arguments,1),i=t&&t.target&&!t.currentTarget,r=r.slice();i&&(t.currentTarget=this);for(var o=0,s=r.length;o<s;o++)if(0==r[o].apply(this,n)){t&&t.stop&&t.stop();break}return i&&delete t.currentTarget,!0},responds:function(e){return!(!this._callbacks||!this._callbacks[e])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(e){var t,n=this._eventTypes,i=this._callbacks,r=e?"install":"uninstall";if(n)for(var o in i)0<i[o].length&&((t=(t=n[o])&&t[r])&&t.call(this,o))},statics:{inject:function e(o){var s,t=o._events;return t&&(s={},F.each(t,function(e,t){var n="string"==typeof e,i=n?e:t,t=F.capitalize(i),r=i.substring(2).toLowerCase();s[r]=n?{}:e,i="_"+i,o["get"+t]=function(){return this[i]},o["set"+t]=function(e){var t=this[i];t&&this.off(r,t),e&&this.on(r,e),this[i]=e}}),o._eventTypes=s),e.base.apply(this,arguments)}}}),l=F.extend({_class:"PaperScope",initialize:function e(){(P=this).settings=new F({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=e._id++,e._scopes[this._id]=this;var t,n,o,i=e.prototype;this.support||(t=le.getContext(1,1)||{},i.support={nativeDash:"setLineDash"in t||"mozDash"in t,nativeBlendModes:he.nativeModes},le.release(t)),this.agent||(t=w.navigator.userAgent.toLowerCase(),n=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(t)||[])[0],o=i.agent=i.browser={platform:i="darwin"===n?"mac":n},i&&(o[i]=!0),t.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(e,t,n,i,r){o.chrome||(i="opera"===t?i:/^(node|trident)$/.test(t)?r:n,o.version=i,o.versionNumber=parseFloat(i),o.name=t={trident:"msie",jsdom:"node"}[t]||t,o[t]=!0)}),o.chrome&&delete o.webkit,o.atom&&delete o.chrome)},version:"0.12.15",getView:function(){var e=this.project;return e&&e._view},getPaper:function(){return this},execute:function(e,t){e=P.PaperScript.execute(e,this,t);return ee.updateFocus(),e},install:function(t){var e,n=this;for(e in F.each(["project","view","tool"],function(e){F.define(t,e,{configurable:!0,get:function(){return n[e]}})}),this)!/^_/.test(e)&&this[e]&&(t[e]=this[e])},setup:function(e){return(P=this).project=new c(e),this},createCanvas:function(e,t){return le.getCanvas(e,t)},activate:function(){P=this},clear:function(){for(var e=this.projects,t=this.tools,n=e.length-1;0<=n;n--)e[n].remove();for(n=t.length-1;0<=n;n--)t[n].remove()},remove:function(){this.clear(),delete l._scopes[this._id]},statics:new function(){function e(n){return n+="Attribute",function(e,t){return e[n](t)||e[n]("data-paper-"+t)}}return{_scopes:{},_id:0,get:function(e){return this._scopes[e]||null},getAttribute:e("get"),hasAttribute:e("has")}}}),t=F.extend(e,{initialize:function(e){this._scope=P,this._index=this._scope[this._list].push(this)-1,!e&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var e=this._scope[this._reference];return e&&e!==this&&e.emit("deactivate"),(this._scope[this._reference]=this).emit("activate",e),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(F.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),!(this._scope=null))},getView:function(){return this._scope.getView()}}),V={findItemBoundsCollisions:function(e,t,n){function i(e){for(var t=new Array(e.length),n=0;n<e.length;n++){var i=e[n].getBounds();t[n]=[i.left,i.top,i.right,i.bottom]}return t}var r=i(e),e=t&&t!==e?i(t):r;return this.findBoundsCollisions(r,e,n||0)},findCurveBoundsCollisions:function(e,t,n,i){function r(e){for(var t=Math.min,n=Math.max,i=new Array(e.length),r=0;r<e.length;r++){var o=e[r];i[r]=[t(o[0],o[2],o[4],o[6]),t(o[1],o[3],o[5],o[7]),n(o[0],o[2],o[4],o[6]),n(o[1],o[3],o[5],o[7])]}return i}var o=r(e),e=t&&t!==e?r(t):o;if(i){for(var s=this.findBoundsCollisions(o,e,n||0,!1,!0),a=this.findBoundsCollisions(o,e,n||0,!0,!0),c=[],u=0,l=s.length;u<l;u++)c[u]={hor:s[u],ver:a[u]};return c}return this.findBoundsCollisions(o,e,n||0)},findBoundsCollisions:function(e,l,h,d,f){var t=!l||e===l,s=t?e:e.concat(l),n=e.length,p=s.length;function g(e,t,n){for(var i=0,r=e.length;i<r;){var o=r+i>>>1;s[e[o]][t]<n?i=1+o:r=o}return i-1}for(var v=d?1:0,m=2+v,_=d?0:1,y=2+_,w=new Array(p),i=0;i<p;i++)w[i]=i;w.sort(function(e,t){return s[e][v]-s[t][v]});for(var r=[],o=new Array(n),i=0;i<p;i++){var a=w[i],b=s[a],C=t?a:a-n,S=a<n,x=t||!S,T=S?[]:null;if(r.length){var E=g(r,m,b[v]-h)+1;if(r.splice(0,E),t&&f)for(var T=T.concat(r),c=0;c<r.length;c++)o[u=r[c]].push(C);else for(var k=b[y],P=b[_],c=0;c<r.length;c++){var u=r[c],O=s[u],M=u<n,I=t||n<=u;(f||(S&&I||x&&M)&&k>=O[_]-h&&P<=O[y]+h)&&(S&&I&&T.push(t?u:u-n),x&&M&&o[u].push(C))}}S&&(e===l&&T.push(a),o[a]=T),r.length?(E=g(r,m,b[m]),r.splice(E+1,0,a)):r.push(a)}for(i=0;i<o.length;i++){var R=o[i];R&&R.sort(function(e,t){return e-t})}return o}},b=F.extend({initialize:function(e){this.precision=F.pick(e,5),this.multiplier=Math.pow(10,this.precision)},number:function(e){return this.precision<16?Math.round(e*this.multiplier)/this.multiplier:e},pair:function(e,t,n){return this.number(e)+(n||",")+this.number(t)},point:function(e,t){return this.number(e.x)+(t||",")+this.number(e.y)},size:function(e,t){return this.number(e.width)+(t||",")+this.number(e.height)},rectangle:function(e,t){return this.point(e,t)+(t||",")+this.size(e,t)}}),z=(b.instance=new b,new function(){var d=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],f=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],m=Math.abs,_=Math.sqrt,y=Math.pow,t=Math.log2||function(e){return Math.log(e)*Math.LOG2E},w=1e-12,b=112e-18;function C(e,t,n){return e<t?t:n<e?n:e}function l(e,t,n){function i(e){var t=134217729*e,t=e-t+t;return[t,e-t]}var r,o,s=t*t-e*n,a=t*t+e*n;return 3*m(s)<a&&(a=i(e),r=i(t),o=i(n),s=(t=t*t)-(e=e*n)+(r[0]*r[0]-t+2*r[0]*r[1]+r[1]*r[1]-(a[0]*o[0]-e+a[0]*o[1]+a[1]*o[0]+a[1]*o[1]))),s}function S(){var e=Math.max.apply(Math,arguments);return e&&(e<1e-8||1e8<e)?y(2,-Math.round(t(e))):0}return{EPSILON:w,MACHINE_EPSILON:b,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(_(2)-1)/3,isZero:function(e){return-w<=e&&e<=w},isMachineZero:function(e){return-b<=e&&e<=b},clamp:C,integrate:function(e,t,n,i){for(var l=d[i-2],r=f[i-2],o=.5*(n-t),s=o+t,a=0,h=i+1>>1,c=1&i?r[a++]*e(s):0;a<h;){var u=o*l[a];c+=r[a++]*(e(s+u)+e(s-u))}return o*c},findRoot:function(e,t,n,i,r,o,l){for(var s=0;s<o;s++){var a=e(n),c=a/t(n),u=n-c;if(m(c)<l){n=u;break}n=0<a?(r=n,u<=i?.5*(i+r):u):(i=n,r<=u?.5*(i+r):u)}return C(n,i,r)},solveQuadratic:function(e,t,n,i,r,o){var s,a=1/0;if(m(e)<w){if(m(t)<w)return m(n)<w?-1:0;s=-n/t}else{var c=l(e,t*=-.5,n);c&&m(c)<b&&((u=S(m(e),m(t),m(n)))&&(c=l(e*=u,t*=u,n*=u))),-b<=c&&(u=c<0?0:_(c),a=0===(c=t+(t<0?-u:u))?-(s=n/e):(s=c/e,n/c))}var t=0,u=null==r,e=r-w,n=o+w;return isFinite(s)&&(u||e<s&&s<n)&&(i[t++]=u?s:C(s,r,o)),a!==s&&isFinite(a)&&(u||e<a&&a<n)&&(i[t++]=u?a:C(a,r,o)),t},solveCubic:function(t,n,i,r,e,l,h){var o,s,a,d,f,c=S(m(t),m(n),m(i),m(r));function p(e){e=t*(o=e);d=(e+(s=e+n))*o+(a=s*o+i),f=a*o+r}if(c&&(t*=c,n*=c,i*=c,r*=c),m(t)<w)t=n,s=i,a=r,o=1/0;else if(m(r)<w)s=n,a=i,o=0;else{p(-n/t/3);var c=f/t,u=y(m(c),1/3),g=c<0?-1:1,c=-d/t,c=0<c?1.324717957244746*Math.max(u,_(c)):u,v=o-g*c;if(v!==o){for(;p(v),g*o<g*(v=0===d?o:o-f/d/(1+b)););m(t)*o*o>m(r/o)&&(s=((a=-r/o)-i)/o)}}u=z.solveQuadratic(t,s,a,e,l,h),c=null==l;return isFinite(o)&&(0===u||0<u&&o!==e[0]&&o!==e[1])&&(c||l-w<o&&o<h+w)&&(e[u++]=c?o:C(o,l,h)),u}}}),a={_id:1,_pools:{},get:function(e){return e?(this._pools[e]||(this._pools[e]={_id:1}))._id++:this._id++}},A=F.extend({_class:"Point",_readIndex:!0,initialize:function(e,t){var n,i=typeof e,r=this.__read,o=0;return"number"==i?(this._set(e,(n="number"==typeof t)?t:e),r&&(o=n?2:1)):"undefined"==i||null===e?(this._set(0,0),r&&(o=null===e?1:0)):(t="string"==i?e.split(/[\s,]+/)||[]:e,o=1,Array.isArray(t)?this._set(+t[0],+(1<t.length?t[1]:t[0])):"x"in t?this._set(t.x||0,t.y||0):"width"in t?this._set(t.width||0,t.height||0):"angle"in t?(this._set(t.length||0,0),this.setAngle(t.angle||0)):(this._set(0,0),o=0)),r&&(this.__read=o),this},set:"#initialize",_set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return this===e||e&&(this.x===e.x&&this.y===e.y||Array.isArray(e)&&this.x===e[0]&&this.y===e[1])||!1},clone:function(){return new A(this.x,this.y)},toString:function(){var e=b.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+" }"},_serialize:function(e){e=e.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(e){var t;this.isZero()?(t=this._angle||0,this._set(Math.cos(t)*e,Math.sin(t)*e)):(t=e/this.getLength(),z.isZero(t)&&this.getAngle(),this._set(this.x*t,this.y*t))},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(e){this.setAngleInRadians.call(this,e*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){var e,t;return arguments.length?(t=A.read(arguments),e=this.getLength()*t.getLength(),z.isZero(e)?NaN:(t=this.dot(t)/e,Math.acos(t<-1?-1:1<t?1:t))):this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(e){var t;this._angle=e,this.isZero()||(t=this.getLength(),this._set(Math.cos(e)*t,Math.sin(e)*t))},getQuadrant:function(){return 0<=this.x?0<=this.y?1:4:0<=this.y?2:3}},{beans:!1,getDirectedAngle:function(){var e=A.read(arguments);return 180*Math.atan2(this.cross(e),this.dot(e))/Math.PI},getDistance:function(){var e=arguments,t=A.read(e),n=t.x-this.x,t=t.y-this.y,n=n*n+t*t;return F.read(e)?n:Math.sqrt(n)},normalize:function(e){e===B&&(e=1);var t=this.getLength(),e=0!==t?e/t:0,t=new A(this.x*e,this.y*e);return 0<=e&&(t._angle=this._angle),t},rotate:function(e,t){if(0===e)return this.clone();e=e*Math.PI/180;var n=t?this.subtract(t):this,i=Math.sin(e),e=Math.cos(e),n=new A(n.x*e-n.y*i,n.x*i+n.y*e);return t?n.add(t):n},transform:function(e){return e?e._transformPoint(this):this},add:function(){var e=A.read(arguments);return new A(this.x+e.x,this.y+e.y)},subtract:function(){var e=A.read(arguments);return new A(this.x-e.x,this.y-e.y)},multiply:function(){var e=A.read(arguments);return new A(this.x*e.x,this.y*e.y)},divide:function(){var e=A.read(arguments);return new A(this.x/e.x,this.y/e.y)},modulo:function(){var e=A.read(arguments);return new A(this.x%e.x,this.y%e.y)},negate:function(){return new A(-this.x,-this.y)},isInside:function(){return C.read(arguments).contains(this)},isClose:function(){var e=arguments,t=A.read(e),e=F.read(e);return this.getDistance(t)<=e},isCollinear:function(){var e=A.read(arguments);return A.isCollinear(this.x,this.y,e.x,e.y)},isColinear:"#isCollinear",isOrthogonal:function(){var e=A.read(arguments);return A.isOrthogonal(this.x,this.y,e.x,e.y)},isZero:function(){var e=z.isZero;return e(this.x)&&e(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(e){return 0<=this.x*(1<e&&e<4?-1:1)&&0<=this.y*(2<e?-1:1)},dot:function(){var e=A.read(arguments);return this.x*e.x+this.y*e.y},cross:function(){var e=A.read(arguments);return this.x*e.y-this.y*e.x},project:function(){var e=A.read(arguments),t=e.isZero()?0:this.dot(e)/e.dot(e);return new A(e.x*t,e.y*t)},statics:{min:function(){var e=arguments,t=A.read(e),e=A.read(e);return new A(Math.min(t.x,e.x),Math.min(t.y,e.y))},max:function(){var e=arguments,t=A.read(e),e=A.read(e);return new A(Math.max(t.x,e.x),Math.max(t.y,e.y))},random:function(){return new A(Math.random(),Math.random())},isCollinear:function(e,t,n,i){return Math.abs(e*i-t*n)<=1e-8*Math.sqrt((e*e+t*t)*(n*n+i*i))},isOrthogonal:function(e,t,n,i){return Math.abs(e*n+t*i)<=1e-8*Math.sqrt((e*e+t*t)*(n*n+i*i))}}},F.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new A(t(this.x),t(this.y))}},{})),u=A.extend({initialize:function(e,t,n,i){this._x=e,this._y=t,this._owner=n,this._setter=i},_set:function(e,t,n){return this._x=e,this._y=t,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),I=F.extend({_class:"Size",_readIndex:!0,initialize:function(e,t){var n,i=typeof e,r=this.__read,o=0;return"number"==i?(this._set(e,(n="number"==typeof t)?t:e),r&&(o=n?2:1)):"undefined"==i||null===e?(this._set(0,0),r&&(o=null===e?1:0)):(t="string"==i?e.split(/[\s,]+/)||[]:e,o=1,Array.isArray(t)?this._set(+t[0],+(1<t.length?t[1]:t[0])):"width"in t?this._set(t.width||0,t.height||0):"x"in t?this._set(t.x||0,t.y||0):(this._set(0,0),o=0)),r&&(this.__read=o),this},set:"#initialize",_set:function(e,t){return this.width=e,this.height=t,this},equals:function(e){return e===this||e&&(this.width===e.width&&this.height===e.height||Array.isArray(e)&&this.width===e[0]&&this.height===e[1])||!1},clone:function(){return new I(this.width,this.height)},toString:function(){var e=b.instance;return"{ width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){e=e.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var e=I.read(arguments);return new I(this.width+e.width,this.height+e.height)},subtract:function(){var e=I.read(arguments);return new I(this.width-e.width,this.height-e.height)},multiply:function(){var e=I.read(arguments);return new I(this.width*e.width,this.height*e.height)},divide:function(){var e=I.read(arguments);return new I(this.width/e.width,this.height/e.height)},modulo:function(){var e=I.read(arguments);return new I(this.width%e.width,this.height%e.height)},negate:function(){return new I(-this.width,-this.height)},isZero:function(){var e=z.isZero;return e(this.width)&&e(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(e,t){return new I(Math.min(e.width,t.width),Math.min(e.height,t.height))},max:function(e,t){return new I(Math.max(e.width,t.width),Math.max(e.height,t.height))},random:function(){return new I(Math.random(),Math.random())}}},F.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new I(t(this.width),t(this.height))}},{})),i=I.extend({initialize:function(e,t,n,i){this._width=e,this._height=t,this._owner=n,this._setter=i},_set:function(e,t,n){return this._width=e,this._height=t,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(e){this._width=e,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e,this._owner[this._setter](this)}}),C=F.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(e,t,u,l){var n,i,r,o,s=arguments,a=typeof e,c=("number"==a?(this._set(e,t,u,l),n=4):"undefined"==a||null===e?(this._set(0,0,0,0),n=null===e?1:0):1===s.length&&(Array.isArray(e)?(this._set.apply(this,e),n=1):e.x!==B||e.width!==B?(this._set(e.x||0,e.y||0,e.width||0,e.height||0),n=1):e.from===B&&e.to===B&&(this._set(0,0,0,0),F.readSupported(s,this)&&(n=1))),n===B&&(a=A.readNamed(s,"from"),c=F.peek(s),i=a.x,a=a.y,c&&c.x!==B||F.hasNamed(s,"to")?(r=(c=A.readNamed(s,"to")).x-i,o=c.y-a,r<0&&(i=c.x,r=-r),o<0&&(a=c.y,o=-o)):(r=(c=I.read(s)).width,o=c.height),this._set(i,a,r,o),n=s.__index),s.__filtered);return c&&(this.__filtered=c),this.__read&&(this.__read=n),this},set:"#initialize",_set:function(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this},clone:function(){return new C(this.x,this.y,this.width,this.height)},equals:function(e){var t=F.isPlainValue(e)?C.read(arguments):e;return t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height||!1},toString:function(){var e=b.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+", width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){e=e.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(e){return new(e?A:u)(this.x,this.y,this,"setPoint")},setPoint:function(){var e=A.read(arguments);this.x=e.x,this.y=e.y},getSize:function(e){return new(e?I:i)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var e=I.read(arguments),t=this._sx,n=this._sy,i=e.width,e=e.height;t&&(this.x+=(this.width-i)*t),n&&(this.y+=(this.height-e)*n),this.width=i,this.height=e,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(e){var t;this._fw||(t=e-this.x,this.width-=.5===this._sx?2*t:t),this.x=e,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(e){var t;this._fh||(t=e-this.y,this.height-=.5===this._sy?2*t:t),this.y=e,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(e){var t;this._fw||(t=e-this.x,this.width=.5===this._sx?2*t:t),this.x=e-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(e){var t;this._fh||(t=e-this.y,this.height=.5===this._sy?2*t:t),this.y=e-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(e){this._fw||.5===this._sx?this.x=e-this.width/2:(this._sx&&(this.x+=2*(e-this.x)*this._sx),this.width=2*(e-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(e){this._fh||.5===this._sy?this.y=e-this.height/2:(this._sy&&(this.y+=2*(e-this.y)*this._sy),this.height=2*(e-this.y)),this._sy=.5,this._fh=0},getCenter:function(e){return new(e?A:u)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var e=A.read(arguments);return this.setCenterX(e.x),this.setCenterY(e.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(e){return e&&e.width!==B||4===(Array.isArray(e)?e:arguments).length?this._containsRectangle(C.read(arguments)):this._containsPoint(A.read(arguments))},_containsPoint:function(e){var t=e.x,e=e.y;return t>=this.x&&e>=this.y&&t<=this.x+this.width&&e<=this.y+this.height},_containsRectangle:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t+e.width<=this.x+this.width&&n+e.height<=this.y+this.height},intersects:function(){var e=C.read(arguments),t=F.read(arguments)||0;return e.x+e.width>this.x-t&&e.y+e.height>this.y-t&&e.x<this.x+this.width+t&&e.y<this.y+this.height+t},intersect:function(){var e=C.read(arguments),t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),i=Math.min(this.x+this.width,e.x+e.width),e=Math.min(this.y+this.height,e.y+e.height);return new C(t,n,i-t,e-n)},unite:function(){var e=C.read(arguments),t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x+this.width,e.x+e.width),e=Math.max(this.y+this.height,e.y+e.height);return new C(t,n,i-t,e-n)},include:function(){var e=A.read(arguments),t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x+this.width,e.x),e=Math.max(this.y+this.height,e.y);return new C(t,n,i-t,e-n)},expand:function(){var e=I.read(arguments),t=e.width,e=e.height;return new C(this.x-t/2,this.y-e/2,this.width+t,this.height+e)},scale:function(e,t){return this.expand(this.width*e-this.width,this.height*(t===B?e:t)-this.height)}},F.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,t){var n=e.join(""),i=/^[RL]/.test(n),t=(4<=t&&(e[1]+=i?"Y":"X"),e[i?0:1]),e=e[i?1:0],r="get"+t,o="get"+e,s="set"+t,a="set"+e,c="set"+n;this["get"+n]=function(e){return new(e?A:u)(this[r](),this[o](),this,c)},this[c]=function(){var e=A.read(arguments);this[s](e.x),this[a](e.y)}},{beans:!0})),r=C.extend({initialize:function(e,t,n,i,r,o){this._set(e,t,n,i,!0),this._owner=r,this._setter=o},_set:function(e,t,n,i,r){return this._x=e,this._y=t,this._width=n,this._height=i,r||this._owner[this._setter](this),this}},new function(){var n=C.prototype;return F.each(["x","y","width","height"],function(e){var t=F.capitalize(e),n="_"+e;this["get"+t]=function(){return this[n]},this["set"+t]=function(e){this[n]=e,this._dontNotify||this._owner[this._setter](this)}},F.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var t="set"+e;this[t]=function(){this._dontNotify=!0,n[t].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(e){var t=this._owner;t._changeSelection&&t._changeSelection(2,e)}}))}),R=F.extend({_class:"Matrix",initialize:function e(t,n){var i=arguments,r=i.length,o=!0;if(6<=r?this._set.apply(this,i):1===r||2===r?t instanceof e?this._set(t._a,t._b,t._c,t._d,t._tx,t._ty,n):Array.isArray(t)?this._set.apply(this,n?t.concat([n]):t):o=!1:r?o=!1:this.reset(),!o)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(e,t,n,i,r,o,s){return this._a=e,this._b=t,this._c=n,this._d=i,this._tx=r,this._ty=o,s||this._changed(),this},_serialize:function(e,t){return F.serialize(this.getValues(),e,!0,t)},_changed:function(){var e=this._owner;e&&(e._applyMatrix?e.transform(null,!0):e._changed(25))},clone:function(){return new R(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(e){return e===this||e&&this._a===e._a&&this._b===e._b&&this._c===e._c&&this._d===e._d&&this._tx===e._tx&&this._ty===e._ty},toString:function(){var e=b.instance;return"[["+[e.number(this._a),e.number(this._c),e.number(this._tx)].join(", ")+"], ["+[e.number(this._b),e.number(this._d),e.number(this._ty)].join(", ")+"]]"},reset:function(e){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,e||this._changed(),this},apply:function(e,t){var n=this._owner;return!!n&&(n.transform(null,F.pick(e,!0),t),this.isIdentity())},translate:function(){var e=A.read(arguments),t=e.x,e=e.y;return this._tx+=t*this._a+e*this._c,this._ty+=t*this._b+e*this._d,this._changed(),this},scale:function(){var e=arguments,t=A.read(e),e=A.read(e,0,{readNull:!0});return e&&this.translate(e),this._a*=t.x,this._b*=t.x,this._c*=t.y,this._d*=t.y,e&&this.translate(e.negate()),this._changed(),this},rotate:function(e){e*=Math.PI/180;var t=A.read(arguments,1),n=t.x,t=t.y,i=Math.cos(e),r=Math.sin(e),o=n-n*i+t*r,n=t-n*r-t*i,t=this._a,s=this._b,a=this._c,c=this._d;return this._a=i*t+r*a,this._b=i*s+r*c,this._c=-r*t+i*a,this._d=-r*s+i*c,this._tx+=o*t+n*a,this._ty+=o*s+n*c,this._changed(),this},shear:function(){var e=arguments,t=A.read(e),e=A.read(e,0,{readNull:!0}),n=(e&&this.translate(e),this._a),i=this._b;return this._a+=t.y*this._c,this._b+=t.y*this._d,this._c+=t.x*n,this._d+=t.x*i,e&&this.translate(e.negate()),this._changed(),this},skew:function(){var e=arguments,t=A.read(e),e=A.read(e,0,{readNull:!0}),n=Math.PI/180,t=new A(Math.tan(t.x*n),Math.tan(t.y*n));return this.shear(t,e)},append:function(e,l){var t,n,i,r,o,s,a,c,u;return e&&(t=this._a,n=this._b,i=this._c,r=this._d,o=e._a,s=e._c,a=e._b,c=e._d,u=e._tx,e=e._ty,this._a=o*t+a*i,this._c=s*t+c*i,this._b=o*n+a*r,this._d=s*n+c*r,this._tx+=u*t+e*i,this._ty+=u*n+e*r,l||this._changed()),this},prepend:function(e,l){var t,n,i,r,o,h,s,a,c,u,d;return e&&(t=this._a,n=this._b,i=this._c,r=this._d,o=this._tx,h=this._ty,s=e._a,a=e._c,c=e._b,u=e._d,d=e._tx,e=e._ty,this._a=s*t+a*n,this._c=s*i+a*r,this._b=c*t+u*n,this._d=c*i+u*r,this._tx=s*o+a*h+d,this._ty=c*o+u*h+e,l||this._changed()),this},appended:function(e){return this.clone().append(e)},prepended:function(e){return this.clone().prepend(e)},invert:function(){var e=this._a,t=this._b,n=this._c,i=this._d,r=this._tx,o=this._ty,s=e*i-t*n,a=null;return s&&!isNaN(s)&&isFinite(r)&&isFinite(o)&&(this._a=i/s,this._b=-t/s,this._c=-n/s,this._d=e/s,this._tx=(n*o-i*r)/s,this._ty=(t*r-e*o)/s,a=this),a},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new R(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var e=this._a*this._d-this._c*this._b;return e&&!isNaN(e)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(e,t,n){return arguments.length<3?this._transformPoint(A.read(arguments)):this._transformCoordinates(e,t,n)},_transformPoint:function(e,t,n){var i=e.x,e=e.y;return(t=t||new A)._set(i*this._a+e*this._c+this._tx,i*this._b+e*this._d+this._ty,n)},_transformCoordinates:function(e,t,n){for(var i=0,r=2*n;i<r;i+=2){var o=e[i],s=e[i+1];t[i]=o*this._a+s*this._c+this._tx,t[i+1]=o*this._b+s*this._d+this._ty}return t},_transformCorners:function(e){var t=e.x,n=e.y,i=t+e.width,e=n+e.height,n=[t,n,i,n,i,e,t,e];return this._transformCoordinates(n,n,4)},_transformBounds:function(e,t,n){for(var i=this._transformCorners(e),r=i.slice(0,2),o=r.slice(),s=2;s<8;s++){var a=i[s],c=1&s;a<r[c]?r[c]=a:a>o[c]&&(o[c]=a)}return(t=t||new C)._set(r[0],r[1],o[0]-r[0],o[1]-r[1],n)},inverseTransform:function(){return this._inverseTransform(A.read(arguments))},_inverseTransform:function(e,t,l){var n=this._a,i=this._b,r=this._c,o=this._d,s=this._tx,a=this._ty,c=n*o-i*r,u=null;return c&&!isNaN(c)&&isFinite(s)&&isFinite(a)&&(s=e.x-this._tx,a=e.y-this._ty,u=(t=t||new A)._set((s*o-a*r)/c,(a*n-s*i)/c,l)),u},decompose:function(){var e,t,n,i=this._a,r=this._b,o=this._c,s=this._d,a=i*s-r*o,c=Math.sqrt,l=Math.atan2,u=180/Math.PI;return c=0!==i||0!==r?(n=c(i*i+r*r),e=Math.acos(i/n)*(0<r?1:-1),t=[n,a/n],[l(i*o+r*s,n*n),0]):0!==o||0!==s?(n=c(o*o+s*s),e=Math.asin(o/n)*(0<s?1:-1),t=[a/n,n],[0,l(i*o+r*s,n*n)]):t=[e=0,0],{translation:this.getTranslation(),rotation:e*u,scaling:new A(t),skewing:new A(c[0]*u,c[1]*u)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new A(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(e){this.isIdentity()||e.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},F.each(["a","b","c","d","tx","ty"],function(e){var t=F.capitalize(e),n="_"+e;this["get"+t]=function(){return this[n]},this["set"+t]=function(e){this[n]=e,this._changed()}},{})),j=F.extend({_class:"Line",initialize:function(e,t,n,i,r){(4<=arguments.length?(this._px=e,this._py=t,this._vx=n,this._vy=i,r):(this._px=e.x,this._py=e.y,this._vx=t.x,this._vy=t.y,n))||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new A(this._px,this._py)},getVector:function(){return new A(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(e,t){return j.intersect(this._px,this._py,this._vx,this._vy,e._px,e._py,e._vx,e._vy,!0,t)},getSide:function(e,t){return j.getSide(this._px,this._py,this._vx,this._vy,e.x,e.y,!0,t)},getDistance:function(e){return Math.abs(this.getSignedDistance(e))},getSignedDistance:function(e){return j.getSignedDistance(this._px,this._py,this._vx,this._vy,e.x,e.y,!0)},isCollinear:function(e){return A.isCollinear(this._vx,this._vy,e._vx,e._vy)},isOrthogonal:function(e){return A.isOrthogonal(this._vx,this._vy,e._vx,e._vy)},statics:{intersect:function(e,t,n,i,r,o,s,a,c,u){c||(n-=e,i-=t,s-=r,a-=o);c=n*a-i*s;if(!z.isMachineZero(c)){r=e-r,o=t-o,s=(s*o-a*r)/c,a=(n*o-i*r)/c;if(u||-1e-12<s&&s<1+1e-12&&-1e-12<a&&a<1+1e-12)return new A(e+(s=!u?s<=0?0:1<=s?1:s:s)*n,t+s*i)}},getSide:function(e,t,n,i,r,o,s,a){s||(n-=e,i-=t);s=r-e,r=s*i-(o-t)*n;return(r=!a&&z.isMachineZero(r)&&0<=(r=(s*n+s*n)/(n*n+i*i))&&r<=1?0:r)<0?-1:0<r?1:0},getSignedDistance:function(e,t,n,i,r,o,s){return s||(n-=e,i-=t),0===n?0<i?r-e:e-r:0===i?n<0?o-t:t-o:((r-e)*i-(o-t)*n)/(n<i?i*Math.sqrt(1+n*n/(i*i)):n*Math.sqrt(1+i*i/(n*n)))},getDistance:function(e,t,n,i,r,o,s){return Math.abs(j.getSignedDistance(e,t,n,i,r,o,s))}}}),c=t.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(e){t.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new K(null,null,this),this._view=ee.create(this,e||le.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(e,t){return F.serialize(this._children,e,!0,t)},_changed:function(e,t){1&e&&((o=this._view)&&(o._needsUpdate=!0,!o._requested&&o._autoUpdate&&o.requestUpdate()));var n,i,r,o=this._changes;o&&t&&((r=(n=this._changesById)[i=t._id])?r.flags|=e:o.push(n[i]={item:t,flags:e}))},clear:function(){for(var e=this._children,t=e.length-1;0<=t;t--)e[t].remove()},isEmpty:function(){return!this._children.length},remove:function e(){return!!e.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.set(e)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new h({project:this,insert:!0})},getSymbolDefinitions:function(){var n=[],i={};return this.getItems({class:y,match:function(e){var e=e._definition,t=e._id;return i[t]||(i[t]=!0,n.push(e)),!1}}),n},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var e,t=this._selectionItems,n=[];for(e in t){var i=t[e],r=i._selection;1&r&&i.isInserted()?n.push(i):r||this._updateSelection(i)}return n},_updateSelection:function(e){var t=e._id,n=this._selectionItems;e._selection?n[t]!==e&&(this._selectionCount++,n[t]=e):n[t]===e&&(this._selectionCount--,delete n[t])},selectAll:function(){for(var e=this._children,t=0,n=e.length;t<n;t++)e[t].setFullySelected(!0)},deselectAll:function(){var e,t=this._selectionItems;for(e in t)t[e].setFullySelected(!1)},addLayer:function(e){return this.insertLayer(B,e)},insertLayer:function(e,t){return t instanceof h?(t._remove(!1,!0),F.splice(this._children,[t],e,0),t._setProject(this,!0),(e=t._name)&&t.setName(e),this._changes&&t._changed(5),this._activeLayer||(this._activeLayer=t)):t=null,t},_insertItem:function(e,t,n){return t=this.insertLayer(e,t)||(this._activeLayer||this._insertItem(B,new h(U.NO_INSERT),!0)).insertChild(e,t),n&&t.activate&&t.activate(),t},getItems:function(e){return U._getItems(this,e)},getItem:function(e){return U._getItems(this,e,null,null,!0)[0]||null},importJSON:function(e){this.activate();var t=this._activeLayer;return F.importJSON(e,t&&t.isEmpty()&&t)},removeOn:function(e){var t=this._removeSets;if(t){"mouseup"===e&&(t.mousedrag=null);var n=t[e];if(n){for(var i in n){var r,o=n[i];for(r in t){var s=t[r];s&&s!=n&&delete s[o._id]}o.remove()}t[e]=null}}},draw:function(e,t,n){this._updateVersion++,e.save(),t.applyToContext(e);for(var i=this._children,r=new F({offset:new A(0,0),pixelRatio:n,viewMatrix:t.isIdentity()?null:t,matrices:[new R],updateMatrix:!0}),o=0,s=i.length;o<s;o++)i[o].draw(e,r);if(e.restore(),0<this._selectionCount){e.save(),e.strokeWidth=1;var a,c=this._selectionItems,u=this._scope.settings.handleSize,l=this._updateVersion;for(a in c)c[a]._drawSelection(e,t,u,c,l);e.restore()}}}),U=F.extend(e,{statics:{extend:function e(t){return t._serializeFields&&(t._serializeFields=F.set({},this.prototype._serializeFields,t._serializeFields)),e.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new R,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var e=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return F.each(e,function(e){this._events[e]={install:function(e){this.getView()._countItemEvent(e,1)},uninstall:function(e){this.getView()._countItemEvent(e,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:e}})},{initialize:function(){},_initialize:function(e,t){var n=e&&F.isPlainObject(e),i=n&&!0===e.internal,r=this._matrix=new R,o=n&&e.project||P.project,s=P.settings;return this._id=i?null:a.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&s.applyMatrix,t&&r.translate(t),(r._owner=this)._style=new K(o._currentStyle,this,o),i||n&&0==e.insert||!s.insertItems&&(!n||!0!==e.insert)?this._setProject(o):(n&&e.parent||o)._insertItem(B,this,!0),n&&e!==U.NO_INSERT&&this.set(e,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(i,r){var o={},s=this;function e(e){for(var t in e){var n=s[t];F.equals(n,"leading"===t?1.2*e.fontSize:e[t])||(o[t]=F.serialize(n,i,"data"!==t,r))}}return e(this._serializeFields),this instanceof m||e(this._style._defaults),[this._class,o]},_changed:function(e){var t=this._symbol,n=this._parent||t,i=this._project;8&e&&(this._bounds=this._position=this._decomposed=B),16&e&&(this._globalMatrix=B),n&&72&e&&U._clearBoundsCache(n),2&e&&U._clearBoundsCache(this),i&&i._changed(e,this),t&&t._changed(e)},getId:function(){return this._id},getName:function(){return this._name},setName:function(e){if(this._name&&this._removeNamed(),e===+e+"")throw new Error("Names consisting only of numbers are not supported.");var t,n=this._getOwner();e&&n&&(t=n._children,((n=n._namedChildren)[e]=n[e]||[]).push(this),e in t||(t[e]=this)),this._name=e||B,this._changed(256)},getStyle:function(){return this._style},setStyle:function(e){this.getStyle().set(e)}},F.each(["locked","visible","blendMode","opacity","guide"],function(t){var e=F.capitalize(t),n="_"+t,i={locked:256,visible:265};this["get"+e]=function(){return this[n]},this["set"+e]=function(e){e!=this[n]&&(this[n]=e,this._changed(i[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(e){e!==this._selection&&(this._selection=e,(e=this._project)&&(e._updateSelection(this),this._changed(257)))},_changeSelection:function(e,t){var n=this._selection;this.setSelection(t?n|e:n&~e)},isSelected:function(){if(this._selectChildren)for(var e=this._children,t=0,n=e.length;t<n;t++)if(e[t].isSelected())return!0;return!!(1&this._selection)},setSelected:function(e){if(this._selectChildren)for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].setSelected(e);this._changeSelection(1,e)},isFullySelected:function(){var e=this._children,t=!!(1&this._selection);if(e&&t){for(var n=0,i=e.length;n<i;n++)if(!e[n].isFullySelected())return!1;return!0}return t},setFullySelected:function(e){var t=this._children;if(t)for(var n=0,i=t.length;n<i;n++)t[n].setFullySelected(e);this._changeSelection(1,e)},isClipMask:function(){return this._clipMask},setClipMask:function(e){this._clipMask!=(e=!!e)&&((this._clipMask=e)&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(e){this._data=e},getPosition:function(e){var e=e?A:u,t=this._position||(this._position=this._getPositionFromBounds());return new e(t.x,t.y,this,"setPosition")},setPosition:function(){this.translate(A.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(e){return this._pivot?this._matrix._transformPoint(this._pivot):(e||this.getBounds()).getCenter(!0)},getPivot:function(){var e=this._pivot;return e?new u(e.x,e.y,this,"setPivot"):null},setPivot:function(){this._pivot=A.read(arguments,0,{clone:!0,readNull:!0}),this._position=B}},F.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,e){this[e]=function(e){return this.getBounds(e,t)}},{beans:!0,getBounds:function(e,t){var n=t||e instanceof R,i=F.set({},n?t:e,this._boundsOptions),n=(i.stroke&&!this.getStrokeScaling()||(i.cacheItem=this),this._getCachedBounds(n&&e,i).rect);return arguments.length?n:new r(n.x,n.y,n.width,n.height,this,"setBounds")},setBounds:function(){var e=C.read(arguments),t=this.getBounds(),n=this._matrix,i=new R,r=e.getCenter();i.translate(r),e.width==t.width&&e.height==t.height||(n.isInvertible()||(n.set(n._backup||(new R).translate(n.getTranslation())),t=this.getBounds()),i.scale(0!==t.width?e.width/t.width:0,0!==t.height?e.height/t.height:0)),r=t.getCenter(),i.translate(-r.x,-r.y),this.transform(i)},_getBounds:function(e,t){var n=this._children;return n&&n.length?(U._updateBoundsCache(this,t.cacheItem),U._getBounds(n,e,t)):new C},_getBoundsCacheKey:function(e,t){return[e.stroke?1:0,e.handle?1:0,t?1:0].join("")},_getCachedBounds:function(e,t,n){e=e&&e._orNullIfIdentity();var n=t.internal&&!n,i=t.cacheItem,r=n?null:this._matrix._orNullIfIdentity(),o=i&&(!e||e.equals(r))&&this._getBoundsCacheKey(t,n),s=this._bounds;if(U._updateBoundsCache(this._parent||this._symbol,i),o&&s&&o in s)return{rect:(a=s[o]).rect.clone(),nonscaling:a.nonscaling};var a,i=this._getBounds(e||r,t),e=i.rect||i,r=this._style,t=i.nonscaling||r.hasStroke()&&!r.getStrokeScaling();return o&&(s||(this._bounds=s={}),a=s[o]={rect:e.clone(),nonscaling:t,internal:n}),{rect:e,nonscaling:t}},_getStrokeMatrix:function(e,t){t=this.getStrokeScaling()?null:t&&t.internal?this:this._parent||this._symbol&&this._symbol._item,t=t?t.getViewMatrix().invert():e;return t&&t._shiftless()},statics:{_updateBoundsCache:function(e,t){var n;e&&t&&(n=t._id,(e=e._boundsCache=e._boundsCache||{ids:{},list:[]}).ids[n]||(e.list.push(t),e.ids[n]=t))},_clearBoundsCache:function(e){var t=e._boundsCache;if(t){e._bounds=e._position=e._boundsCache=B;for(var n=0,i=t.list,r=i.length;n<r;n++){var o=i[n];o!==e&&(o._bounds=o._position=B,o._boundsCache&&U._clearBoundsCache(o))}}},_getBounds:function(e,t,n){var i=a=1/0,r=c=-a,l=!1;n=n||{};for(var o=0,h=e.length;o<h;o++){var s,a,c,u=e[o];u._visible&&!u.isEmpty(!0)&&(s=(u=u._getCachedBounds(t&&t.appended(u._matrix),n,!0)).rect,a=Math.min(s.x,a),i=Math.min(s.y,i),c=Math.max(s.x+s.width,c),r=Math.max(s.y+s.height,r),u.nonscaling&&(l=!0))}return{rect:isFinite(a)?new C(a,i,c-a,r-i):new C,nonscaling:l}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var e=this._decompose();return e?e.rotation:0},setRotation:function(e){var t,n=this.getRotation();null!=n&&null!=e&&(t=this._decomposed,this.rotate(e-n),t&&(t.rotation=e,this._decomposed=t))},getScaling:function(){var e=this._decompose(),e=e&&e.scaling;return new u(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var e,t,n,i,r=this.getScaling(),o=A.read(arguments,0,{clone:!0,readNull:!0});r&&o&&!r.equals(o)&&(e=this.getRotation(),t=this._decomposed,n=new R,(i=z.isZero)(r.x)||i(r.y)?(n.translate(t.translation),e&&n.rotate(e),n.scale(o.x,o.y),this._matrix.set(n)):(i=this.getPosition(!0),n.translate(i),e&&n.rotate(e),n.scale(o.x/r.x,o.y/r.y),e&&n.rotate(-e),n.translate(i.negate()),this.transform(n)),t&&(t.scaling=o,this._decomposed=t))},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},getGlobalMatrix:function(e){if(i=this._globalMatrix)for(var t=this._parent,n=[];t;){if(!t._globalMatrix){for(var i=null,r=0,o=n.length;r<o;r++)n[r]._globalMatrix=null;break}n.push(t),t=t._parent}return i||(i=this._globalMatrix=this._matrix.clone(),(t=this._parent)&&i.prepend(t.getGlobalMatrix(!0))),e?i:i.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(e){(this._applyMatrix=this._canApplyMatrix&&!!e)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(e,t){if(this._project!==e){this._project&&this._installEvents(!1),this._project=e;for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._setProject(e);t=!0}t&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function e(t){e.base.call(this,t);for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._installEvents(t)},getLayer:function(){for(var e=this;e=e._parent;)if(e instanceof h)return e;return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(e){this.removeChildren(),this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var e=this._getOwner();return e&&e._children[this._index+1]||null},getPreviousSibling:function(){var e=this._getOwner();return e&&e._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(e){return e===this||e&&this._class===e._class&&this._style.equals(e._style)&&this._matrix.equals(e._matrix)&&this._locked===e._locked&&this._visible===e._visible&&this._blendMode===e._blendMode&&this._opacity===e._opacity&&this._clipMask===e._clipMask&&this._guide===e._guide&&this._equals(e)||!1},_equals:function(e){return F.equals(this._children,e._children)},clone:function(e){var t=new this.constructor(U.NO_INSERT),n=this._children,i=F.pick(e?e.insert:B,e===B||!0===e),e=F.pick(e?e.deep:B,!0),r=(n&&t.copyAttributes(this),n&&!e||t.copyContent(this),n||t.copyAttributes(this),i&&t.insertAbove(this),this._name),e=this._parent;if(r&&e){for(var n=e._children,o=r,s=1;n[r];)r=o+" "+s++;r!==o&&t.setName(r)}return t},copyContent:function(e){for(var t=e._children,n=0,i=t&&t.length;n<i;n++)this.addChild(t[n].clone(!1),!0)},copyAttributes:function(e,t){this.setStyle(e._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,r=n.length;i<r;i++){var o=n[i];e.hasOwnProperty(o)&&(this[o]=e[o])}t||this._matrix.set(e._matrix,!0),this.setApplyMatrix(e._applyMatrix),this.setPivot(e._pivot),this.setSelection(e._selection);var t=e._data,s=e._name;this._data=t?F.clone(t):null,s&&this.setName(s)},rasterize:function(e,t){F.isPlainObject(e)?(o=e.resolution,n=e.insert,i=e.raster):(o=e,n=t),i?i.matrix.reset(!0):i=new d(U.NO_INSERT);var n,i,r,e=this.getStrokeBounds(),t=(o||this.getView().getResolution())/72,o=e.getTopLeft().floor(),e=e.getBottomRight().ceil(),e=new I(e.subtract(o)),s=e.multiply(t);return i.setSize(s,!0),s.isZero()||(s=i.getContext(!0),r=(new R).scale(t).translate(o.negate()),s.save(),r.applyToContext(s),this.draw(s,new F({matrices:[r]})),s.restore()),i.transform((new R).translate(o.add(e.divide(2))).scale(1/t)),n!==B&&!n||i.insertAbove(this),i},contains:function(){var e=this._matrix;return e.isInvertible()&&!!this._contains(e._inverseTransform(A.read(arguments)))},_contains:function(e){var t=this._children;if(t){for(var n=t.length-1;0<=n;n--)if(t[n].contains(e))return!0;return!1}return e.isInside(this.getInternalBounds())},isInside:function(){return C.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new W.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(e,t){return e instanceof U&&0<this._asPathItem().getIntersections(e._asPathItem(),null,t,!0).length}},new function(){function e(){var e=arguments;return this._hitTest(A.read(e),L.getOptions(e))}function t(){var e=arguments,t=A.read(e),e=L.getOptions(e),n=[];return this._hitTest(t,new F({all:n},e)),n}function n(e,t,n,i){var r=this._children;if(r)for(var o=r.length-1;0<=o;o--){var s=r[o],s=s!==i&&s._hitTest(e,t,n);if(s&&!t.all)return s}return null}return c.inject({hitTest:e,hitTestAll:t,_hitTest:n}),{hitTest:e,hitTestAll:t,_hitTestChildren:n}},{_hitTest:function(i,t,e){if(this._locked||!this._visible||this._guide&&!t.guides||this.isEmpty())return null;var n=this._matrix,e=e?e.appended(n):this.getGlobalMatrix().prepend(this.getView()._matrix),r=Math.max(t.tolerance,1e-12),l=t._tolerancePadding=new I(W._getStrokePadding(r,n._shiftless().invert()));if(!(i=n._inverseTransform(i))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(l.multiply(2))._containsPoint(i))return null;var h,o,r=!(t.guides&&!this._guide||t.selected&&!this.isSelected()||t.type&&t.type!==F.hyphenate(this._class)||t.class&&!(this instanceof t.class)),d=t.match,f=this;function p(e){return(e=e&&d&&!d(e)?null:e)&&t.all&&t.all.push(e),e}function s(e,t){var n=t?h["get"+t]():f.getPosition();if(i.subtract(n).divide(l).length<=1)return new L(e,f,{name:t?F.hyphenate(t):e,point:n})}var g=t.position,a=t.center,c=t.bounds;if(r&&this._parent&&(g||a||c)){if((a||c)&&(h=this.getInternalBounds()),!(o=g&&s("position")||a&&s("center","Center"))&&c)for(var v=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],u=0;u<8&&!o;u++)o=s("bounds",v[u]);o=p(o)}return(o=o||(this._hitTestChildren(i,t,e)||r&&p(this._hitTestSelf(i,t,e,this.getStrokeScaling()?null:e._shiftless().invert()))||null))&&o.point&&(o.point=n.transform(o.point)),o},_hitTestSelf:function(e,t){if(t.fill&&this.hasFill()&&this._contains(e))return new L("fill",this)},matches:function(e,t){var n=typeof e;if("object"==n){for(var i in e)if(e.hasOwnProperty(i)&&!this.matches(i,e[i]))return!1;return!0}if("function"==n)return e(this);if("match"===e)return t(this);n=/^(empty|editable)$/.test(e)?this["is"+F.capitalize(e)]():"type"===e?F.hyphenate(this._class):this[e];if("class"===e){if("function"==typeof t)return this instanceof t;n=this._class}if("function"==typeof t)return!!t(n);if(t){if(t.test)return t.test(n);if(F.isPlainObject(t))return function e(t,n){for(var i in t)if(t.hasOwnProperty(i)){var r=t[i],i=n[i];if(F.isPlainObject(r)&&F.isPlainObject(i)){if(!e(r,i))return!1}else if(!F.equals(r,i))return!1}return!0}(t,n)}return F.equals(n,t)},getItems:function(e){return U._getItems(this,e,this._matrix)},getItem:function(e){return U._getItems(this,e,this._matrix,null,!0)[0]||null},statics:{_getItems:function l(h,e,t,n,i){n||(o=(r="object"==typeof e&&e)&&r.overlapping,s=r&&r.inside,a=(u=o||s)&&C.read([u]),n={items:[],recursive:r&&!1!==r.recursive,inside:!!s,overlapping:!!o,rect:a,path:o&&new W.Rectangle({rectangle:a,insert:!1})},r&&(e=F.filter({},e,{recursive:!0,inside:!0,overlapping:!0})));var r,o,s,d=h._children,f=n.items,a=n.rect;t=a&&(t||new R);for(var p=0,g=d&&d.length;p<g;p++){var c=d[p],v=t&&t.appended(c._matrix),m=!0;if(a){var u=c.getBounds(v);if(!a.intersects(u))continue;a.contains(u)||n.overlapping&&(u.contains(a)||n.path.intersects(c,v))||(m=!1)}if(m&&c.matches(e)&&(f.push(c),i))break;if(!1!==n.recursive&&l(c,e,v,n,i),i&&0<f.length)break}return f}}},{importJSON:function(e){e=F.importJSON(e,this);return e!==this?this.addChild(e):e},addChild:function(e){return this.insertChild(B,e)},insertChild:function(e,t){e=t?this.insertChildren(e,[t]):null;return e&&e[0]},addChildren:function(e){return this.insertChildren(this._children.length,e)},insertChildren:function(e,t){var n=this._children;if(n&&t&&0<t.length){for(var i={},r=(t=F.slice(t)).length-1;0<=r;r--){var o=(c=t[r])&&c._id;!c||i[o]?t.splice(r,1):(c._remove(!1,!0),i[o]=!0)}F.splice(n,t,e,0);for(var s=this._project,a=s._changes,r=0,l=t.length;r<l;r++){var c,u=(c=t[r])._name;c._parent=this,c._setProject(s,!0),u&&c.setName(u),a&&c._changed(5)}this._changed(11)}else t=null;return t},_insertItem:"#insertChild",_insertAt:function(e,t){var n=e&&e._getOwner(),i=e!==this&&n?this:null;return i&&(i._remove(!1,!0),n._insertItem(e._index+t,i)),i},insertAbove:function(e){return this._insertAt(e,1)},insertBelow:function(e){return this._insertAt(e,0)},sendToBack:function(){var e=this._getOwner();return e?e._insertItem(0,this):null},bringToFront:function(){var e=this._getOwner();return e?e._insertItem(B,this):null},appendTop:"#addChild",appendBottom:function(e){return this.insertChild(0,e)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(e){return e._insertItem(B,this)},copyTo:function(e){return this.clone(!1).addTo(e)},reduce:function(e){var t=this._children;return t&&1===t.length?(t=t[0].reduce(e),this._parent?(t.insertAbove(this),this.remove()):t.remove(),t):this},_removeNamed:function(){var e,t,n,i,r=this._getOwner();r&&(e=r._children,-1!==(i=(n=(r=r._namedChildren)[t=this._name])?n.indexOf(this):-1)&&(e[t]==this&&delete e[t],n.splice(i,1),n.length?e[t]=n[0]:delete r[t]))},_remove:function(e,t){var n=this._getOwner(),i=this._project,r=this._index;return this._style&&this._style._dispose(),!!n&&(this._name&&this._removeNamed(),null!=r&&(i._activeLayer===this&&(i._activeLayer=this.getNextSibling()||this.getPreviousSibling()),F.splice(n._children,null,r,1)),this._installEvents(!1),e&&i._changes&&this._changed(5),t&&n._changed(11,this),!(this._parent=null))},remove:function(){return this._remove(!0,!0)},replaceWith:function(e){e=e&&e.insertBelow(this);return e&&this.remove(),e},removeChildren:function(e,t){if(!this._children)return null;e=e||0,t=F.pick(t,this._children.length);for(var n=F.splice(this._children,null,e,t-e),i=n.length-1;0<=i;i--)n[i]._remove(!0,!1);return 0<n.length&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,t=this._children.length;e<t;e++)this._children[e]._index=e;this._changed(11)}},isEmpty:function(e){var t=this._children,n=t?t.length:0;if(e){for(var i=0;i<n;i++)if(!t[i].isEmpty(e))return!1;return!0}return!n},isEditable:function(){for(var e=this;e;){if(!e._visible||e._locked)return!1;e=e._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(e){function t(e){for(var t=[];t.unshift(e),e=e._parent;);return t}for(var n=t(this),i=t(e),r=0,o=Math.min(n.length,i.length);r<o;r++)if(n[r]!=i[r])return n[r]._index<i[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&0<this._children.length},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(e){return-1===this._getOrder(e)},isBelow:function(e){return 1===this._getOrder(e)},isParent:function(e){return this._parent===e},isChild:function(e){return e&&e._parent===this},isDescendant:function(e){for(var t=this;t=t._parent;)if(t===e)return!0;return!1},isAncestor:function(e){return!!e&&e.isDescendant(this)},isSibling:function(e){return this._parent===e._parent},isGroupedWith:function(e){for(var t=this._parent;t;){if(t._parent&&/^(Group|Layer|CompoundPath)$/.test(t._class)&&e.isDescendant(t))return!0;t=t._parent}return!1}},F.each(["rotate","scale","shear","skew"],function(n){var i="rotate"===n;this[n]=function(){var e=arguments,t=(i?F:A).read(e),e=A.read(e,0,{readNull:!0});return this.transform((new R)[n](t,e||this.getPosition(!0)))}},{translate:function(){var e=new R;return this.transform(e.translate.apply(e,arguments))},transform:function(e,t,n){var i=this._matrix,r=e&&!e.isIdentity(),o=n&&this._canApplyMatrix||this._applyMatrix&&(r||!i.isIdentity()||t&&this._children);if(!r&&!o)return this;r&&(!e.isInvertible()&&i.isInvertible()&&(i._backup=i.getValues()),i.prepend(e,!0),u=(a=this._style).getFillColor(!0),a=a.getStrokeColor(!0),u&&u.transform(e),a&&a.transform(e)),(o=o&&this._transformContent(i,t,n))&&((u=this._pivot)&&i._transformPoint(u,u,!0),i.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0));var s=this._bounds,a=this._position,t=((r||o)&&this._changed(25),r&&s&&e.decompose());if(t&&t.skewing.isZero()&&t.rotation%90==0){for(var c in s){var l=s[c];l.nonscaling?delete s[c]:!o&&l.internal||(c=l.rect,e._transformBounds(c,c))}var u=(this._bounds=s)[this._getBoundsCacheKey(this._boundsOptions||{})];u&&(this._position=this._getPositionFromBounds(u.rect))}else r&&a&&this._pivot&&(this._position=e._transformPoint(a,a));return this},_transformContent:function(e,t,n){var i=this._children;if(i){for(var r=0,o=i.length;r<o;r++)i[r].transform(e,t,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(A.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(A.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(A.read(arguments))},localToParent:function(){return this._matrix._transformPoint(A.read(arguments))},fitBounds:function(e,t){e=C.read(arguments);var n=this.getBounds(),i=n.height/n.width,r=e.height/e.width,i=(t?r<i:i<r)?e.width/n.width:e.height/n.height,r=new C(new A,new I(n.width*i,n.height*i));r.setCenter(e.getCenter()),this.setBounds(r)}}),{_setStyles:function(e,t,n){var i,r,o=this._style,s=this._matrix;o.hasFill()&&(e.fillStyle=o.getFillColor().toCanvasStyle(e,s)),o.hasStroke()&&(e.strokeStyle=o.getStrokeColor().toCanvasStyle(e,s),e.lineWidth=o.getStrokeWidth(),s=o.getStrokeJoin(),r=o.getStrokeCap(),i=o.getMiterLimit(),s&&(e.lineJoin=s),r&&(e.lineCap=r),i&&(e.miterLimit=i),P.support.nativeDash&&(s=o.getDashArray(),r=o.getDashOffset(),s&&s.length&&("setLineDash"in e?(e.setLineDash(s),e.lineDashOffset=r):(e.mozDash=s,e.mozDashOffset=r)))),o.hasShadow()&&(i=t.pixelRatio||1,r=(s=n._shiftless().prepend((new R).scale(i,i))).transform(new A(o.getShadowBlur(),0)),t=s.transform(this.getShadowOffset()),e.shadowColor=o.getShadowColor().toCanvasStyle(e),e.shadowBlur=r.getLength(),e.shadowOffsetX=t.x,e.shadowOffsetY=t.y)},draw:function(e,t,n){this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var i=t.matrices,r=t.viewMatrix,l=this._matrix,o=i[i.length-1].appended(l);if(o.isInvertible()){r=r?r.appended(o):o,i.push(o),t.updateMatrix&&(this._globalMatrix=o);var h,d,f,o=this._blendMode,p=z.clamp(this._opacity,0,1),s="normal"===o,a=he.nativeModes[o],s=s&&1===p||t.dontStart||t.clip||(a||s&&p<1)&&this._canComposite(),c=t.pixelRatio||1;if(!s){var u=this.getStrokeBounds(r);if(!u.width||!u.height)return void i.pop();f=t.offset,d=t.offset=u.getTopLeft().floor(),h=e,e=le.getContext(u.getSize().ceil().add(1).multiply(c)),1!==c&&e.scale(c,c)}e.save();var u=n?n.appended(l):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,n=!s&&t.clipItem,g=!u||n;s?(e.globalAlpha=p,a&&(e.globalCompositeOperation=o)):g&&e.translate(-d.x,-d.y),g&&(s?l:r).applyToContext(e),n&&t.clipItem.draw(e,t.extend({clip:!0})),u&&(e.setTransform(c,0,0,c,0,0),(a=t.offset)&&e.translate(-a.x,-a.y)),this._draw(e,t,r,u),e.restore(),i.pop(),t.clip&&!t.dontFinish&&e.clip(this.getFillRule()),s||(he.process(o,e,h,p,d.subtract(f).multiply(c)),le.release(e),t.offset=f)}}},_isUpdated:function(e){var t=this._parent;if(t instanceof J)return t._isUpdated(e);var n=this._updateVersion===e;return!n&&t&&t._visible&&t._isUpdated(e)&&(this._updateVersion=e,n=!0),n},_drawSelection:function(e,t,n,l,i){var r=this._selection,o=1&r,h=2&r||o&&this._selectBounds,r=4&r;if(((o=!this._drawSelected?!1:o)||h||r)&&this._isUpdated(i)){var i=this.getSelectedColor(!0)||(i=this.getLayer())&&i.getSelectedColor(!0),t=t.appended(this.getGlobalMatrix(!0)),s=n/2;if(e.strokeStyle=e.fillStyle=i?i.toCanvasStyle(e):"#009dec",o&&this._drawSelected(e,t,l),r)for(var i=this.getPosition(!0),o=this._parent,l=o?o.localToGlobal(i):i,d=l.x,f=l.y,p=(e.beginPath(),e.arc(d,f,s,0,2*Math.PI,!0),e.stroke(),[[0,-1],[1,0],[0,1],[-1,0]]),g=s,v=n+1,a=0;a<4;a++){var c=p[a],m=c[0],c=c[1];e.moveTo(d+m*g,f+c*g),e.lineTo(d+m*v,f+c*v),e.stroke()}if(h){var u=t._transformCorners(this.getInternalBounds());e.beginPath();for(a=0;a<8;a++)e[a?"lineTo":"moveTo"](u[a],u[++a]);e.closePath(),e.stroke();for(a=0;a<8;a++)e.fillRect(u[a]-s,u[++a]-s,n,n)}}},_canComposite:function(){return!1}},F.each(["down","drag","up","move"],function(t){this["removeOn"+F.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(e){for(var t in e){var n;e[t]&&(t="mouse"+t,(n=(n=this._project)._removeSets=n._removeSets||{})[t]=n[t]||{},n[t][this._id]=this)}return this}}),{tween:function(e,t,n){n||(n=t,t=e,e=null,n||(n=t,t=null));var i=n&&n.easing,r=n&&n.start,n=null!=n&&("number"==typeof n?n:n.duration),o=new ce(this,e,t,n,i,r);return n&&this.on("frame",function e(t){o._handleFrame(1e3*t.time),o.running||this.off("frame",e)}),o},tweenTo:function(e,t){return this.tween(null,e,t)},tweenFrom:function(e,t){return this.tween(e,null,t)}}),m=U.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||this.addChildren(Array.isArray(e)?e:arguments)},_changed:function e(t){e.base.call(this,t),2050&t&&(this._clipItem=B)},_getClipItem:function(){if((e=this._clipItem)===B){for(var e=null,t=this._children,n=0,i=t.length;n<i;n++)if(t[n]._clipMask){e=t[n];break}this._clipItem=e}return e},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var t=this.getFirstChild();t&&t.setClipMask(e)},_getBounds:function e(t,n){var i=this._getClipItem();return i?i._getCachedBounds(i._matrix.prepended(t),F.set({},n,{stroke:!1})):e.base.call(this,t,n)},_hitTestChildren:function e(t,n,i){var r=this._getClipItem();return(!r||r.contains(t))&&e.base.call(this,t,n,i,r)},_draw:function(e,t){for(var n=t.clip,i=!n&&this._getClipItem(),r=(t=t.extend({clipItem:i,clip:!1}),n?(e.beginPath(),t.dontStart=t.dontFinish=!0):i&&i.draw(e,t.extend({clip:!0})),this._children),o=0,s=r.length;o<s;o++){var a=r[o];a!==i&&a.draw(e,t)}}}),h=m.extend({_class:"Layer",initialize:function(){m.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function e(){return this._parent?e.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),_=U.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(e,t){this._initialize(e,t)},_equals:function(e){return this._type===e._type&&this._size.equals(e._size)&&F.equals(this._radius,e._radius)},copyContent:function(e){this.setType(e._type),this.setSize(e._size),this.setRadius(e._radius)},getType:function(){return this._type},setType:function(e){this._type=e},getShape:"#getType",setShape:"#setType",getSize:function(){var e=this._size;return new i(e.width,e.height,this,"setSize")},setSize:function(){var e,t,n,i=I.read(arguments);this._size?this._size.equals(i)||(e=this._type,t=i.width,n=i.height,"rectangle"===e?this._radius.set(I.min(this._radius,i.divide(2).abs())):"circle"===e?(t=n=(t+n)/2,this._radius=t/2):"ellipse"===e&&this._radius._set(t/2,n/2),this._size._set(t,n),this._changed(9)):this._size=i.clone()},getRadius:function(){var e=this._radius;return"circle"===this._type?e:new i(e.width,e.height,this,"setRadius")},setRadius:function(e){var t=this._type;if("circle"===t){if(e===this._radius)return;var n=2*e;this._radius=e,this._size._set(n,n)}else if(e=I.read(arguments),this._radius){if(this._radius.equals(e))return;this._radius.set(e),"rectangle"===t?(n=I.max(this._size,e.multiply(2)),this._size.set(n)):"ellipse"===t&&this._size._set(2*e.width,2*e.height)}else this._radius=e.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(e){var t=new W[F.capitalize(this._type)]({center:new A,size:this._size,radius:this._radius,insert:!1});return t.copyAttributes(this),P.settings.applyMatrix&&t.setApplyMatrix(!0),e!==B&&!e||t.insertAbove(this),t},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(e,t,l,n){var i,r,o,s,a,c=this._style,h=c.hasFill(),d=c.hasStroke(),f=t.dontFinish||t.clip,u=!n;(h||d||f)&&(o=this._type,s=this._radius,r="circle"===o,t.dontStart||e.beginPath(),u&&r?e.arc(0,0,s,0,2*Math.PI,!0):(i=r?s:s.width,r=r?s:s.height,a=(s=this._size).width,s=s.height,u&&"rectangle"===o&&0===i&&0===r?e.rect(-a/2,-s/2,a,s):(a=[-(u=a/2),-(o=s/2)+r,-u,(s=r*(a=.44771525016920644))-o,(a=i*a)-u,-o,-u+i,-o,u-i,-o,u-a,-o,u,s-o,u,-o+r,u,o-r,u,o-s,u-a,o,u-i,o,-u+i,o,a-u,o,-u,o-s,-u,o-r],n&&n.transform(a,a,32),e.moveTo(a[0],a[1]),e.bezierCurveTo(a[2],a[3],a[4],a[5],a[6],a[7]),u!==i&&e.lineTo(a[8],a[9]),e.bezierCurveTo(a[10],a[11],a[12],a[13],a[14],a[15]),o!==r&&e.lineTo(a[16],a[17]),e.bezierCurveTo(a[18],a[19],a[20],a[21],a[22],a[23]),u!==i&&e.lineTo(a[24],a[25]),e.bezierCurveTo(a[26],a[27],a[28],a[29],a[30],a[31]))),e.closePath()),f||!h&&!d||(this._setStyles(e,t,l),h&&(e.fill(c.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),d&&e.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(e,t){var n=new C(this._size).setCenter(0,0),i=this._style,i=t.stroke&&i.hasStroke()&&i.getStrokeWidth();return e&&(n=e._transformBounds(n)),i?n.expand(W._getStrokePadding(i,this._getStrokeMatrix(e,t))):n}},new function(){function d(e,t,n){var i=e._radius;if(!i.isZero())for(var r=e._size.divide(2),o=1;o<=4;o++){var s=new A(1<o&&o<4?-1:1,2<o?-1:1),a=s.multiply(r),c=a.subtract(s.multiply(i));if(new C(n?a.add(s.multiply(n)):a,c).contains(t))return{point:c,quadrant:o}}}function f(e,t,n,i){e=e.divide(t);return(!i||e.isInQuadrant(i))&&e.subtract(e.normalize()).multiply(t).divide(n).length<=1}return{_contains:function e(t){var n;return"rectangle"===this._type?(n=d(this,t))?t.subtract(n.point).divide(this._radius).getLength()<=1:e.base.call(this,t):t.divide(this.size).getLength()<=.5},_hitTestSelf:function u(e,t,l,h){var n,i,r,o=!1,s=this._style,a=t.stroke&&s.hasStroke(),c=t.fill&&s.hasFill();return(a||c)&&(c=this._type,n=this._radius,i=a?s.getStrokeWidth()/2:0,i=t._tolerancePadding.add(W._getStrokePadding(i,!s.getStrokeScaling()&&h)),o="rectangle"===c?(c=d(this,e,s=i.multiply(2)))?f(e.subtract(c.point),n,i,c.quadrant):(r=(c=new C(this._size).setCenter(0,0)).expand(s),c=c.expand(s.negate()),r._containsPoint(e)&&!c._containsPoint(e)):f(e,n,i)),o?new L(a?"stroke":"fill",this):u.base.apply(this,arguments)}}},{statics:new function(){function i(e,t,n,i,r){var o=F.create(_.prototype);return o._type=e,o._size=n,o._radius=i,o._initialize(F.getNamed(r),t),o}return{Circle:function(){var e=arguments,t=A.readNamed(e,"center"),n=F.readNamed(e,"radius");return i("circle",t,new I(2*n),n,e)},Rectangle:function(){var e=arguments,t=C.readNamed(e,"rectangle"),n=I.min(I.readNamed(e,"radius"),t.getSize(!0).divide(2));return i("rectangle",t.getCenter(!0),t.getSize(!0),n,e)},Ellipse:function(){var e=arguments,t=_._readEllipse(e),n=t.radius;return i("ellipse",t.center,n.multiply(2),n,e)},_readEllipse:function(e){var t;return e=F.hasNamed(e,"radius")?(t=A.readNamed(e,"center"),I.readNamed(e,"radius")):(t=(e=C.readNamed(e,"rectangle")).getCenter(!0),e.getSize(!0).divide(2)),{center:t,radius:e}}}}}),d=U.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(e,t){var n,i;this._initialize(e,t!==B&&A.read(arguments))||((i="string"==(i=typeof e)?M.getElementById(e):"object"==i?e:null)&&i!==U.NO_INSERT&&(i.getContext||null!=i.naturalHeight?n=i:i&&((i=I.read(arguments)).isZero()||(n=le.getCanvas(i)))),n?this.setImage(n):this.setSource(e)),this._size||(this._size=new I,this._loaded=!1)},_equals:function(e){return this.getSource()===e.getSource()},copyContent:function(e){var t=e._image,n=e._canvas;t?this._setImage(t):n&&((t=le.getCanvas(e._size)).getContext("2d").drawImage(n,0,0),this._setImage(t)),this._crossOrigin=e._crossOrigin},getSize:function(){var e=this._size;return new i(e?e.width:0,e?e.height:0,this,"setSize")},setSize:function(e,t){var n,i=I.read(arguments);i.equals(this._size)?t&&this.clear():0<i.width&&0<i.height?(n=!t&&this.getElement(),this._setImage(le.getCanvas(i)),n&&this.getContext(!0).drawImage(n,0,0,i.width,i.height)):(this._canvas&&le.release(this._canvas),this._size=i.clone())},getWidth:function(){return this._size?this._size.width:0},setWidth:function(e){this.setSize(e,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(e){this.setSize(this.getWidth(),e)},getLoaded:function(){return this._loaded},isEmpty:function(){var e=this._size;return!e||0===e.width&&0===e.height},getResolution:function(){var e=this._matrix,t=new A(0,0).transform(e),n=new A(1,0).transform(e).subtract(t),e=new A(0,1).transform(e).subtract(t);return new I(72/n.getLength(),72/e.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var i=this;function n(e){var t=i.getView(),n=e&&e.type||"load";t&&i.responds(n)&&(P=t._scope,i.emit(n,new ne(e)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&Q.add(t,{load:function(e){i._setImage(t),n(e)},error:n})},_setImage:function(e){this._canvas&&le.release(this._canvas),e&&e.getContext?(this._image=null,this._canvas=e,this._loaded=!0):(this._image=e,this._canvas=null,this._loaded=!!(e&&e.src&&e.complete)),this._size=new I(e?e.naturalWidth||e.width:0,e?e.naturalHeight||e.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=le.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){le.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(e){return this._context||(this._context=this.getCanvas().getContext("2d")),e&&(this._image=null,this._changed(1025)),this._context},setContext:function(e){this._context=e},getSource:function(){var e=this._image;return e&&e.src||this.toDataURL()},setSource:function(e){var t=new w.Image,n=this._crossOrigin;n&&(t.crossOrigin=n),e&&(t.src=e),this.setImage(t)},getCrossOrigin:function(){var e=this._image;return e&&e.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(e){this._crossOrigin=e;var t=this._image;t&&(t.crossOrigin=e)},getSmoothing:function(){return this._smoothing},setSmoothing:function(e){this._smoothing="string"==typeof e?e:e?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var e=C.read(arguments),t=le.getContext(e.getSize());return t.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.canvas},getSubRaster:function(){var e=C.read(arguments),t=new d(U.NO_INSERT);return t._setImage(this.getSubCanvas(e)),t.translate(e.getCenter().subtract(this.getSize().divide(2))),t._matrix.prepend(this._matrix),t.insertAbove(this),t},toDataURL:function(){var e=this._image,e=e&&e.src;if(/^data:/.test(e))return e;e=this.getCanvas();return e?e.toDataURL.apply(e,arguments):null},drawImage:function(e){var t=A.read(arguments,1);this.getContext(!0).drawImage(e,t.x,t.y)},getAverageColor:function(e){if(e?e instanceof T?i=(r=e).getBounds():"object"==typeof e&&("width"in e?i=new C(e):"x"in e&&(i=new C(e.x-.5,e.y-.5,1,1))):i=this.getBounds(),!i)return null;for(var e=Math.min(i.width,32),t=Math.min(i.height,32),n=d._sampleContext,i=(n?n.clearRect(0,0,33,33):n=d._sampleContext=le.getContext(new I(32)),n.save(),(new R).scale(e/i.width,t/i.height).translate(-i.x,-i.y)),r=(i.applyToContext(n),r&&r.draw(n,new F({clip:!0,matrices:[i]})),this._matrix.applyToContext(n),this.getElement()),i=this._size,o=(r&&n.drawImage(r,-i.width/2,-i.height/2),n.restore(),n.getImageData(.5,.5,Math.ceil(e),Math.ceil(t)).data),s=[0,0,0],a=0,c=0,l=o.length;c<l;c+=4){var u=o[c+3];a+=u,u/=255,s[0]+=o[c]*u,s[1]+=o[c+1]*u,s[2]+=o[c+2]*u}for(c=0;c<3;c++)s[c]/=a;return a?X.read(s):null},getPixel:function(){var e=A.read(arguments),e=this.getContext().getImageData(e.x,e.y,1,1).data;return new X("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var e=arguments,t=A.read(e),e=X.read(e),n=e._convert("rgb"),e=e._alpha,i=this.getContext(!0),r=i.createImageData(1,1),o=r.data;o[0]=255*n[0],o[1]=255*n[1],o[2]=255*n[2],o[3]=null!=e?255*e:255,i.putImageData(r,t.x,t.y)},clear:function(){var e=this._size;this.getContext(!0).clearRect(0,0,e.width+1,e.height+1)},createImageData:function(){var e=I.read(arguments);return this.getContext().createImageData(e.width,e.height)},getImageData:function(){var e=C.read(arguments);return e.isEmpty()&&(e=new C(this._size)),this.getContext().getImageData(e.x,e.y,e.width,e.height)},setImageData:function(e){var t=A.read(arguments,1);this.getContext(!0).putImageData(e,t.x,t.y)},_getBounds:function(e,t){var n=new C(this._size).setCenter(0,0);return e?e._transformBounds(n):n},_hitTestSelf:function(e){var t;if(this._contains(e))return new L("pixel",t=this,{offset:e.add(t._size.divide(2)).round(),color:{get:function(){return t.getPixel(this.offset)}}})},_draw:function(e,t,n){var i=this.getElement();i&&0<i.width&&0<i.height&&(e.globalAlpha=z.clamp(this._opacity,0,1),this._setStyles(e,t,n),t=this._smoothing,$.setPrefixed(e,(n="off"===t)?"imageSmoothingEnabled":"imageSmoothingQuality",!n&&t),e.drawImage(i,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),y=U.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(e,t){this._initialize(e,t!==B&&A.read(arguments,1))||this.setDefinition(e instanceof S?e:new S(e))},_equals:function(e){return this._definition===e._definition},copyContent:function(e){this.setDefinition(e._definition)},getDefinition:function(){return this._definition},setDefinition:function(e){this._definition=e,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(e,t){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(e),t)},_hitTestSelf:function(e,t,n){t=t.extend({all:!1}),e=this._definition._item._hitTest(e,t,n);return e&&(e.item=this),e},_draw:function(e,t){this._definition._item.draw(e,t)}}),S=F.extend({_class:"SymbolDefinition",initialize:function(e,t){this._id=a.get(),this.project=P.project,e&&this.setItem(e,t)},_serialize:function(e,t){return t.add(this,function(){return F.serialize([this._class,this._item],e,!1,t)})},_changed:function(e){8&e&&U._clearBoundsCache(this),1&e&&this.project._changed(e)},getItem:function(){return this._item},setItem:function(e,t){e._symbol&&(e=e.clone()),this._item&&(this._item._symbol=null),(this._item=e).remove(),e.setSelected(!1),t||e.setPosition(new A),(e._symbol=this)._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(e){return new y(this,e)},clone:function(){return new S(this._item.clone(!1))},equals:function(e){return e===this||e&&this._item.equals(e._item)||!1}}),L=F.extend({_class:"HitResult",initialize:function(e,t,n){this.type=e,this.item=t,n&&this.inject(n)},statics:{getOptions:function(e){e=e&&F.read(e);return new F({type:null,tolerance:P.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),H=F.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(e,t,n,i,r,l){var o,s,a,c,u=arguments.length;0<u&&(null==e||"object"==typeof e?c=1===u&&e&&"point"in e?(o=e.point,s=e.handleIn,a=e.handleOut,e.selection):(o=e,s=t,a=n,i):(o=[e,t],s=n!==B?[n,i]:null,a=r!==B?[r,l]:null)),new x(o,this,"_point"),new x(s,this,"_handleIn"),new x(a,this,"_handleOut"),c&&this.setSelection(c)},_serialize:function(e,t){var n=this._point,i=this._selection,n=i||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return i&&n.push(i),F.serialize(n,e,!0,t)},_changed:function(e){var t,n,i,r=this._path;r&&(t=r._curves,n=this._index,t&&(e&&e!==this._point&&e!==this._handleIn||!(i=0<n?t[n-1]:r._closed?t[t.length-1]:null)||i._changed(),e&&e!==this._point&&e!==this._handleOut||!(i=t[n])||i._changed()),r._changed(41))},getPoint:function(){return this._point},setPoint:function(){this._point.set(A.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(A.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(A.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var e=this._handleIn,t=this._handleOut;return!e.isZero()&&!t.isZero()&&e.isCollinear(t)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(e){var t=this._selection,n=this._path;this._selection=e=e||0,n&&e!==t&&(n._updateSelection(this,t,e),n._changed(257))},_changeSelection:function(e,t){var n=this._selection;this.setSelection(t?n|e:n&~e)},isSelected:function(){return!!(7&this._selection)},setSelected:function(e){this._changeSelection(7,e)},getIndex:function(){return this._index!==B?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var e=this._path,t=this._index;return e?(0<t&&!e._closed&&t===e._segments.length-1&&t--,e.getCurves()[t]||null):null},getLocation:function(){var e=this.getCurve();return e?new q(e,this===e._segment1?0:1):null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},smooth:function(e,l,h){var e=e||{},t=e.type,e=e.factor,d=this.getPrevious(),f=this.getNext(),n=(d||this)._point,i=this._point,r=(f||this)._point,o=n.getDistance(i),p=i.getDistance(r);if(t&&"catmull-rom"!==t){if("geometric"!==t)throw new Error("Smoothing method '"+t+"' not supported.");d&&f&&(t=n.subtract(r),c=(u=e===B?.4:e)*o/(o+p),l||this.setHandleIn(t.multiply(c)),h||this.setHandleOut(t.multiply(c-u)))}else{var s,a,t=e===B?.5:e,c=Math.pow(o,t),u=c*c,e=Math.pow(p,t),o=e*e;!l&&d&&(s=2*o+3*e*c+u,this.setHandleIn(0!==(a=3*e*(e+c))?new A((o*n._x+s*i._x-u*r._x)/a-i._x,(o*n._y+s*i._y-u*r._y)/a-i._y):new A)),!h&&f&&(s=2*u+3*c*e+o,this.setHandleOut(0!==(a=3*c*(c+e))?new A((u*r._x+s*i._x-o*n._x)/a-i._x,(u*r._y+s*i._y-o*n._y)/a-i._y):new A))}},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var e=this._path;return e&&this._index===e._segments.length-1||!1},reverse:function(){var e=this._handleIn,t=this._handleOut,n=e.clone();e.set(t),t.set(n)},reversed:function(){return new H(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new H(this._point,this._handleIn,this._handleOut)},equals:function(e){return e===this||e&&this._class===e._class&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)||!1},toString:function(){var e=["point: "+this._point];return this._handleIn.isZero()||e.push("handleIn: "+this._handleIn),this._handleOut.isZero()||e.push("handleOut: "+this._handleOut),"{ "+e.join(", ")+" }"},transform:function(e){this._transformCoordinates(e,new Array(6),!0),this._changed()},interpolate:function(e,t,n){var i=1-n,r=e._point,o=t._point,s=e._handleIn,a=t._handleIn,t=t._handleOut,e=e._handleOut;this._point._set(i*r._x+n*o._x,i*r._y+n*o._y,!0),this._handleIn._set(i*s._x+n*a._x,i*s._y+n*a._y,!0),this._handleOut._set(i*e._x+n*t._x,i*e._y+n*t._y,!0),this._changed()},_transformCoordinates:function(e,t,n){var i=this._point,r=n&&this._handleIn.isZero()?null:this._handleIn,o=n&&this._handleOut.isZero()?null:this._handleOut,s=i._x,a=i._y,c=2;return t[0]=s,t[1]=a,r&&(t[c++]=r._x+s,t[c++]=r._y+a),o&&(t[c++]=o._x+s,t[c++]=o._y+a),e&&(e._transformCoordinates(t,t,c/2),s=t[0],a=t[1],n?(i._x=s,i._y=a,c=2,r&&(r._x=t[c++]-s,r._y=t[c++]-a),o&&(o._x=t[c++]-s,o._y=t[c++]-a)):(r||(t[c++]=s,t[c++]=a),o||(t[c++]=s,t[c++]=a))),t}}),x=A.extend({initialize:function(e,t,n){var i,r,o;e?(i=e[0])!==B?r=e[1]:((i=(o=e).x)===B&&(i=(o=A.read(arguments)).x),r=o.y,o=o.selected):i=r=0,this._x=i,this._y=r,(this._owner=t)[n]=this,o&&this.setSelected(!0)},_set:function(e,t){return this._x=e,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner._changed(this)},isZero:function(){var e=z.isZero;return e(this._x)&&e(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(e){this._owner._changeSelection(this._getSelection(),e)},_getSelection:function(){var e=this._owner;return this===e._point?1:this===e._handleIn?2:this===e._handleOut?4:0}}),G=F.extend({_class:"Curve",beans:!0,initialize:function(e,t,n,l,h,d,f,p){var i,r,o,s,a,c,u=arguments.length;3===u?(this._path=e,i=t,r=n):u?1===u?"segment1"in e?(i=new H(e.segment1),r=new H(e.segment2)):"point1"in e?(o=e.point1,a=e.handle1,c=e.handle2,s=e.point2):Array.isArray(e)&&(o=[e[0],e[1]],s=[e[6],e[7]],a=[e[2]-e[0],e[3]-e[1]],c=[e[4]-e[6],e[5]-e[7]]):2===u?(i=new H(e),r=new H(t)):4===u?(o=e,a=t,c=n,s=l):8===u&&(o=[e,t],s=[f,p],a=[n-e,l-t],c=[h-f,d-p]):(i=new H,r=new H),this._segment1=i||new H(o,null,a),this._segment2=r||new H(s,c,null)},_serialize:function(e,t){return F.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],e,!0,t)},_changed:function(){this._length=this._bounds=B},clone:function(){return new G(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||e.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||e.push("handle2: "+this._segment2._handleIn),e.push("point2: "+this._segment2._point),"{ "+e.join(", ")+" }"},classify:function(){return G.classify(this.getValues())},remove:function(){var e,t,n=!1;return this._path&&(t=(e=this._segment2)._handleOut,(n=e.remove())&&this._segment1._handleOut.set(t)),n},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(A.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(A.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(A.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(A.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var e=this._path;return e&&this._segment1._index===e._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(e){this.getPoint1().setSelected(e),this.getHandle1().setSelected(e),this.getHandle2().setSelected(e),this.getPoint2().setSelected(e)},getValues:function(e){return G.getValues(this._segment1,this._segment2,e)},getPoints:function(){for(var e=this.getValues(),t=[],n=0;n<8;n+=2)t.push(new A(e[n],e[n+1]));return t}},{getLength:function(){return null==this._length&&(this._length=G.getLength(this.getValues(),0,1)),this._length},getArea:function(){return G.getArea(this.getValues())},getLine:function(){return new j(this._segment1._point,this._segment2._point)},getPart:function(e,t){return new G(G.getPart(this.getValues(),e,t))},getPartLength:function(e,t){return G.getLength(this.getValues(),e,t)},divideAt:function(e){return this.divideAtTime(e&&e.curve===this?e.time:this.getTimeAt(e))},divideAtTime:function(e,t){var n,i,r,o,s,a,c=null;return 1e-8<=e&&e<=1-1e-8&&(a=(e=G.subdivide(this.getValues(),e))[0],e=e[1],t=t||this.hasHandles(),n=this._segment1,i=this._segment2,r=this._path,t&&(n._handleOut._set(a[2]-a[0],a[3]-a[1]),i._handleIn._set(e[4]-e[6],e[5]-e[7])),o=a[6],s=a[7],a=new H(new A(o,s),t&&new A(a[4]-o,a[5]-s),t&&new A(e[2]-o,e[3]-s)),c=r?(r.insert(n._index+1,a),this.getNext()):(this._segment2=a,this._changed(),new G(a,i))),c},splitAt:function(e){var t=this._path;return t?t.splitAt(e):null},splitAtTime:function(e){return this.splitAt(this.getLocationAtTime(e))},divide:function(e,t){return this.divideAtTime(e===B?.5:t?e:this.getTimeAt(e))},split:function(e,t){return this.splitAtTime(e===B?.5:t?e:this.getTimeAt(e))},reversed:function(){return new G(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(e,t,n,i){var r=e._point,e=e._handleOut,o=t._handleIn,t=t._point,s=r.x,r=r.y,a=t.x,t=t.y,i=i?[s,r,s,r,a,t,a,t]:[s,r,s+e._x,r+e._y,a+o._x,t+o._y,a,t];return n&&n._transformCoordinates(i,i,4),i},subdivide:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],e=e[7],u=1-(t=t===B?.5:t),l=u*n+t*r,h=u*i+t*o,r=u*r+t*s,o=u*o+t*a,s=u*s+t*c,a=u*a+t*e,d=u*l+t*r,f=u*h+t*o,r=u*r+t*s,o=u*o+t*a,p=u*d+t*r,u=u*f+t*o;return[[n,i,l,h,d,f,p,u],[p,u,r,o,s,a,c,e]]},getMonoCurves:function(e,t){var n,i,r=[],t=t?0:1,o=e[0+t],s=e[2+t],a=e[4+t],t=e[6+t];return!(s<=o==a<=s&&a<=s==t<=a||G.isStraight(e))&&(i=z.solveQuadratic(3*(s-a)-o+t,2*(o+a)-4*s,s-o,n=[],1e-8,1-1e-8))?(n.sort(),t=n[0],a=G.subdivide(e,t),r.push(a[0]),1<i&&(t=(n[1]-t)/(1-t),a=G.subdivide(a[1],t),r.push(a[0])),r.push(a[1])):r.push(e),r},solveCubic:function(e,t,n,i,r,o){var s=e[t],a=e[t+2],c=e[t+4],e=e[t+6],t=0;return t=!(s<n&&e<n&&a<n&&c<n||n<s&&n<e&&n<a&&n<c)?z.solveCubic(e-s-(e=3*(a-s))-(c=3*(c-a)-e),c,e,s-n,i,r,o):t},getTimeOf:function(e,t){var n=new A(e[0],e[1]),i=new A(e[6],e[7]);if(null===(t.isClose(n,1e-12)?0:t.isClose(i,1e-12)?1:null))for(var r=[t.x,t.y],o=[],s=0;s<2;s++)for(var a=G.solveCubic(e,s,r[s],o,0,1),c=0;c<a;c++){var u=o[c];if(t.isClose(G.getPoint(e,u),1e-7))return u}return t.isClose(n,1e-7)?0:t.isClose(i,1e-7)?1:null},getNearestTime:function(n,i){if(G.isStraight(n)){var e=n[0],t=n[1],r=n[6]-e,o=n[7]-t,s=r*r+o*o;if(0==s)return 0;s=((i.x-e)*r+(i.y-t)*o)/s;return s<1e-12?0:.999999999999<s?1:G.getTimeOf(n,new A(e+s*r,t+s*o))}var l=1/0,a=0;function c(e){var t;if(0<=e&&e<=1)return(t=i.getDistance(G.getPoint(n,e),!0))<l?(l=t,a=e,1):void 0}for(var h=0;h<=100;h++)c(h/100);for(var u=.005;1e-8<u;)c(a-u)||c(a+u)||(u/=2);return a},getPart:function(e,t,n){var i,r=n<t;return r&&(i=t,t=n,n=i),0<t&&(e=G.subdivide(e,t)[1]),n<1&&(e=G.subdivide(e,(n-t)/(1-t))[0]),r?[e[6],e[7],e[4],e[5],e[2],e[3],e[0],e[1]]:e},isFlatEnough:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],e=e[7],r=3*r-2*n-c,o=3*o-2*i-e,s=3*s-2*c-n,c=3*a-2*e-i;return Math.max(r*r,s*s)+Math.max(o*o,c*c)<=16*t*t},getArea:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],e=e[7];return 3*((e-n)*(i+o)-(a-t)*(r+s)+r*(t-o)-i*(n-s)+e*(o+t/3)-a*(s+n/3))/20},getBounds:function(e){for(var t=e.slice(0,2),n=t.slice(),i=[0,0],r=0;r<2;r++)G._addBounds(e[r],e[r+2],e[r+4],e[r+6],r,0,t,n,i);return new C(t[0],t[1],n[0]-t[0],n[1]-t[1])},_addBounds:function(e,t,n,i,r,l,h,d,f){function o(e,t){var n=e-t,e=e+t;n<h[r]&&(h[r]=n),e>d[r]&&(d[r]=e)}var s=h[r]+(l/=2),a=d[r]-l;if(e<s||t<s||n<s||i<s||a<e||a<t||a<n||a<i)if(t<e!=t<i&&n<e!=n<i)o(e,0),o(i,0);else{var p=z.solveQuadratic(3*(t-n)-e+i,2*(e+n)-4*t,t-e,f);o(i,0);for(var g=0;g<p;g++){var c=f[g],u=1-c;1e-8<=c&&c<=1-1e-8&&o(u*u*u*e+3*u*u*c*t+3*u*c*c*n+c*c*c*i,l)}}}}},F.each(["getBounds","getStrokeBounds","getHandleBounds"],function(e){this[e]=function(){return this._bounds||(this._bounds={}),(this._bounds[e]||(this._bounds[e]=W[e]([this._segment1,this._segment2],!1,this._path))).clone()}},{}),F.each({isStraight:function(e,t,n,i){if(t.isZero()&&n.isZero())return!0;var r=i.subtract(e);if(r.isZero())return!1;if(r.isCollinear(t)&&r.isCollinear(n)){var o=new j(e,i);if(o.getDistance(e.add(t))<1e-7&&o.getDistance(i.add(n))<1e-7)return e=r.dot(r),o=r.dot(t)/e,i=r.dot(n)/e,0<=o&&o<=1&&i<=0&&-1<=i}return!1},isLinear:function(e,t,n,i){i=i.subtract(e).divide(3);return t.equals(i)&&n.negate().equals(i)}},function(s,e){this[e]=function(e){var t=this._segment1,n=this._segment2;return s(t._point,t._handleOut,n._handleIn,n._point,e)},this.statics[e]=function(e,t){var n=e[0],i=e[1],r=e[6],o=e[7];return s(new A(n,i),new A(e[2]-n,e[3]-i),new A(e[4]-r,e[5]-o),new A(r,o),t)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(e){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(e||0)},isCollinear:function(e){return e&&this.isStraight()&&e.isStraight()&&this.getLine().isCollinear(e.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(e,t){return this.getLocationAtTime(t?e:this.getTimeAt(e))},getLocationAtTime:function(e){return null!=e&&0<=e&&e<=1?new q(this,e):null},getTimeAt:function(e,t){return G.getTimeAt(this.getValues(),e,t)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var e=A.read(arguments);return e.isZero()?[]:G.getTimesWithTangent(this.getValues(),e)},getOffsetAtTime:function(e){return this.getPartLength(0,e)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(A.read(arguments)))},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getTimeOf:function(){return G.getTimeOf(this.getValues(),A.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var e=A.read(arguments),t=this.getValues(),n=G.getNearestTime(t,e),t=G.getPoint(t,n);return new q(this,n,t,null,e.getDistance(t))},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()}},new function(){var e=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return F.each(e,function(i){this[i+"At"]=function(e,t){var n=this.getValues();return G[i](n,t?e:G.getTimeAt(n,e))},this[i+"AtTime"]=function(e){return G[i](this.getValues(),e)}},{statics:{_evaluateMethods:e}})},new function(){function l(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],e=e[7],c=9*(i-o)+3*(a-t),u=6*(t+o)-12*i,l=3*(i-t),h=9*(r-s)+3*(e-n),d=6*(n+s)-12*r,f=3*(r-n);return function(e){var t=(c*e+u)*e+l,e=(h*e+d)*e+f;return Math.sqrt(t*t+e*e)}}function h(e,t){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(t-e))))}function n(e,t,l,h){if(null==t||t<0||1<t)return null;var n,i,r=e[0],o=e[1],s=e[2],d=e[3],a=e[4],c=e[5],f=e[6],e=e[7],u=z.isZero,u=(u(s-r)&&u(d-o)&&(s=r,d=o),u(a-f)&&u(c-e)&&(a=f,c=e),3*(s-r)),p=3*(a-s)-u,g=f-r-u-p,v=3*(d-o),m=3*(c-d)-v,_=e-o-v-m;return 0===l?(n=0===t?r:1===t?f:((g*t+p)*t+u)*t+r,i=0===t?o:1===t?e:((_*t+m)*t+v)*t+o):(0,i=t<1e-8?(n=u,v):1-1e-8<t?(n=3*(f-a),3*(e-c)):(n=(3*g*t+2*p)*t+u,(3*_*t+2*m)*t+v),h&&(0===n&&0===i&&(t<1e-8||1-1e-8<t)&&(n=a-s,i=c-d),(r=Math.sqrt(n*n+i*i))&&(n/=r,i/=r)),3===l&&(a=6*g*t+2*p,c=6*_*t+2*m,n=0!==(o=Math.pow(n*n+i*i,1.5))?(n*c-i*a)/o:0,i=0)),2===l?new A(i,-n):new A(n,i)}return{statics:{classify:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],e=e[7],c=i*(n-e)+r*(a-t)+t*e-n*a,i=3*(o*(r-n)+s*(t-i)+i*n-r*t),r=i-c,c=r-c+(t*(e-s)+n*(o-a)+a*s-e*o),t=Math.sqrt(c*c+r*r+i*i),n=0!==t?1/t:0,a=z.isZero,s="serpentine";function u(e,t,n){var i=t!==B,r=i&&0<t&&t<1,o=i&&0<n&&n<1;return!i||(r||o)&&("loop"!==e||r&&o)||(r=o=!(e="arch")),{type:e,roots:r||o?r&&o?t<n?[t,n]:[n,t]:[r?t:n]:null}}if(r*=n,i*=n,a(c*=n))return a(r)?u(a(i)?"line":"quadratic"):u(s,i/(3*r));e=3*r*r-4*c*i;if(a(e))return u("cusp",r/(2*c));o=0<e?Math.sqrt(e/3):Math.sqrt(-e),t=2*c;return u(0<e?s:"loop",(r+o)/t,(r-o)/t)},getLength:function(e,t,n,i){var r,o;return t===B&&(t=0),n===B&&(n=1),G.isStraight(e)?(o=e,n<1&&(o=G.subdivide(o,n)[0],t/=n),r=(o=0<t?G.subdivide(o,t)[1]:o)[6]-o[0],o=o[7]-o[1],Math.sqrt(r*r+o*o)):z.integrate(i||l(e),t,n,h(t,n))},getTimeAt:function(e,t,n){if(n===B&&(n=t<0?1:0),0===t)return n;var i=Math.abs,r=0<t,o=r?n:0,s=r?1:n,a=l(e),e=G.getLength(e,o,s,a),c=i(t)-e;if(i(c)<1e-12)return r?s:o;if(1e-12<c)return null;var u=0;return z.findRoot(function(e){return u+=z.integrate(a,n,e,h(n,e)),n=e,u-t},a,n+t/e,o,s,32,1e-12)},getPoint:function(e,t){return n(e,t,0,!1)},getTangent:function(e,t){return n(e,t,1,!0)},getWeightedTangent:function(e,t){return n(e,t,1,!1)},getNormal:function(e,t){return n(e,t,2,!0)},getWeightedNormal:function(e,t){return n(e,t,2,!1)},getCurvature:function(e,t){return n(e,t,3,!1).x},getPeaks:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=3*i-t-3*o+e[6],o=3*t-6*i+3*o,t=-3*t+3*i,i=3*r-n-3*s+e[7],e=3*n-6*r+3*s,s=-3*n+3*r,n=[];return z.solveCubic(9*(a*a+i*i),9*(a*o+e*i),2*(o*o+e*e)+3*(t*a+s*i),t*o+e*s,n,1e-8,1-1e-8),n.sort()}}}},new function(){function M(e,t,n,i,r,o,s){var a=!s&&n.getPrevious()===r,c=!s&&n!==r&&n.getNext()===r;null!==i&&(a?1e-8:0)<=i&&i<=(c?1-1e-8:1)&&null!==o&&(c?1e-8:0)<=o&&o<=(a?1-1e-8:1)&&(c=new q(n,i,null,s),a=new q(r,o,null,s),(c._intersection=a)._intersection=c,t&&!t(c)||q.insert(e,c,!0))}function I(e,t,n,i,l,h,r,d,o,f,p,s,a){if(4096<=++o||40<=++d)return o;var g,v,c=t[0],m=t[1],_=t[6],u=t[7],y=j.getSignedDistance,w=y(c,m,_,u,t[2],t[3]),b=y(c,m,_,u,t[4],t[5]),C=0<w*b?.75:4/9,S=C*Math.min(0,w,b),C=C*Math.max(0,w,b),x=y(c,m,_,u,e[0],e[1]),T=y(c,m,_,u,e[2],e[3]),E=y(c,m,_,u,e[4],e[5]),y=y(c,m,_,u,e[6],e[7]),c=function(e,t,n,i){var r=[0,e],o=[1/3,t],s=[2/3,n],a=[1,i],t=t-(2*e+i)/3,n=n-(e+2*i)/3;i=t*n<0?[[r,o,a],[r,s,a]]:[2<=(e=t/n)?[r,o,a]:e<=.5?[r,s,a]:[r,o,s,a],[r,a]];return(t||n)<0?i.reverse():i}(x,T,E,y),m=c[0],_=c[1];if(0===w&&0===b&&0===x&&0===T&&0===E&&0===y||null==(g=R(m,_,S,C))||null==(v=R(m.reverse(),_.reverse(),S,C)))return o;var k,P,O,u=f+(p-f)*g,c=f+(p-f)*v;return Math.max(a-s,c-u)<1e-9?(k=(u+c)/2,O=(s+a)/2,M(l,h,r?i:n,r?O:k,r?n:i,r?k:O)):(e=G.getPart(e,g,v),w=a-s,o=.8<v-g?w<c-u?(k=(u+c)/2,o=I(t,(P=G.subdivide(e,.5))[0],i,n,l,h,!r,d,o,s,a,u,k),I(t,P[1],i,n,l,h,!r,d,o,s,a,k,c)):(O=(s+a)/2,o=I((P=G.subdivide(t,.5))[0],e,i,n,l,h,!r,d,o,s,O,u,c),I(P[1],e,i,n,l,h,!r,d,o,O,a,u,c)):0==w||1e-9<=w?I(t,e,i,n,l,h,!r,d,o,s,a,u,c):I(e,t,n,i,l,h,r,d,o,u,c,s,a)),o}function R(e,t,n,i){return e[0][1]<n?r(e,!0,n):t[0][1]>i?r(t,!1,i):e[0][0]}function r(e,t,n){for(var i=e[0][0],r=e[0][1],o=1,s=e.length;o<s;o++){var a=e[o][0],c=e[o][1];if(t?n<=c:c<=n)return c===n?a:i+(n-r)*(a-i)/(c-r);i=a,r=c}return null}function p(e,t,n,i,r){var o=z.isZero;if(o(i)&&o(r))return null===(o=G.getTimeOf(e,new A(t,n)))?[]:[o];for(var o=Math.atan2(-r,i),s=Math.sin(o),a=Math.cos(o),c=[],r=[],u=0;u<8;u+=2){var l=e[u]-t,h=e[u+1]-n;c.push(l*a-h*s,l*s+h*a)}return G.solveCubic(c,1,0,r,0,1),r}function _(e,t,n,i,l,h,r){for(var o=t[0],s=t[1],d=p(e,o,s,t[6]-o,t[7]-s),a=0,f=d.length;a<f;a++){var c=d[a],u=G.getPoint(e,c),u=G.getTimeOf(t,u);null!==u&&M(l,h,r?i:n,r?u:c,r?n:i,r?c:u)}}function y(e,t,n,i,r,o){var s=j.intersect(e[0],e[1],e[6],e[7],t[0],t[1],t[6],t[7]);s&&M(r,o,n,G.getTimeOf(e,s),i,G.getTimeOf(t,s))}function b(e,t,n,i,r,o){var s=Math.min,a=Math.max;if(a(e[0],e[2],e[4],e[6])+1e-12>s(t[0],t[2],t[4],t[6])&&s(e[0],e[2],e[4],e[6])-1e-12<a(t[0],t[2],t[4],t[6])&&a(e[1],e[3],e[5],e[7])+1e-12>s(t[1],t[3],t[5],t[7])&&s(e[1],e[3],e[5],e[7])-1e-12<a(t[1],t[3],t[5],t[7])){var l=w(e,t);if(l)for(var c=0;c<2;c++){var h=l[c];M(r,o,n,h[0],i,h[1],!0)}else{var s=G.isStraight(e),a=G.isStraight(t),d=s&&a,u=s&&!a,f=r.length;if((d?y:s||a?_:I)(u?t:e,u?e:t,u?i:n,u?n:i,r,o,u,0,0,0,1,0,1),!d||r.length===f)for(c=0;c<4;c++){var p=c>>1,g=1&c,v=6*p,m=6*g,v=new A(e[v],e[1+v]),m=new A(t[m],t[1+m]);v.isClose(m,1e-12)&&M(r,o,n,p,i,g)}}}return r}function C(e,t,n,i){e=G.classify(e);return"loop"===e.type&&M(n,i,t,(i=e.roots)[0],t,i[1]),n}function w(e,t){function l(e){var t=e[6]-e[0],e=e[7]-e[1];return t*t+e*e}var h=Math.abs,n=j.getDistance,i=1e-7,d=G.isStraight(e),f=G.isStraight(t),p=d&&f,r=l(e)<l(t),o=r?t:e,r=r?e:t,s=o[0],a=o[1],g=o[6]-s,v=o[7]-a;if(n(s,a,g,v,r[0],r[1],!0)<i&&n(s,a,g,v,r[6],r[7],!0)<i)!p&&n(s,a,g,v,o[2],o[3],!0)<i&&n(s,a,g,v,o[4],o[5],!0)<i&&n(s,a,g,v,r[2],r[3],!0)<i&&n(s,a,g,v,r[4],r[5],!0)<i&&(d=f=p=!0);else if(p)return null;if(d^f)return null;for(var m=[e,t],c=[],_=0;_<4&&c.length<2;_++){var u=1&_,y=1^u,w=_>>1,y=G.getTimeOf(m[u],new A(m[y][w?6:0],m[y][w?7:1]));if(null!=y&&(u=u?[w,y]:[y,w],(!c.length||1e-8<h(u[0]-c[0][0])&&1e-8<h(u[1]-c[0][1]))&&c.push(u)),2<_&&!c.length)break}return 2!==c.length?c=null:p||(o=G.getPart(e,c[0][0],c[1][0]),(h((n=G.getPart(t,c[0][1],c[1][1]))[2]-o[2])>i||h(n[3]-o[3])>i||h(n[4]-o[4])>i||h(n[5]-o[5])>i)&&(c=null)),c}return{getIntersections:function(e){var t=this.getValues(),n=e&&e!==this&&e.getValues();return n?b(t,n,this,e,[]):C(t,this,[])},statics:{getOverlaps:w,getIntersections:function(e,t,l,h,d,f){for(var n=!t,i=e.length,p=(t=n?e:t).length,r=new Array(i),o=n?r:new Array(p),s=[],a=0;a<i;a++)r[a]=e[a].getValues(h);if(!n)for(a=0;a<p;a++)o[a]=t[a].getValues(d);for(var g=V.findCurveBoundsCollisions(r,o,1e-7),c=0;c<i;c++){var v=e[c],m=r[c],u=(n&&C(m,v,s,l),g[c]);if(u)for(var _=0;_<u.length;_++){if(f&&s.length)return s;var y,w=u[_];(!n||c<w)&&(y=t[w],b(m,o[w],v,y,s,l))}}return s},getCurveLineIntersections:p,getTimesWithTangent:function(e,t){var n,i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],c=e[5],u=e[6],e=e[7],l=(t=t.normalize()).x,t=t.y,u=3*u-9*a+9*o-3*i,e=3*e-9*c+9*s-3*r,a=6*a-12*o+6*i,c=6*c-12*s+6*r,o=3*o-3*i,i=3*s-3*r,s=2*u*t-2*e*l,r=[];return Math.abs(s)<z.CURVETIME_EPSILON?0==(s=u*c-e*a)||0<=(n=-(u*i-e*o)/s)&&n<=1&&r.push(n):(n=a*t-c*l,0<=(a=(a*a-4*u*o)*t*t+(-2*a*c+4*e*o+4*u*i)*l*t+(c*c-4*e*i)*l*l)&&0!=s&&(u=(-n+(o=Math.sqrt(a)))/s,0<=(t=-(n+o)/s)&&t<=1&&r.push(t),0<=u&&u<=1&&r.push(u))),r}}}}),q=F.extend({_class:"CurveLocation",initialize:function(e,t,n,i,r){var o;.99999999<=t&&((o=e.getNext())&&(t=0,e=o)),this._setCurve(e),this._time=t,this._point=n||e.getPointAtTime(t),this._overlap=i,this._distance=r,this._intersection=this._next=this._previous=null},_setPath:function(e){this._path=e,this._version=e?e._version:0},_setCurve:function(e){this._setPath(e._path),this._curve=e,this._segment=null,this._segment1=e._segment1,this._segment2=e._segment2},_setSegment:function(e){var t=e.getCurve();t?this._setCurve(t):(this._setPath(e._path),this._segment1=e,this._segment2=null),this._segment=e,this._time=e===this._segment1?0:1,this._point=e._point.clone()},getSegment:function(){var e,t,n=this._segment;return n||(e=this.getCurve(),0===(t=this.getTime())?n=e._segment1:1===t?n=e._segment2:null!=t&&(n=e.getPartLength(0,t)<e.getPartLength(t,1)?e._segment1:e._segment2),this._segment=n),n},getCurve:function(){var e=this._path,t=this;function n(e){e=e&&e.getCurve();if(e&&null!=(t._time=e.getTimeOf(t._point)))return t._setCurve(e),e}return e&&e._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getTime:function(){var e=this.getCurve(),t=this._time;return e&&null==t?this._time=e.getTimeOf(this._point):t},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){if(null==(e=this._offset)){var e=0,t=this.getPath(),n=this.getIndex();if(t&&null!=n)for(var i=t.getCurves(),r=0;r<n;r++)e+=i[r].getLength();this._offset=e+=this.getCurveOffset()}return e},getCurveOffset:function(){var e,t,n=this._curveOffset;return null==n&&(e=this.getCurve(),t=this.getTime(),this._curveOffset=n=null!=t&&e&&e.getPartLength(0,t)),n},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(),e=e&&e.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var e=this.getCurve(),t=e._path,e=e&&e.splitAtTime(this.getTime());return e&&this._setSegment(t.getLastSegment()),e},equals:function(e,t){var n,i,r,o,s=this===e;return!s&&e instanceof q&&(n=this.getCurve(),i=e.getCurve(),(n=n._path)===i._path&&(r=(i=Math.abs)(this.getOffset()-e.getOffset()),o=!t&&this._intersection,t=!t&&e._intersection,s=(r<1e-7||n&&i(n.getLength()-r)<1e-7)&&(!o&&!t||o&&t&&o.equals(t,!0)))),s},toString:function(){var e=[],t=this.getPoint(),n=b.instance,t=(t&&e.push("point: "+t),this.getIndex()),t=(null!=t&&e.push("index: "+t),this.getTime());return null!=t&&e.push("time: "+n.number(t)),null!=this._distance&&e.push("distance: "+n.number(this._distance)),"{ "+e.join(", ")+" }"},isTouching:function(){var e,t=this._intersection;return!(!t||!this.getTangent().isCollinear(t.getTangent()))&&(e=this.getCurve(),t=t.getCurve(),!(e.isStraight()&&t.isStraight()&&e.getLine().intersect(t.getLine())))},isCrossing:function(){var e=this._intersection;if(!e)return!1;var t=this.getTime(),n=e.getTime(),i=1-1e-8,r=1e-8<=t&&t<=i,o=1e-8<=n&&n<=i;if(r&&o)return!this.isTouching();var s=this.getCurve(),l=s&&t<1e-8?s.getPrevious():s,e=e.getCurve(),a=e&&n<1e-8?e.getPrevious():e;if(i<t&&(s=s.getNext()),i<n&&(e=e.getNext()),!(l&&s&&a&&e))return!1;var h=[];function d(e,t){var e=e.getValues(),n=G.classify(e).roots||G.getPeaks(e),i=n.length,e=G.getLength(e,t&&i?n[i-1]:0,!t&&i?n[0]:1);h.push(i?e:e/32)}function c(e,t,n){return t<n?t<e&&e<n:t<e||e<n}r||(d(l,!0),d(s,!1)),o||(d(a,!0),d(e,!1));var i=this.getPoint(),u=Math.min.apply(Math,h),t=r?s.getTangentAtTime(t):s.getPointAt(u).subtract(i),s=r?t.negate():l.getPointAt(-u).subtract(i),l=o?e.getTangentAtTime(n):e.getPointAt(u).subtract(i),n=o?l.negate():a.getPointAt(-u).subtract(i),e=s.getAngle(),o=t.getAngle(),a=n.getAngle(),u=l.getAngle();return!!(r?c(e,a,u)^c(o,a,u)&&c(e,u,a)^c(o,u,a):c(a,e,o)^c(u,e,o)&&c(a,o,e)^c(u,o,e))},hasOverlap:function(){return!!this._overlap}},F.each(G._evaluateMethods,function(e){var n=e+"At";this[e]=function(){var e=this.getCurve(),t=this.getTime();return null!=t&&e&&e[n](t,!0)}},{preserve:!0}),new function(){function i(r,o,l){var s=r.length,e=0,t=s-1;function n(e,t){for(var n=e+t;-1<=n&&n<=s;n+=t){var i=r[(n%s+s)%s];if(!o.getPoint().isClose(i.getPoint(),1e-7))break;if(o.equals(i))return i}return null}for(;e<=t;){var i,a=e+t>>>1,c=r[a];if(l&&(i=o.equals(c)?c:n(a,-1)||n(a,1)))return o._overlap&&(i._overlap=i._intersection._overlap=!0),i;var u=o.getPath(),h=c.getPath();(u!==h?u._id-h._id:o.getIndex()+o.getTime()-(c.getIndex()+c.getTime()))<0?t=a-1:e=1+a}return r.splice(e,0,o),o}return{statics:{insert:i,expand:function(e){for(var t=e.slice(),n=e.length-1;0<=n;n--)i(t,e[n]._intersection,!1);return t}}}}),T=U.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(e){var t,n,i;return F.isPlainObject(e)?(n=e.segments,t=e.pathData):Array.isArray(e)?n=e:"string"==typeof e&&(t=e),n?i=(n=n[0])&&Array.isArray(n[0]):t&&(i=1<(t.match(/m/gi)||[]).length||/z\s*\S+/i.test(t)),new(i?J:W)(e)}},_asPathItem:function(){return this},isClockwise:function(){return 0<=this.getArea()},setClockwise:function(e){this.isClockwise()!=(e=!!e)&&this.reverse()},setPathData:function(l){var e,t,n=l&&l.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),h=!1,i=new A,d=new A;function r(e,t){e=+s[e];return h&&(e+=i[t]),e}function o(e){return new A(r(e,"x"),r(e+1,"y"))}this.clear();for(var f=0,p=n&&n.length;f<p;f++){var s,g=n[f],v=g[0],a=v.toLowerCase(),c=(s=g.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&s.length,h=v===a;switch("z"!==e||/[mz]/.test(a)||this.moveTo(i),a){case"m":case"l":for(var m="m"===a,u=0;u<c;u+=2)this[m?"moveTo":"lineTo"](i=o(u)),m&&(d=i,m=!1);t=i;break;case"h":case"v":for(var _="h"===a?"x":"y",i=i.clone(),u=0;u<c;u++)i[_]=r(u,_),this.lineTo(i);t=i;break;case"c":for(u=0;u<c;u+=6)this.cubicCurveTo(o(u),t=o(u+2),i=o(u+4));break;case"s":for(u=0;u<c;u+=4)this.cubicCurveTo(/[cs]/.test(e)?i.multiply(2).subtract(t):i,t=o(u),i=o(u+2)),e=a;break;case"q":for(u=0;u<c;u+=4)this.quadraticCurveTo(t=o(u),i=o(u+2));break;case"t":for(u=0;u<c;u+=2)this.quadraticCurveTo(t=/[qt]/.test(e)?i.multiply(2).subtract(t):i,i=o(u)),e=a;break;case"a":for(u=0;u<c;u+=7)this.arcTo(i=o(u+5),new I(+s[u],+s[u+1]),+s[u+2],+s[u+4],+s[u+3]);break;case"z":this.closePath(1e-12),i=d}e=a}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(e){e=e.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(e):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(e,t,n,i){var r=this===e||!e,o=this._matrix._orNullIfIdentity(),n=r?o:(n||e._matrix)._orNullIfIdentity();return r||this.getBounds(o).intersects(e.getBounds(n),1e-12)?G.getIntersections(this.getCurves(),!r&&e.getCurves(),t,o,n,i):[]},getCrossings:function(e){return this.getIntersections(e,function(e){return e.isCrossing()})},getNearestLocation:function(){for(var e=A.read(arguments),t=this.getCurves(),n=1/0,i=null,r=0,o=t.length;r<o;r++){var s=t[r].getNearestLocation(e);s._distance<n&&(n=s._distance,i=s)}return i},getNearestPoint:function(){var e=this.getNearestLocation.apply(this,arguments);return e&&e.getPoint()},interpolate:function(e,t,n){var i=!this._children,r=i?"_segments":"_children",o=e[r],s=t[r],a=this[r];if(!o||!s||o.length!==s.length)throw new Error("Invalid operands in interpolate() call: "+e+", "+t);var r=a.length,c=s.length;if(r<c)for(var l=i?H:W,u=r;u<c;u++)this.add(new l);else c<r&&this[i?"removeSegments":"removeChildren"](c,r);for(u=0;u<c;u++)a[u].interpolate(o[u],s[u],n);i&&(this.setClosed(e._closed),this._changed(9))},compare:function(e){var t=!1;if(e){for(var n=this._children||[this],i=e._children?e._children.slice():[e],e=n.length,r=i.length,o=[],s=0,l=(t=!0,V.findItemBoundsCollisions(n,i,z.GEOMETRIC_EPSILON)),a=e-1;0<=a&&t;a--){var h=n[a],t=!1,c=l[a];if(c)for(var u=c.length-1;0<=u&&!t;u--)h.compare(i[c[u]])&&(o[c[u]]||(o[c[u]]=!0,s++),t=!0)}t=t&&s===r}return t}}),W=T.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(e){this._closed=!1,this._segments=[],this._version=0;var t=arguments,t=Array.isArray(e)?"object"==typeof e[0]?e:t:!e||e.size!==B||e.x===B&&e.point===B?null:t;t&&0<t.length?this.setSegments(t):(this._curves=B,this._segmentSelection=0,t||"string"!=typeof e||(this.setPathData(e),e=null)),this._initialize(!t&&e)},_equals:function(e){return this._closed===e._closed&&F.equals(this._segments,e._segments)},copyContent:function(e){this.setSegments(e._segments),this._closed=e._closed},_changed:function e(t){if(e.base.call(this,t),8&t){if(this._length=this._area=B,32&t)this._version++;else if(this._curves)for(var n=0,i=this._curves.length;n<i;n++)this._curves[n]._changed()}else 64&t&&(this._bounds=B)},getStyle:function(){var e=this._parent;return(e instanceof J?e:this)._style},getSegments:function(){return this._segments},setSegments:function(e){var t,n=this.isFullySelected(),i=e&&e.length;this._segments.length=0,this._segmentSelection=0,this._curves=B,i&&("boolean"==typeof(t=e[i-1])&&(this.setClosed(t),i--),this._add(H.readList(e,0,{},i))),n&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,t=this._segments;if(!e)for(var n=this._countCurves(),e=this._curves=new Array(n),i=0;i<n;i++)e[i]=new G(this,t[i],t[i+1]||t[0]);return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},isClosed:function(){return this._closed},setClosed:function(e){var t;this._closed!=(e=!!e)&&(this._closed=e,this._curves&&(t=this._curves.length=this._countCurves(),e&&(this._curves[t-1]=new G(this,this._segments[t-1],this._segments[0]))),this._changed(41))}},{beans:!0,getPathData:function(d,e){var n,i,r,o,s,a,c,f,t=this._segments,p=t.length,u=new b(e),l=new Array(6),g=!0,h=[];function v(e,t){e._transformCoordinates(d,l),n=l[0],i=l[1],g?(h.push("M"+u.pair(n,i)),g=!1):(s=l[2],a=l[3],s===n&&a===i&&c===r&&f===o?t||(e=n-r,t=i-o,h.push(0==e?"v"+u.number(t):0==t?"h"+u.number(e):"l"+u.pair(e,t))):h.push("c"+u.pair(c-r,f-o)+" "+u.pair(s-r,a-o)+" "+u.pair(n-r,i-o))),r=n,o=i,c=l[4],f=l[5]}if(!p)return"";for(var m=0;m<p;m++)v(t[m]);return this._closed&&0<p&&(v(t[0],!0),h.push("z")),h.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(e){for(var t=this._segments,n=new Array(6),i=0,r=t.length;i<r;i++)t[i]._transformCoordinates(e,n,!0);return!0},_add:function(e,t){for(var n=this._segments,i=this._curves,r=e.length,o=null==t,t=o?n.length:t,s=0;s<r;s++){var a=e[s];(a=a._path?e[s]=a.clone():a)._path=this,a._index=t+s,a._selection&&this._updateSelection(a,0,a._selection)}if(o)F.push(n,e);else{n.splice.apply(n,[t,0].concat(e));for(var s=t+r,l=n.length;s<l;s++)n[s]._index=s}if(i){var o=this._countCurves(),c=0<t&&t+r-1===o?t-1:t,u=c,h=Math.min(c+r,o);e._curves&&(i.splice.apply(i,[c,0].concat(e._curves)),u+=e._curves.length);for(s=u;s<h;s++)i.splice(s,0,new G(this,null,null));this._adjustCurves(c,h)}return this._changed(41),e},_adjustCurves:function(e,t){for(var n,i=this._segments,r=this._curves,o=e;o<t;o++)(n=r[o])._path=this,n._segment1=i[o],n._segment2=i[o+1]||i[0],n._changed();(n=r[this._closed&&!e?i.length-1:e-1])&&(n._segment2=i[e]||i[0],n._changed()),(n=r[t])&&(n._segment1=i[t],n._changed())},_countCurves:function(){var e=this._segments.length;return!this._closed&&0<e?e-1:e},add:function(e){var t=arguments;return 1<t.length&&"number"!=typeof e?this._add(H.readList(t)):this._add([H.read(t)])[0]},insert:function(e,t){var n=arguments;return 2<n.length&&"number"!=typeof t?this._add(H.readList(n,1),e):this._add([H.read(n,1)],e)[0]},addSegment:function(){return this._add([H.read(arguments)])[0]},insertSegment:function(e){return this._add([H.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(H.readList(e))},insertSegments:function(e,t){return this._add(H.readList(t),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(e,t,n){e=e||0,t=F.pick(t,this._segments.length);var i=this._segments,r=this._curves,o=i.length,s=i.splice(e,t-e),a=s.length;if(!a)return s;for(var c=0;c<a;c++){var u=s[c];u._selection&&this._updateSelection(u,u._selection,0),u._index=u._path=null}for(var c=e,l=i.length;c<l;c++)i[c]._index=c;if(r){for(t=0<e&&t===o+(this._closed?1:0)?e-1:e,c=(r=r.splice(t,a)).length-1;0<=c;c--)r[c]._path=null;n&&(s._curves=r.slice(1)),this._adjustCurves(t,t)}return this._changed(41),s},clear:"#removeSegments",hasHandles:function(){for(var e=this._segments,t=0,n=e.length;t<n;t++)if(e[t].hasHandles())return!0;return!1},clearHandles:function(){for(var e=this._segments,t=0,n=e.length;t<n;t++)e[t].clearHandles()},getLength:function(){if(null==this._length){for(var e=this.getCurves(),t=0,n=0,i=e.length;n<i;n++)t+=e[n].getLength();this._length=t}return this._length},getArea:function(){if(null==(n=this._area)){for(var e=this._segments,t=this._closed,n=0,i=0,r=e.length;i<r;i++){var o=i+1===r;n+=G.getArea(G.getValues(e[i],e[o?0:i+1],null,o&&!t))}this._area=n}return n},isFullySelected:function(){var e=this._segments.length;return this.isSelected()&&0<e&&this._segmentSelection===7*e},setFullySelected:function(e){e&&this._selectSegments(!0),this.setSelected(e)},setSelection:function e(t){1&t||this._selectSegments(!1),e.base.call(this,t)},_selectSegments:function(e){var t=this._segments,n=t.length,i=e?7:0;this._segmentSelection=i*n;for(var r=0;r<n;r++)t[r]._selection=i},_updateSelection:function(e,t,n){e._selection=n,0<(this._segmentSelection+=n-t)&&this.setSelected(!0)},divideAt:function(e){var t,e=this.getLocationAt(e);return e&&(t=e.getCurve().divideAt(e.getCurveOffset()))?t._segment1:null},splitAt:function(e){var t,e=this.getLocationAt(e),n=e&&e.index,e=e&&e.time,i=(1-1e-8<e&&(n++,e=0),this.getCurves());return 0<=n&&n<i.length?(1e-8<=e&&i[n++].divideAtTime(e),i=this.removeSegments(n,this._segments.length,!0),this._closed?(this.setClosed(!1),t=this):((t=new W(U.NO_INSERT)).insertAbove(this),t.copyAttributes(this)),t._add(i,0),this.addSegment(i[0]),t):null},split:function(e,t){e=t===B?e:(e=this.getCurves()[e])&&e.getLocationAtTime(t);return null!=e?this.splitAt(e):null},join:function(e,t){t=t||0;if(e&&e!==this){var n=e._segments,i=this.getLastSegment(),r=e.getLastSegment();if(!r)return this;i&&i._point.isClose(r._point,t)&&e.reverse();var o=e.getFirstSegment();i&&i._point.isClose(o._point,t)?(i.setHandleOut(o._handleOut),this._add(n.slice(1))):((i=this.getFirstSegment())&&i._point.isClose(o._point,t)&&e.reverse(),r=e.getLastSegment(),i&&i._point.isClose(r._point,t)?(i.setHandleIn(r._handleIn),this._add(n.slice(0,n.length-1),0)):this._add(n.slice())),e._closed&&this._add([n[0]]),e.remove()}o=this.getFirstSegment(),i=this.getLastSegment();return o!==i&&o._point.isClose(i._point,t)&&(o.setHandleIn(i._handleIn),i.remove(),this.setClosed(!0)),this},reduce:function(e){for(var t=this.getCurves(),n=e&&e.simplify,i=n?1e-7:0,r=t.length-1;0<=r;r--){var o=t[r];!o.hasHandles()&&(!o.hasLength(i)||n&&o.isCollinear(o.getNext()))&&o.remove()}return this},reverse:function(){this._segments.reverse();for(var e=0,t=this._segments.length;e<t;e++){var n=this._segments[e],i=n._handleIn;n._handleIn=n._handleOut,n._handleOut=i,n._index=e}this._curves=null,this._changed(9)},flatten:function(e){for(var t=new E(this,e||.25,256,!0).parts,n=t.length,i=[],r=0;r<n;r++)i.push(new H(t[r].curve.slice(0,2)));!this._closed&&0<n&&i.push(new H(t[n-1].curve.slice(6))),this.setSegments(i)},simplify:function(e){e=new k(this).fit(e||2.5);return e&&this.setSegments(e),!!e},smooth:function(e){var l=this,t=e||{},e=t.type||"asymmetric",h=this._segments,r=h.length,d=this._closed;function f(e,t){var n=e&&e.index;if(null!=n){var i=e.path;if(i&&i!==l)throw new Error(e._class+" "+n+" of "+i+" is not part of "+l);t&&e instanceof G&&n++}else n="number"==typeof e?e:t;return Math.min(n<0&&d?n%r:n<0?n+r:n,r-1)}var p=d&&t.from===B&&t.to===B,n=f(t.from,0),i=f(t.to,r-1);if(i<n&&(d?n-=r:(v=n,n=i,i=v)),/^(?:asymmetric|continuous)$/.test(e)){var g="asymmetric"===e,v=Math.min,e=i-n+1,o=e-1,e=p?v(e,4):1,m=e,s=[];if(d||(m=v(1,n),e=v(1,r-i-1)),!((o+=m+e)<=1)){for(var a=0,c=n-m;a<=o;a++,c++)s[a]=h[(c<0?c+r:c)%r]._point;for(var u=o-1,_=[P=s[0]._x+2*s[1]._x],y=[O=s[0]._y+2*s[1]._y],w=[k=2],b=[],C=[],a=1;a<o;a++)var S=a<u,x=S?4:g?3:8,T=S?2:g?0:1,E=(S||g?1:2)/k,k=w[a]=(S?4:g?2:7)-E,P=_[a]=x*s[a]._x+T*s[a+1]._x-E*P,O=y[a]=x*s[a]._y+T*s[a+1]._y-E*O;b[u]=_[u]/w[u],C[u]=y[u]/w[u];for(a=o-2;0<=a;a--)b[a]=(_[a]-b[a+1])/w[a],C[a]=(y[a]-C[a+1])/w[a];b[o]=(3*s[o]._x-b[u])/2,C[o]=(3*s[o]._y-C[u])/2;for(var a=m,M=o-e,c=n;a<=M;a++,c++){var I=h[c<0?c+r:c],R=I._point,A=b[a]-R._x,R=C[a]-R._y;(p||a<M)&&I.setHandleOut(A,R),(p||m<a)&&I.setHandleIn(-A,-R)}}}else for(a=n;a<=i;a++)h[a<0?a+r:a].smooth(t,!p&&a===n,!p&&a===i)},toShape:function(l){if(!this._closed)return null;var e,t,h,n,i,r,o,s=this._segments;function a(e,t){var e=s[e],n=e.getNext(),t=s[t],i=t.getNext();return e._handleOut.isZero()&&n._handleIn.isZero()&&t._handleOut.isZero()&&i._handleIn.isZero()&&n._point.subtract(e._point).isCollinear(i._point.subtract(t._point))}function c(e){var t,e=s[e],n=e.getNext(),i=e._handleOut,r=n._handleIn,o=.5522847498307936;if(i.isOrthogonal(r))return e=e._point,n=n._point,(t=new j(e,i,!0).intersect(new j(n,r,!0),!0))&&z.isZero(i.getLength()/t.subtract(e).getLength()-o)&&z.isZero(r.getLength()/t.subtract(n).getLength()-o)}function u(e,t){return s[e]._point.getDistance(s[t]._point)}return!this.hasHandles()&&4===s.length&&a(0,2)&&a(1,3)&&(r=(i=s[i=1]).getPrevious(),o=i.getNext(),r._handleOut.isZero()&&i._handleIn.isZero()&&i._handleOut.isZero()&&o._handleIn.isZero()&&i._point.subtract(r._point).isOrthogonal(o._point.subtract(i._point)))?(e=_.Rectangle,t=new I(u(0,3),u(0,1)),n=s[1]._point.add(s[2]._point).divide(2)):8===s.length&&c(0)&&c(2)&&c(4)&&c(6)&&a(1,5)&&a(3,7)?(e=_.Rectangle,h=(t=new I(u(1,6),u(0,3))).subtract(new I(u(0,7),u(1,2))).divide(2),n=s[3]._point.add(s[4]._point).divide(2)):4===s.length&&c(0)&&c(1)&&c(2)&&c(3)&&(h=z.isZero(u(0,2)-u(1,3))?(e=_.Circle,u(0,2)/2):(e=_.Ellipse,new I(u(2,0)/2,u(3,1)/2)),n=s[1]._point),e?((o=new e({center:r=this.getPosition(!0),size:t,radius:h,insert:!1})).copyAttributes(this,!0),o._matrix.prepend(this._matrix),o.rotate(n.subtract(r).getAngle()+90),l!==B&&!l||o.insertAbove(this),o):null},toPath:"#clone",compare:function l(e){if(!e||e instanceof J)return l.base.call(this,e);var t=this.getCurves(),h=e.getCurves(),d=t.length,n=h.length;if(!d||!n)return d==n;for(var i,r,o=t[0].getValues(),f=[],p=0,g=0,s=0;s<n;s++){var a=h[s].getValues();if(f.push(a),u=G.getOverlaps(o,a)){i=!s&&0<u[0][0]?n-1:s,r=u[0][1];break}}for(var c,v=Math.abs,a=f[i];o&&a;){var u=G.getOverlaps(o,a);if(u)if(v(u[0][0]-g)<1e-8){1===(g=u[1][0])&&(o=++p<d?t[p].getValues():null,g=0);var m=u[0][1];if(v(m-r)<1e-8){if(c=c||[i,m],1===(r=u[1][1])&&(a=f[i=++i>=n?0:i]||h[i].getValues(),r=0),!o)return c[0]===i&&c[1]===r;continue}}break}return!1},_hitTestSelf:function(n,r,l,h){var i,o,d,s,f,e,p=this,t=this.getStyle(),g=this._segments,a=g.length,v=this._closed,m=r._tolerancePadding,_=m,y=r.stroke&&t.hasStroke(),w=r.fill&&t.hasFill(),b=r.curves,c=y?t.getStrokeWidth()/2:w&&0<r.tolerance||b?0:null;function C(e,t){return n.subtract(e).divide(t).length<=1}function S(e,t,n){if(!r.selected||t.isSelected()){var i=e._point;if(C(t=t!==i?t.add(i):t,_))return new L(n,p,{segment:e,point:t})}}function x(e,t){return(t||r.segments)&&S(e,e._point,"segment")||!t&&r.handles&&(S(e,e._handleIn,"handle-in")||S(e,e._handleOut,"handle-out"))}function T(e){s.add(e)}function E(e){var t=v||0<e._index&&e._index<a-1;return"round"===(t?i:o)?C(e._point,_):(s=new W({internal:!0,closed:!0}),t?e.isSmooth()||W._addBevelJoin(e,i,c,d,null,h,T,!0):"square"===o&&W._addSquareCap(e,o,c,null,h,T,!0),!s.isEmpty()&&(s.contains(n)||(t=s.getNearestLocation(n))&&C(t.getPoint(),m)))}if(null!==c&&(0<c?(i=t.getStrokeJoin(),o=t.getStrokeCap(),d=t.getMiterLimit(),_=_.add(W._getStrokePadding(c,h))):i=o="round"),!r.ends||r.segments||v){if(r.segments||r.handles)for(var u=0;u<a;u++)if(f=x(g[u]))return f}else if(f=x(g[0],!0)||x(g[a-1],!0))return f;if(null!==c&&((e=this.getNearestLocation(n))&&(0===(t=e.getTime())||1===t&&1<a?E(e.getSegment())||(e=null):C(e.getPoint(),_)||(e=null)),!e&&"miter"===i&&1<a))for(u=0;u<a;u++){var k=g[u];if(n.getDistance(k._point)<=d*c&&E(k)){e=k.getLocation();break}}return!e&&w&&this._contains(n)||e&&!y&&!b?new L("fill",this):e?new L(y?"stroke":"curve",this,{location:e,point:e.getPoint()}):null}},F.each(G._evaluateMethods,function(t){this[t+"At"]=function(e){e=this.getLocationAt(e);return e&&e[t]()}},{beans:!1,getLocationOf:function(){for(var e=A.read(arguments),t=this.getCurves(),n=0,i=t.length;n<i;n++){var r=t[n].getLocationOf(e);if(r)return r}return null},getOffsetOf:function(){var e=this.getLocationOf.apply(this,arguments);return e?e.getOffset():null},getLocationAt:function(e){if("number"==typeof e){for(var t=this.getCurves(),n=0,i=0,r=t.length;i<r;i++){var o=n,s=t[i];if(e<(n+=s.getLength()))return s.getLocationAt(e-o)}if(0<t.length&&e<=this.getLength())return new q(t[t.length-1],1)}else if(e&&e.getPath&&e.getPath()===this)return e;return null},getOffsetsWithTangent:function(){var e=A.read(arguments);if(e.isZero())return[];for(var t=[],n=0,i=this.getCurves(),r=0,u=i.length;r<u;r++){for(var o=i[r],s=o.getTimesWithTangent(e),a=0,l=s.length;a<l;a++){var c=n+o.getOffsetAtTime(s[a]);t.indexOf(c)<0&&t.push(c)}n+=o.length}return t}}),new function(){function m(i,e,r){var o,s,a,c,u,l,h,f,t=e._segments,n=t.length,d=new Array(6),p=!0;function g(e){var t,n;s=r?(e._transformCoordinates(r,d),o=d[0],d[1]):(t=e._point,o=t._x,t._y),p?(i.moveTo(o,s),p=!1):(l=r?(u=d[2],d[3]):(n=e._handleIn,u=o+n._x,s+n._y),u===o&&l===s&&h===a&&f===c?i.lineTo(o,s):i.bezierCurveTo(h,f,u,l,o,s)),a=o,c=s,f=r?(h=d[4],d[5]):(n=e._handleOut,h=a+n._x,c+n._y)}for(var v=0;v<n;v++)g(t[v]);e._closed&&0<n&&g(t[0])}return{_draw:function(e,t,l,h){var d=t.dontStart,f=t.dontFinish||t.clip,n=this.getStyle(),i=n.hasFill(),r=n.hasStroke(),p=n.getDashArray(),o=!P.support.nativeDash&&r&&p&&p.length;function s(e){return p[(e%o+o)%o]}if(d||e.beginPath(),(i||r&&!o||f)&&(m(e,this,h),this._closed&&e.closePath()),!f&&(i||r)&&(this._setStyles(e,t,l),i&&(e.fill(n.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),r)){if(o){d||e.beginPath();for(var a,g=new E(this,.25,32,!1,h),v=g.length,c=-n.getDashOffset(),u=0;0<c;)c-=s(u--)+s(u--);for(;c<v;)a=c+s(u++),(0<c||0<a)&&g.drawPart(e,Math.max(c,0),Math.max(a,0)),c=a+s(u++)}e.stroke()}},_drawSelected:function(e,l){e.beginPath(),m(e,this,l),e.stroke();var n=e,h=this._segments,d=l,t=P.settings.handleSize;if(!(t<=0))for(var i,r,o=t/2,s=t-2,f=o-1,a=new Array(6),c=0,p=h.length;c<p;c++){var u=h[c],g=u._selection;u._transformCoordinates(d,a),i=a[0],r=a[1],2&g&&v(2),4&g&&v(4),n.fillRect(i-o,r-o,t,t),0<s&&!(1&g)&&(u=n.fillStyle,n.fillStyle="#ffffff",n.fillRect(i-f,r-f,s,s),n.fillStyle=u)}function v(e){var t=a[e],e=a[e+1];i==t&&r==e||(n.beginPath(),n.moveTo(i,r),n.lineTo(t,e),n.stroke(),n.beginPath(),n.arc(t,e,o,0,2*Math.PI,!0),n.fill())}}}},new function(){function M(e){e=e._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var e=this._segments;1===e.length&&this.removeSegment(0),e.length||this._add([new H(A.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new H(A.read(arguments))])},cubicCurveTo:function(){var e=arguments,t=A.read(e),n=A.read(e),e=A.read(e),i=M(this);i.setHandleOut(t.subtract(i._point)),this._add([new H(e,n.subtract(e))])},quadraticCurveTo:function(){var e=arguments,t=A.read(e),e=A.read(e),n=M(this)._point;this.cubicCurveTo(t.add(n.subtract(t).multiply(1/3)),t.add(e.subtract(t).multiply(1/3)),e)},curveTo:function(){var e=arguments,t=A.read(e),n=A.read(e),e=F.pick(F.read(e),.5),i=1-e,r=M(this)._point,t=t.subtract(r.multiply(i*i)).subtract(n.multiply(e*e)).divide(2*e*i);if(t.isNaN())throw new Error("Cannot put a curve through points with parameter = "+e);this.quadraticCurveTo(t,n)},arcTo:function(){var e,t=arguments,l=Math.abs,h=Math.sqrt,d=M(this),n=d._point,i=A.read(t),f=F.peek(t);if("boolean"==typeof(f=F.pick(f,!0)))var r=(g=n.add(i).divide(2)).add(g.subtract(n).rotate(f?-90:90));else if(F.remain(t)<=2)r=i,i=A.read(t);else if(!n.equals(i)){var o=I.read(t),p=z.isZero;if(p(o.width)||p(o.height))return this.lineTo(i);var p=F.read(t),f=!!F.read(t),t=!!F.read(t),g=n.add(i).divide(2),v=(P=n.subtract(g).rotate(-p)).x,m=P.y,s=l(o.width),o=l(o.height),a=s*s,_=o*o,y=v*v,w=m*m,c=h(y/a+w/_);if(1<c&&(a=(s*=c)*s,_=(o*=c)*o),(c=l(c=(a*_-a*w-_*y)/(a*w+_*y))<1e-12?0:c)<0)throw new Error("Cannot create an arc with the given arguments");b=new A(s*m/o,-o*v/s).multiply((t===f?-1:1)*h(c)).rotate(p).add(g),a=(u=(e=(new R).translate(b).rotate(p).scale(s,o))._inverseTransform(n)).getDirectedAngle(e._inverseTransform(i)),!f&&0<a?a-=360:f&&a<0&&(a+=360)}if(r){var b,w=new j(n.add(r).divide(2),r.subtract(n).rotate(90),!0),_=new j(r.add(i).divide(2),i.subtract(r).rotate(90),!0),y=new j(n,i),m=y.getSide(r);if(!(b=w.intersect(_,!0))){if(!m)return this.lineTo(i);throw new Error("Cannot create an arc with the given arguments")}var u,a=(u=n.subtract(b)).getDirectedAngle(i.subtract(b)),v=y.getSide(b,!0);0===v?a=m*l(a):m===v&&(a+=a<0?360:-360)}if(a){for(var t=l(a),C=360<=t?4:Math.ceil((t-1e-7)/90),S=a/C,h=S*Math.PI/360,x=4/3*Math.sin(h)/(1+Math.cos(h)),T=[],E=0;E<=C;E++){var k,P=i,O=null;E<C&&(O=u.rotate(90).multiply(x),e?(P=e._transformPoint(u),O=e._transformPoint(u.add(O)).subtract(P)):P=b.add(u)),E?(k=u.rotate(-90).multiply(x),e&&(k=e._transformPoint(u.add(k)).subtract(P)),T.push(new H(P,k,O))):d.setHandleOut(O),u=u.rotate(S)}this._add(T)}},lineBy:function(){var e=A.read(arguments),t=M(this)._point;this.lineTo(t.add(e))},curveBy:function(){var e=arguments,t=A.read(e),n=A.read(e),e=F.read(e),i=M(this)._point;this.curveTo(i.add(t),i.add(n),e)},cubicCurveBy:function(){var e=arguments,t=A.read(e),n=A.read(e),e=A.read(e),i=M(this)._point;this.cubicCurveTo(i.add(t),i.add(n),i.add(e))},quadraticCurveBy:function(){var e=arguments,t=A.read(e),e=A.read(e),n=M(this)._point;this.quadraticCurveTo(n.add(t),n.add(e))},arcBy:function(){var e=arguments,t=M(this)._point,n=t.add(A.read(e)),i=F.pick(F.peek(e),!0);"boolean"==typeof i?this.arcTo(n,i):this.arcTo(n,t.add(A.read(e)))},closePath:function(e){this.setClosed(!0),this.join(this,e)}}},{_getBounds:function(e,t){var n=t.handle?"getHandleBounds":t.stroke?"getStrokeBounds":"getBounds";return W[n](this._segments,this._closed,this,e,t)},statics:{getBounds:function(e,l,h,n,d,i){var t=e[0];if(!t)return new C;var r=new Array(6),o=t._transformCoordinates(n,new Array(6)),s=o.slice(0,2),a=s.slice(),f=new Array(2);function c(e){e._transformCoordinates(n,r);for(var t=0;t<2;t++)G._addBounds(o[t],o[t+4],r[t+2],r[t],t,i?i[t]:0,s,a,f);e=o;o=r,r=e}for(var u=1,p=e.length;u<p;u++)c(e[u]);return l&&c(t),new C(s[0],s[1],a[0]-s[0],a[1]-s[1])},getStrokeBounds:function(e,t,n,i,r){var o=n.getStyle(),s=o.hasStroke(),l=o.getStrokeWidth(),a=s&&n._getStrokeMatrix(i,r),h=s&&W._getStrokePadding(l,a),c=W.getBounds(e,t,n,i,r,h);if(!s)return c;var d=l/2,f=o.getStrokeJoin(),n=o.getStrokeCap(),p=o.getMiterLimit(),g=new C(new I(h));function v(e){c=c.include(e)}function m(e){c=c.unite(g.setCenter(e._point.transform(i)))}function _(e,t){"round"===t||e.isSmooth()?m(e):W._addBevelJoin(e,t,d,p,i,a,v)}function y(e,t){"round"===t?m(e):W._addSquareCap(e,t,d,i,a,v)}var w=e.length-(t?0:1);if(0<w){for(var u=1;u<w;u++)_(e[u],f);t?_(e[0],f):(y(e[0],n),y(e[e.length-1],n))}return c},_getStrokePadding:function(e,t){if(!t)return[e,e];var n=new A(e,0).transform(t),e=new A(0,e).transform(t),t=n.getAngleInRadians(),n=n.getLength(),e=e.getLength(),i=Math.sin(t),r=Math.cos(t),t=Math.tan(t),o=Math.atan2(e*t,n),t=Math.atan2(e,t*n);return[Math.abs(n*Math.cos(o)*r+e*Math.sin(o)*i),Math.abs(e*Math.sin(t)*r+n*Math.cos(t)*i)]},_addBevelJoin:function(e,t,n,i,r,o,s,a){var e=e.getCurve(),c=e.getPrevious(),r=e.getPoint1().transform(r),c=c.getNormalAtTime(1).multiply(n).transform(o),e=e.getNormalAtTime(0).multiply(n).transform(o),o=c.getDirectedAngle(e);(o<0||180<=o)&&(c=c.negate(),e=e.negate()),a&&s(r),s(r.add(c)),"miter"!==t||(o=new j(r.add(c),new A(-c.y,c.x),!0).intersect(new j(r.add(e),new A(-e.y,e.x),!0),!0))&&r.getDistance(o)<=i*n&&s(o),s(r.add(e))},_addSquareCap:function(e,t,n,i,r,o,s){i=e._point.transform(i),e=e.getLocation(),e=e.getNormal().multiply(0===e.getTime()?n:-n).transform(r);"square"===t&&(s&&(o(i.subtract(e)),o(i.add(e))),i=i.add(e.rotate(-90))),o(i.add(e)),o(i.subtract(e))},getHandleBounds:function(l,h,e,d,t){for(var f,p,n,i=e.getStyle(),g=(t.stroke&&i.hasStroke()&&(e=e._getStrokeMatrix(d,t),n=t=i.getStrokeWidth()/2,"miter"===i.getStrokeJoin()&&(n=t*i.getMiterLimit()),"square"===i.getStrokeCap()&&(n=Math.max(n,t*Math.SQRT2)),f=W._getStrokePadding(t,e),p=W._getStrokePadding(n,e)),new Array(6)),r=1/0,o=-r,s=r,v=o,m=0,_=l.length;m<_;m++){l[m]._transformCoordinates(d,g);for(var a=0;a<6;a+=2){var c=a?f:p,u=c?c[0]:0,c=c?c[1]:0,y=g[a],w=g[a+1],b=y-u,y=y+u,u=w-c,w=w+c;b<r&&(r=b),o<y&&(o=y),u<s&&(s=u),v<w&&(v=w)}}return new C(r,s,o-r,v-s)}}}),J=(W.inject({statics:new function(){var u=.5522847498307936,s=[new H([-1,0],[0,u],[0,-u]),new H([0,-1],[-u,0],[u,0]),new H([1,0],[0,-u],[0,u]),new H([0,1],[u,0],[-u,0])];function l(e,t,n){var n=F.getNamed(n),i=new W(n&&0==n.insert&&U.NO_INSERT);return i._add(e),i._closed=t,i.set(n,{insert:!0})}function i(e,t,n){for(var i=new Array(4),r=0;r<4;r++){var o=s[r];i[r]=new H(o._point.multiply(t).add(e),o._handleIn.multiply(t),o._handleOut.multiply(t))}return l(i,!0,n)}return{Line:function(){var e=arguments;return l([new H(A.readNamed(e,"from")),new H(A.readNamed(e,"to"))],!1,e)},Circle:function(){var e=arguments,t=A.readNamed(e,"center"),n=F.readNamed(e,"radius");return i(t,new I(n),e)},Rectangle:function(){var e,t,n=arguments,i=C.readNamed(n,"rectangle"),r=I.readNamed(n,"radius",0,{readNull:!0}),o=i.getBottomLeft(!0),s=i.getTopLeft(!0),a=i.getTopRight(!0),c=i.getBottomRight(!0);return l(!r||r.isZero()?[new H(o),new H(s),new H(a),new H(c)]:(i=(r=I.min(r,i.getSize(!0).divide(2))).width,r=r.height,e=i*u,t=r*u,[new H(o.add(i,0),null,[-e,0]),new H(o.subtract(0,r),[0,t]),new H(s.add(0,r),null,[0,-t]),new H(s.add(i,0),[-e,0],null),new H(a.subtract(i,0),null,[e,0]),new H(a.add(0,r),[0,-t],null),new H(c.subtract(0,r),null,[0,t]),new H(c.subtract(i,0),[e,0])]),!0,n)},RoundRectangle:"#Rectangle",Ellipse:function(){var e=arguments,t=_._readEllipse(e);return i(t.center,t.radius,e)},Oval:"#Ellipse",Arc:function(){var e=arguments,t=A.readNamed(e,"from"),n=A.readNamed(e,"through"),i=A.readNamed(e,"to"),e=F.getNamed(e),r=new W(e&&0==e.insert&&U.NO_INSERT);return r.moveTo(t),r.arcTo(n,i),r.set(e)},RegularPolygon:function(){for(var e=arguments,t=A.readNamed(e,"center"),n=F.readNamed(e,"sides"),i=F.readNamed(e,"radius"),r=360/n,o=n%3==0,s=new A(0,o?-i:i),u=o?-1:.5,a=new Array(n),c=0;c<n;c++)a[c]=new H(t.add(s.rotate((c+u)*r)));return l(a,!0,e)},Star:function(){for(var e=arguments,t=A.readNamed(e,"center"),n=2*F.readNamed(e,"points"),i=F.readNamed(e,"radius1"),r=F.readNamed(e,"radius2"),o=360/n,s=new A(0,-1),a=new Array(n),c=0;c<n;c++)a[c]=new H(t.add(s.rotate(o*c).multiply(c%2?r:i)));return l(a,!0,e)}}}}),T.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(e){this._children=[],this._namedChildren={},this._initialize(e)||("string"==typeof e?this.setPathData(e):this.addChildren(Array.isArray(e)?e:arguments))},insertChildren:function e(t,n){var i=n,r=i[0];r&&"number"==typeof r[0]&&(i=[i]);for(var o=n.length-1;0<=o;o--){var s=i[o];i!==n||s instanceof W||(i=F.slice(i)),Array.isArray(s)?i[o]=new W({segments:s,insert:!1}):s instanceof J&&(i.splice.apply(i,[o,1].concat(s.removeChildren())),s.remove())}return e.base.call(this,t,i)},reduce:function e(t){for(var n,i=this._children,r=i.length-1;0<=r;r--)(n=i[r].reduce(t)).isEmpty()&&n.remove();return i.length?e.base.call(this):((n=new W(U.NO_INSERT)).copyAttributes(this),n.insertAbove(this),this.remove(),n)},isClosed:function(){for(var e=this._children,t=0,n=e.length;t<n;t++)if(!e[t]._closed)return!1;return!0},setClosed:function(e){for(var t=this._children,n=0,i=t.length;n<i;n++)t[n].setClosed(e)},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){for(var e=this._children,t=[],n=0,i=e.length;n<i;n++)F.push(t,e[n].getCurves());return t},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getLastCurve()},getArea:function(){for(var e=this._children,t=0,n=0,i=e.length;n<i;n++)t+=e[n].getArea();return t},getLength:function(){for(var e=this._children,t=0,n=0,i=e.length;n<i;n++)t+=e[n].getLength();return t},getPathData:function(e,t){for(var n=this._children,i=[],r=0,o=n.length;r<o;r++){var s=n[r],a=s._matrix;i.push(s.getPathData(e&&!a.isIdentity()?e.appended(a):e,t))}return i.join("")},_hitTestChildren:function e(t,n,i){return e.base.call(this,t,n.class===W||"path"===n.type?n:F.set({},n,{fill:!1}),i)},_draw:function(e,t,n,i){var r=this._children;if(r.length){t=t.extend({dontStart:!0,dontFinish:!0}),e.beginPath();for(var o=0,s=r.length;o<s;o++)r[o].draw(e,t,i);t.clip||(this._setStyles(e,t,n),(n=this._style).hasFill()&&(e.fill(n.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),n.hasStroke()&&e.stroke())}},_drawSelected:function(e,t,n){for(var i=this._children,r=0,o=i.length;r<o;r++){var s=i[r],a=s._matrix;n[s._id]||s._drawSelected(e,a.isIdentity()?t:t.appended(a))}}},new function(){function n(e,t){e=e._children;if(t&&!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return F.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(t){this[t]=function(){var e=n(this,!0);e[t].apply(e,arguments)}},{moveTo:function(){var e=n(this),t=e&&e.isEmpty()?e:new W(U.NO_INSERT);t!==e&&this.addChild(t),t.moveTo.apply(t,arguments)},moveBy:function(){var e=n(this,!0),e=e&&e.getLastSegment(),t=A.read(arguments);this.moveTo(e?t.add(e._point):t)},closePath:function(e){n(this,!0).closePath(e)}})},F.each(["reverse","flatten","simplify","smooth"],function(o){this[o]=function(e){for(var t,n=this._children,i=0,r=n.length;i<r;i++)t=n[i][o](e)||t;return t}},{}))),E=(T.inject(new function(){var R=Math.min,A=Math.max,j=Math.abs,P={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function S(e){return e._children||[e]}function x(e,t){var n=e.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(t){for(var i=S(n),r=0,o=i.length;r<o;r++)(e=i[r])._closed||e.isEmpty()||(e.closePath(1e-12),e.getFirstSegment().setHandleIn(0,0),e.getLastSegment().setHandleOut(0,0));n=n.resolveCrossings().reorient("nonzero"===n.getFillRule(),!0)}return n}function T(e,t,n,i,r){var o=new J(U.NO_INSERT);return o.addChildren(e,!0),o=o.reduce({simplify:t}),r&&0==r.insert||o.insertAbove(i&&n.isSibling(i)&&n.getIndex()<i.getIndex()?i:n),o.copyAttributes(n,!0),o}function E(e){return e.hasOverlap()||e.isCrossing()}function n(e,t,n,i){if(i&&(0==i.trace||i.stroke)&&/^(subtract|intersect)$/.test(n))return O(e,t,n);var l,r=x(e,!0),o=t&&e!==t&&x(t,!0),s=P[n],h=(s[n]=!0,o&&(s.subtract||s.exclude)^(o.isClockwise()^r.isClockwise())&&o.reverse(),k(q.expand(r.getIntersections(o,E)))),n=S(r),d=o&&S(o),f=[],a=[];function p(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];F.push(f,i._segments),F.push(a,i.getCurves()),i._overlapsOnly=!0}}function g(e){for(var t=[],n=0,i=e&&e.length;n<i;n++)t.push(a[e[n]]);return t}if(h.length){p(n),d&&p(d);for(var v=new Array(a.length),c=0,u=a.length;c<u;c++)v[c]=a[c].getValues();for(var m=V.findCurveBoundsCollisions(v,v,0,!0),_={},c=0;c<a.length;c++){var y=a[c],w=y._path._id;(_[w]=_[w]||{})[y.getIndex()]={hor:g(m[c].hor),ver:g(m[c].ver)}}for(c=0,u=h.length;c<u;c++)D(h[c]._segment,r,o,_,s);for(c=0,u=f.length;c<u;c++){var b=f[c],C=b._intersection;b._winding||D(b,r,o,_,s),C&&C._overlap||(b._path._overlapsOnly=!1)}l=N(f,s)}else l=I(d?n.concat(d):n.slice(),function(e){return!!s[e]});return T(l,!0,e,t,i)}function O(e,t,n){var i=x(e),r=x(t),o=i.getIntersections(r,E),l="subtract"===n,h="divide"===n,s={},a=[];function d(e){return!s[e._id]&&(h||r.contains(e.getPointAt(e.getLength()/2))^l)&&(a.unshift(e),s[e._id]=!0)}for(var c=o.length-1;0<=c;c--){var u=o[c].split();u&&(d(u)&&u.getFirstSegment().setHandleIn(0,0),i.getLastSegment().setHandleOut(0,0))}return d(i),T(a,!1,e,t)}function C(e,t){for(var n=e;n;){if(n===t)return;n=n._previous}for(;e._next&&e._next!==t;)e=e._next;if(!e._next){for(;t._previous;)t=t._previous;(e._next=t)._previous=e}}function M(e){for(var t=e.length-1;0<=t;t--)e[t].clearHandles()}function I(e,l,t){var h=e&&e.length;if(h){var d=F.each(e,function(e,t){this[e._id]={container:null,winding:e.isClockwise()?1:-1,index:t}},{}),n=e.slice().sort(function(e,t){return j(t.getArea())-j(e.getArea())}),f=n[0],p=V.findItemBoundsCollisions(n,null,z.GEOMETRIC_EPSILON);null==t&&(t=f.isClockwise());for(var i=0;i<h;i++){var r,o=n[i],s=d[o._id],g=0,a=p[i];if(a)for(var v=null,c=a.length-1;0<=c;c--)if(a[c]<i){var v=v||o.getInteriorPoint(),u=n[a[c]];if(u.contains(v)){var m=d[u._id],g=m.winding;s.winding+=g,s.container=m.exclude?m.container:u;break}}l(s.winding)===l(g)?(s.exclude=!0,e[s.index]=null):(r=s.container,o.setClockwise(r?!r.isClockwise():t))}}return e}function k(l,e,t){var n,h,i,d=e&&[],f=!1,p=t||[],g=t&&{};function v(e){return e._path._id+"."+e._segment1._index}for(var r=(t&&t.length)-1;0<=r;r--)(o=t[r])._path&&(g[v(o)]=!0);for(r=l.length-1;0<=r;r--){var o,s=l[r],a=s._time,m=a,c=e&&!e(s);if((o=s._curve)&&(o!==h?(f=!o.hasHandles()||g&&g[v(o)],n=[],i=null,h=o):1e-8<=i&&(a/=i)),c)n&&n.push(s);else{if(e&&d.unshift(s),i=m,a<1e-8)u=o._segment1;else if(1-1e-8<a)u=o._segment2;else{c=o.divideAtTime(a,!0);f&&p.push(o,c);for(var u=c._segment1,_=n.length-1;0<=_;_--){var y=n[_];y._time=(y._time-a)/(1-a)}}s._setSegment(u);var w=u._intersection,m=s._intersection;if(w){C(w,m);for(var b=w;b;)C(b._intersection,w),b=b._next}else u._intersection=m}}return t||M(p),d||l}function L(y,w,u,b,C){var e,t=Array.isArray(w)?w:w[u?"hor":"ver"],l=u?1:0,h=1^l,n=[y.x,y.y],S=n[l],d=n[h],x=1e-6,f=S-1e-9,p=S+1e-9,i=0,r=0,g=0,v=0,m=!1,o=!1,T=1,E=[];function s(e){var t=e[h+0],n=e[h+2],i=e[h+4],r=e[h+6];if(d<=A(t,n,i,r)&&d>=R(t,n,i,r))for(var o,t=e[l+0],n=e[l+2],i=e[l+4],r=e[l+6],s=f>A(t,n,i,r)||p<R(t,n,i,r)?[e]:G.getMonoCurves(e,u),a=0,c=s.length;a<c;a++)if(o=function(e){var t=e[h+0],n=e[h+6];if(!(d<R(t,n)||d>A(t,n))){var i,r,o=e[l+0],s=e[l+2],a=e[l+4],c=e[l+6];if(t!==n)return a=0===(s=d===t?0:d!==n&&!(f>A(o,s,a,c)||p<R(o,s,a,c))&&0<G.solveCubic(e,h,d,E,0,1)?E[0]:1)?o:1===s?c:G.getPoint(e,s)[u?"y":"x"],n=n<t?1:-1,i=_[h]>_[h+6]?1:-1,r=_[l+6],d!==t?(a<f?g+=n:p<a?v+=n:m=!0,S-x<a&&a<S+x&&(T/=2)):(n!=i?o<f?g+=n:p<o&&(v+=n):o!=r&&(r<p&&p<a?(v+=n,m=!0):f<r&&a<f&&(g+=n,m=!0)),T/=4),_=e,!C&&f<a&&a<p&&0===G.getTangent(e,s)[u?"x":"y"]&&L(y,w,!u,b,!0);(o<p&&f<c||c<p&&f<o)&&(m=!0)}}(s[a]))return o}for(var a=0,c=t.length;a<c;a++){var k=t[a],P=k._path,O=k.getValues();if(!(a&&t[a-1]._path===P||(_=null,P._closed||(e=G.getValues(P.getLastCurve().getSegment2(),k.getSegment1(),null,!b))[h]!==e[h+6]&&(_=e),_)))for(var _=O,M=P.getLastCurve();M&&M!==k;){var I=M.getValues();if(I[h]!==I[h+6]){_=I;break}M=M.getPrevious()}if(O=s(O))return O;if(a+1===c||t[a+1]._path!==P){if(e&&(O=s(e)))return O;i+=g=m&&!g&&!v?v=P.isClockwise(b)^u?1:-1:g,r+=v,g=v=0,m=m&&!(o=!0),e=null}}return i=j(i),r=j(r),{winding:A(i,r),windingL:i,windingR:r,quality:T,onPath:o}}function D(e,l,h,d,f){var t=[],p=e,g=0;do{}while((s=e.getCurve())&&(i=s.getLength(),t.push({segment:e,curve:s,length:i}),g+=i),(e=e.getNext())&&!e._intersection&&e!==p);for(var v=[.5,.25,.75],n={winding:0,quality:-1},m=0;m<v.length&&n.quality<.5;m++)for(var i=g*v[m],r=0,_=t.length;r<_;r++){var o=t[r],y=o.length;if(i<=y){var s,o=(s=o.curve)._path,a=o._parent,a=a instanceof J?a:o,c=z.clamp(s.getTimeAt(i),.001,.999),w=s.getPointAtTime(c),c=j(s.getTangentAtTime(c).y)<Math.SQRT1_2,u=null;if(f.subtract&&h){var b=(a===l?h:l)._getWinding(w,c,!0);if(a===l&&b.winding||a===h&&!b.winding){if(b.quality<1)continue;u={winding:0,quality:1}}}(u=u||L(w,d[o._id][s.getIndex()],c,!0)).quality>n.quality&&(n=u);break}i-=y}for(r=t.length-1;0<=r;r--)t[r].segment._winding=n}function N(a,h){var c,d=[];function u(e){return!(!e||e._visited||h&&(!h[(e=e._winding||{}).winding]||h.unite&&2===e.winding&&e.windingL&&e.windingR))}function l(e){if(e)for(var t=0,n=c.length;t<n;t++)if(e===c[t])return!0;return!1}function f(e){for(var t=e._segments,n=0,i=t.length;n<i;n++)t[n]._visited=!0}a.sort(function(e,t){var n=e._intersection,i=t._intersection,r=!(!n||!n._overlap),o=!(!i||!i._overlap),s=e._path,a=t._path;return r^o?r?1:-1:!n^!i?n?1:-1:s!==a?s._id-a._id:e._index-t._index});for(var p=0,g=a.length;p<g;p++){var e,t,n,i,v,r=a[p],m=u(r),o=null,_=!1,y=!0,w=[];for(m&&r._path._overlapsOnly&&(i=r._path,v=r._intersection._segment._path,i.compare(v)&&(i.getArea()&&d.push(i.clone(!1)),f(i),f(v),m=!1));m;){var s=!o,b=function(o,s){var e=o._intersection,t=e,a=[];function n(e,t){for(;e&&e!==t;){var n,i=e._segment,r=i&&i._path;r&&(n=(r=i.getNext()||r.getFirstSegment())._intersection,i!==o&&(l(i)||l(r)||r&&u(i)&&(u(r)||n&&u(n._segment)))&&a.push(i),s&&c.push(i)),e=e._next}}if(s&&(c=[o]),e){for(n(e);e&&e._previous;)e=e._previous;n(e,t)}return a}(r,s),C=b.shift(),S=!(_=!s&&(l(r)||l(C)))&&C;if(s&&(o=new W(U.NO_INSERT),e=null),_){(r.isFirst()||r.isLast())&&(y=r._path._closed),r._visited=!0;break}if(S&&e&&(w.push(e),e=null),e||(S&&b.push(r),e={start:o._segments.length,crossings:b,visited:t=[],handleIn:n}),!u(r=S?C:r)){o.removeSegments(e.start);for(var x=0,T=t.length;x<T;x++)t[x]._visited=!1;for(t.length=0;(r=e&&e.crossings.shift())&&r._path||(r=null,(e=w.pop())&&(t=e.visited,n=e.handleIn)),e&&!u(r););if(!r)break}s=r.getNext();o.add(new H(r._point,n,s&&r._handleOut)),r._visited=!0,t.push(r),r=s||r._path.getFirstSegment(),n=s&&s._handleIn}_&&(y&&(o.getFirstSegment().setHandleIn(n),o.setClosed(y)),0!==o.getArea()&&d.push(o))}return d}return{_getWinding:function(e,t,n){return L(e,this.getCurves(),t,n)},unite:function(e,t){return n(this,e,"unite",t)},intersect:function(e,t){return n(this,e,"intersect",t)},subtract:function(e,t){return n(this,e,"subtract",t)},exclude:function(e,t){return n(this,e,"exclude",t)},divide:function(e,t){return t&&(0==t.trace||t.stroke)?O(this,e,"divide"):T([this.subtract(e,t),this.intersect(e,t)],!0,this,e,t)},resolveCrossings:function(){var e=this._children,t=e||[this];function l(e,t){e=e&&e._intersection;return e&&e._overlap&&e._path===t}var n=!1,i=!1,r=this.getIntersections(null,function(e){return e.hasOverlap()?n=!0:e.isCrossing()&&(i=!0)}),o=n&&i&&[],r=q.expand(r);if(n)for(var h=k(r,function(e){return e.hasOverlap()},o),s=h.length-1;0<=s;s--){var a=h[s],d=a._path,a=a._segment,c=a.getPrevious(),f=a.getNext();l(c,d)&&l(f,d)&&(a.remove(),c._handleOut._set(0,0),f._handleIn._set(0,0),c===a||c.getCurve().hasLength()||(f._handleIn.set(c._handleIn),c.remove()))}i&&(k(r,n&&function(e){var t=e.getCurve(),n=e.getSegment(),e=e._intersection,i=e._curve,e=e._segment;if(t&&i&&t._path&&i._path)return!0;n&&(n._intersection=null),e&&(e._intersection=null)},o),o&&M(o),t=N(F.each(t,function(e){F.push(this,e._segments)},[])));var u,r=t.length;return 1<r&&e?(t!==e&&this.setChildren(t),u=this):1!==r||e||(t[0]!==this&&this.setSegments(t[0].removeSegments()),u=this),u||((u=new J(U.NO_INSERT)).addChildren(t),(u=u.reduce()).copyAttributes(this),this.replaceWith(u)),u},reorient:function(t,e){var n=this._children;return n&&n.length?this.setChildren(I(this.removeChildren(),function(e){return!!(t?e:1&e)},e)):e!==B&&this.setClockwise(e),this},getInteriorPoint:function(){var e=this.getBounds().getCenter(!0);if(!this.contains(e)){for(var t=this.getCurves(),n=e.y,i=[],l=[],r=0,h=t.length;r<h;r++){var o=t[r].getValues(),d=o[1],f=o[3],p=o[5],g=o[7];if(n>=R(d,f,p,g)&&n<=A(d,f,p,g))for(var v=G.getMonoCurves(o),s=0,m=v.length;s<m;s++){var a=v[s],c=a[1],u=a[7];c!==u&&(c<=n&&n<=u||u<=n&&n<=c)&&(c=n===c?a[0]:n===u?a[6]:1===G.solveCubic(a,1,n,l,0,1)?G.getPoint(a,l[0]).x:(a[0]+a[6])/2,i.push(c))}}1<i.length&&(i.sort(function(e,t){return e-t}),e.x=(i[0]+i[1])/2)}return e}}}),F.extend({_class:"PathFlattener",initialize:function(e,a,l,h,d){var t,n=[],c=[],u=0,f=1/(l||32),i=e._segments,r=i[0];function o(e,t){t=G.getValues(e,t,d);n.push(t),function e(t,n,i,r){{var o,s;!(f<r-i)||h&&G.isStraight(t)||G.isFlatEnough(t,a||.25)?(s=t[6]-t[0],o=t[7]-t[1],0<(s=Math.sqrt(s*s+o*o))&&(u+=s,c.push({offset:u,curve:t,index:n,time:r}))):(o=G.subdivide(t,.5),s=(i+r)/2,e(o[0],n,i,s),e(o[1],n,s,r))}}(t,e._index,0,1)}for(var s=1,p=i.length;s<p;s++)o(r,t=i[s]),r=t;e._closed&&o(t||r,i[0]),this.curves=n,this.parts=c,this.length=u,this.index=0},_get:function(e){for(var t,n=this.parts,i=n.length,r=this.index;(t=r)&&!(n[--r].offset<e););for(;t<i;t++){var o,s,a=n[t];if(a.offset>=e)return o=(s=n[(this.index=t)-1])&&s.index===a.index?s.time:0,s=s?s.offset:0,{index:a.index,time:o+(a.time-o)*(e-s)/(a.offset-s)}}return{index:n[i-1].index,time:1}},drawPart:function(e,t,n){for(var i=this._get(t),r=this._get(n),o=i.index,s=r.index;o<=s;o++){var a=G.getPart(this.curves[o],o===i.index?i.time:0,o===r.index?r.time:1);o===i.index&&e.moveTo(a[0],a[1]),e.bezierCurveTo.apply(e,a.slice(2))}}},F.each(G._evaluateMethods,function(t){this[t+"At"]=function(e){e=this._get(e);return G[t](this.curves[e.index],e.time)}},{}))),k=F.extend({initialize:function(e){for(var t,n=this.points=[],i=e._segments,e=e._closed,r=0,o=i.length;r<o;r++){var s=i[r].point;t&&t.equals(s)||n.push(t=s.clone())}e&&(n.unshift(n[n.length-1]),n.push(n[1])),this.closed=e},fit:function(e){var t=this.points,n=t.length,i=null;return 0<n&&(i=[new H(t[0])],1<n&&(this.fitCubic(i,e,0,n-1,t[1].subtract(t[0]),t[n-2].subtract(t[n-1])),this.closed&&(i.shift(),i.pop()))),i},fitCubic:function(e,t,n,i,r,l){var o,h,s=this.points;if(i-n==1)return u=s[n],o=s[i],h=u.getDistance(o)/3,void this.addCurve(e,[u,u.add(r.normalize(h)),o.add(l.normalize(h)),o]);for(var a,d=this.chordLengthParameterize(n,i),f=Math.max(t,t*t),p=!0,g=0;g<=4;g++){var v=this.generateBezier(n,i,d,r,l),c=this.findMaxError(n,i,v,d);if(c.error<t&&p)return void this.addCurve(e,v);if(a=c.index,c.error>=f)break;p=this.reparameterize(n,i,d,v),f=c.error}var u=s[a-1].subtract(s[a+1]);this.fitCubic(e,t,n,a,r,u),this.fitCubic(e,t,a,i,u.negate(),l)},addCurve:function(e,t){e[e.length-1].setHandleOut(t[1].subtract(t[0])),e.push(new H(t[3],t[2].subtract(t[3])))},generateBezier:function(l,e,h,d,f){for(var t=Math.abs,p=this.points,n=p[l],g=p[e],i=[[0,0],[0,0]],r=[0,0],v=0,m=e-l+1;v<m;v++){var o=h[v],s=1-o,_=3*o*s,y=s*s*s,s=_*s,_=_*o,o=o*o*o,w=d.normalize(s),b=f.normalize(_),y=p[l+v].subtract(n.multiply(y+s)).subtract(g.multiply(_+o));i[0][0]+=w.dot(w),i[0][1]+=w.dot(b),i[1][0]=i[0][1],i[1][1]+=b.dot(b),r[0]+=w.dot(y),r[1]+=b.dot(y)}var a,c,u,C,S,e=i[0][0]*i[1][1]-i[1][0]*i[0][1],e=(1e-12<t(e)?(c=i[0][0]*r[1]-i[1][0]*r[0],a=(r[0]*i[1][1]-r[1]*i[0][1])/e,c=c/e):(e=i[0][0]+i[0][1],u=i[1][0]+i[1][1],a=c=1e-12<t(e)?r[0]/e:1e-12<t(u)?r[1]/u:0),g.getDistance(n)),t=1e-12*e;return a<t||c<t?a=c=e/3:(u=g.subtract(n),C=d.normalize(a),S=f.normalize(c),C.dot(u)-S.dot(u)>e*e&&(a=c=e/3,C=S=null)),[n,n.add(C||d.normalize(a)),g.add(S||f.normalize(c)),g]},reparameterize:function(e,t,n,i){for(var r=e;r<=t;r++)n[r-e]=this.findRoot(i,this.points[r],n[r-e]);for(var r=1,o=n.length;r<o;r++)if(n[r]<=n[r-1])return!1;return!0},findRoot:function(e,t,n){for(var i=[],r=[],o=0;o<=2;o++)i[o]=e[o+1].subtract(e[o]).multiply(3);for(o=0;o<=1;o++)r[o]=i[o+1].subtract(i[o]).multiply(2);var s=this.evaluate(3,e,n),a=this.evaluate(2,i,n),c=this.evaluate(1,r,n),s=s.subtract(t),t=a.dot(a)+s.dot(c);return z.isMachineZero(t)?n:n-s.dot(a)/t},evaluate:function(e,t,n){for(var i=t.slice(),r=1;r<=e;r++)for(var o=0;o<=e-r;o++)i[o]=i[o].multiply(1-n).add(i[o+1].multiply(n));return i[0]},chordLengthParameterize:function(e,t){for(var n=[0],i=e+1;i<=t;i++)n[i-e]=n[i-e-1]+this.points[i].getDistance(this.points[i-1]);for(var i=1,r=t-e;i<=r;i++)n[i]/=n[r];return n},findMaxError:function(e,t,n,i){for(var r=Math.floor((t-e+1)/2),o=0,s=e+1;s<t;s++){var a=this.evaluate(3,n,i[s-e]).subtract(this.points[s]),a=a.x*a.x+a.y*a.y;o<=a&&(o=a,r=s)}return{error:o,index:r}}}),D=U.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(e){this._content="",this._lines=[];var t=e&&F.isPlainObject(e)&&e.x===B&&e.y===B;this._initialize(t&&e,!t&&A.read(arguments))},_equals:function(e){return this._content===e._content},copyContent:function(e){this.setContent(e._content)},getContent:function(){return this._content},setContent:function(e){this._content=""+e,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),N=D.extend({_class:"PointText",initialize:function(){D.apply(this,arguments)},getPoint:function(){var e=this._matrix.getTranslation();return new u(e.x,e.y,this,"setPoint")},setPoint:function(){var e=A.read(arguments);this.translate(e.subtract(this._matrix.getTranslation()))},_draw:function(e,t,n){if(this._content){this._setStyles(e,t,n);var i=this._lines,t=this._style,r=t.hasFill(),o=t.hasStroke(),s=t.getLeading(),a=e.shadowColor;e.font=t.getFontStyle(),e.textAlign=t.getJustification();for(var c=0,l=i.length;c<l;c++){e.shadowColor=a;var u=i[c];r&&(e.fillText(u,0,0),e.shadowColor="rgba(0,0,0,0)"),o&&e.strokeText(u,0,0),e.translate(0,s)}}},_getBounds:function(e,t){var n=this._style,i=this._lines,r=i.length,o=n.getJustification(),s=n.getLeading(),n=this.getView().getTextWidth(n.getFontStyle(),i),i=0,o=("left"!==o&&(i-=n/("center"===o?2:1)),new C(i,r?-.75*s:0,n,r*s));return e?e._transformBounds(o,o):o}}),X=F.extend(new function(){var m,_={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},y={},w={transparent:[0,0,0,0]};var r=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],n={"rgb-hsb":function(e,t,n){var i=Math.max(e,t,n),r=i-Math.min(e,t,n);return[0==r?0:60*(i==e?(t-n)/r+(t<n?6:0):i==t?(n-e)/r+2:(e-t)/r+4),0===i?0:r/i,i]},"hsb-rgb":function(e,t,n){e=(e/60%6+6)%6;var i=Math.floor(e),e=e-i,n=[n,n*(1-t),n*(1-t*e),n*(1-t*(1-e))];return[n[(i=r[i])[0]],n[i[1]],n[i[2]]]},"rgb-hsl":function(e,t,n){var i=Math.max(e,t,n),r=Math.min(e,t,n),o=i-r,s=0==o,a=(i+r)/2;return[s?0:60*(i==e?(t-n)/o+(t<n?6:0):i==t?(n-e)/o+2:(e-t)/o+4),s?0:a<.5?o/(i+r):o/(2-i-r),a]},"hsl-rgb":function(e,t,n){if(0===t)return[n,n,n];for(var i=[(e=(e/360%1+1)%1)+1/3,e,e-1/3],r=n<.5?n*(1+t):n+t-n*t,o=2*n-r,s=[],a=0;a<3;a++){var c=i[a];c<0&&(c+=1),1<c&&--c,s[a]=6*c<1?o+6*(r-o)*c:2*c<1?r:3*c<2?o+(r-o)*(2/3-c)*6:o}return s},"rgb-gray":function(e,t,n){return[.2989*e+.587*t+.114*n]},"gray-rgb":function(e){return[e,e,e]},"gray-hsb":function(e){return[0,0,e]},"gray-hsl":function(e){return[0,0,e]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return F.each(_,function(e,o){y[o]=[],F.each(e,function(e,t){var n=F.capitalize(e),i=/^(hue|saturation)$/.test(e),r=y[o][t]="gradient"===o?"gradient"===e?function(e){var t=this._components[0];return t!==(e=Z.read(Array.isArray(e)?e:arguments,0,{readNull:!0}))&&(t&&t._removeOwner(this),e&&e._addOwner(this)),e}:function(){return A.read(arguments,0,{readNull:"highlight"===e,clone:!0})}:function(e){return null==e||isNaN(e)?0:+e};this["get"+n]=function(){return(this._type===o||i&&/^hs[bl]$/.test(this._type)?this._components:this._convert(o))[t]},this["set"+n]=function(e){this._type===o||i&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(o),this._properties=_[o],this._type=o),this._components[t]=r.call(this,e),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function l(e){var t,n,i=arguments,h=this.__read,d=0,r=null!=(e=Array.isArray(e)?(i=e)[0]:e)&&typeof e;if("string"===r&&e in _&&(o=e,e=i[1],Array.isArray(e)?(t=e,a=i[2]):(h&&(d=1),i=F.slice(i,1),r=typeof e)),!t){if(n="number"===r?i:"object"===r&&null!=e.length?e:null){var o=o||(3<=n.length?"rgb":"gray"),s=_[o].length,a=n[s];h&&(d+=n===arguments?s+(null!=a?1:0):1),n.length>s&&(n=F.slice(n,0,s))}else if("string"===r){s=function(e){var t=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),n="rgb";if(t)for(var i=t[4]?4:3,r=new Array(i),o=0;o<i;o++){var s=t[o+1];r[o]=parseInt(1==s.length?s+s:s,16)/255}else if(t=e.match(/^(rgb|hsl)a?\((.*)\)$/)){n=t[1],r=t[2].trim().split(/[,\s]+/g);for(var l="hsl"===n,o=0,h=Math.min(r.length,4);o<h;o++){var a,c=r[o],s=parseFloat(c);l?0===o?(a=c.match(/([a-z]*)$/)[1],s*={turn:360,rad:180/Math.PI,grad:.9}[a]||1):o<3&&(s/=100):o<3&&(s/=/%$/.test(c)?100:255),r[o]=s}}else{var u,d=w[e];r=(d=d||(O?(m||((m=le.getContext(1,1)).globalCompositeOperation="copy"),m.fillStyle="rgba(0,0,0,0)",m.fillStyle=e,m.fillRect(0,0,1,1),u=m.getImageData(0,0,1,1).data,w[e]=[u[0]/255,u[1]/255,u[2]/255]):[0,0,0])).slice()}return[n,r]}(e);o=s[0],4===(t=s[1]).length&&(a=t[3],t.length--)}else if("object"===r)if(e.constructor===l){if(o=e._type,t=e._components.slice(),a=e._alpha,"gradient"===o)for(var c=1,f=t.length;c<f;c++){var p=t[c];p&&(t[c]=p.clone())}}else if(e.constructor===Z)o="gradient",n=i;else{o="hue"in e?"lightness"in e?"hsl":"hsb":"gradient"in e||"stops"in e||"radial"in e?"gradient":"gray"in e?"gray":"rgb";var g=_[o],v=y[o];this._components=t=[];for(c=0,f=g.length;c<f;c++)null==(u=e[g[c]])&&!c&&"gradient"===o&&"stops"in e&&(u={stops:e.stops,radial:e.radial}),null!=(u=v[c].call(this,u))&&(t[c]=u);a=e.alpha}h&&o&&(d=1)}if(this._type=o||"rgb",!t){this._components=t=[];for(var u,c=0,f=(v=y[this._type]).length;c<f;c++)null!=(u=v[c].call(this,n&&n[c]))&&(t[c]=u)}return this._components=t,this._properties=_[this._type],this._alpha=a,h&&(this.__read=d),this},set:"#initialize",_serialize:function(e,t){var n=this.getComponents();return F.serialize(/^(gray|rgb)$/.test(this._type)?n:[this._type].concat(n),e,!0,t)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(e){var t;return this._type===e?this._components.slice():(t=n[this._type+"-"+e])?t.apply(this,this._components):n["rgb-"+e].apply(this,n[this._type+"-rgb"].apply(this,this._components))},convert:function(e){return new X(e,this._convert(e),this._alpha)},getType:function(){return this._type},setType:function(e){this._components=this._convert(e),this._properties=_[e],this._type=e},getComponents:function(){var e=this._components.slice();return null!=this._alpha&&e.push(this._alpha),e},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(e){this._alpha=null==e?null:Math.min(Math.max(e,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(e){var t=F.isPlainValue(e,!0)?X.read(arguments):e;return t===this||t&&this._class===t._class&&this._type===t._type&&this.getAlpha()===t.getAlpha()&&F.equals(this._components,t._components)||!1},toString:function(){for(var e=this._properties,t=[],n="gradient"===this._type,i=b.instance,r=0,o=e.length;r<o;r++){var s=this._components[r];null!=s&&t.push(e[r]+": "+(n?s:i.number(s)))}return null!=this._alpha&&t.push("alpha: "+i.number(this._alpha)),"{ "+t.join(", ")+" }"},toCSS:function(e){var t=this._convert("rgb"),n=e||null==this._alpha?1:this._alpha;function i(e){return Math.round(255*(e<0?0:1<e?1:e))}return t=[i(t[0]),i(t[1]),i(t[2])],n<1&&t.push(n<0?0:n),e?"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1):(4==t.length?"rgba(":"rgb(")+t.join(",")+")"},toCanvasStyle:function(e,t){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var n,i=this._components,r=i[0],o=r._stops,s=i[1],a=i[2],i=i[3],t=t&&t.inverted();t&&(s=t._transformPoint(s),a=t._transformPoint(a),i=i&&t._transformPoint(i)),n=r._radial?(t=a.getDistance(s),!i||(r=i.subtract(s)).getLength()>t&&(i=s.add(r.normalize(t-.1))),e.createRadialGradient((r=i||s).x,r.y,0,s.x,s.y,t)):e.createLinearGradient(s.x,s.y,a.x,a.y);for(var c=0,u=o.length;c<u;c++){var l=o[c],h=l._offset;n.addColorStop(null==h?c/(u-1):h,l._color.toCanvasStyle())}return this._canvasStyle=n},transform:function(e){if("gradient"===this._type){for(var t=this._components,n=1,i=t.length;n<i;n++){var r=t[n];e._transformPoint(r,r,!0)}this._changed()}},statics:{_types:_,random:function(){var e=Math.random;return new X(e(),e(),e())},_setOwner:function(e,t,n){return e&&!(e=e._owner&&t&&e._owner!==t?e.clone():e)._owner^!t&&(e._owner=t||null,e._setter=n||null),e}}})},new function(){return F.each({add:function(e,t){return e+t},subtract:function(e,t){return e-t},multiply:function(e,t){return e*t},divide:function(e,t){return e/t}},function(s,e){this[e]=function(e){e=X.read(arguments);for(var t=this._type,n=this._components,i=e._convert(t),r=0,o=n.length;r<o;r++)i[r]=s(n[r],i[r]);return new X(t,i,null!=this._alpha?s(this._alpha,e.getAlpha()):null)}},{})}),Z=F.extend({_class:"Gradient",initialize:function(e,t){this._id=a.get(),e&&F.isPlainObject(e)&&(this.set(e),e=t=null),null==this._stops&&this.setStops(e||["white","black"]),null==this._radial&&this.setRadial("string"==typeof t&&"radial"===t||t||!1)},_serialize:function(e,t){return t.add(this,function(){return F.serialize([this._stops,this._radial],e,!0,t)})},_changed:function(){for(var e=0,t=this._owners&&this._owners.length;e<t;e++)this._owners[e]._changed()},_addOwner:function(e){this._owners||(this._owners=[]),this._owners.push(e)},_removeOwner:function(e){e=this._owners?this._owners.indexOf(e):-1;-1!=e&&(this._owners.splice(e,1),this._owners.length||(this._owners=B))},clone:function(){for(var e=[],t=0,n=this._stops.length;t<n;t++)e[t]=this._stops[t].clone();return new Z(e,this._radial)},getStops:function(){return this._stops},setStops:function(e){if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var t=this._stops;if(t)for(var n=0,i=t.length;n<i;n++)t[n]._owner=B;for(n=0,i=(t=this._stops=Y.readList(e,0,{clone:!0})).length;n<i;n++)t[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(e){this._radial=e,this._changed()},equals:function(e){if(e===this)return!0;if(e&&this._class===e._class){var t=this._stops,n=e._stops,i=t.length;if(i===n.length){for(var r=0;r<i;r++)if(!t[r].equals(n[r]))return!1;return!0}}return!1}}),Y=F.extend({_class:"GradientStop",initialize:function(e,t){var n=e,i=t;"object"==typeof e&&t===B&&(Array.isArray(e)&&"number"!=typeof e[0]?(n=e[0],i=e[1]):("color"in e||"offset"in e||"rampPoint"in e)&&(n=e.color,i=e.offset||e.rampPoint||0)),this.setColor(n),this.setOffset(i)},clone:function(){return new Y(this._color.clone(),this._offset)},_serialize:function(e,t){var n=this._color,i=this._offset;return F.serialize(null==i?[n]:[n,i],e,!0,t)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(e){this._offset=e,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){X._setOwner(this._color,null),this._color=X._setOwner(X.read(arguments,0),this,"setColor"),this._changed()},equals:function(e){return e===this||e&&this._class===e._class&&this._color.equals(e._color)&&this._offset==e._offset||!1}}),K=F.extend(new function(){var i={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new A,selectedColor:null},r=F.set({},i,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),o=F.set({},r,{fillColor:new X}),n={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},s={beans:!0},f={_class:"Style",beans:!0,initialize:function(e,t,n){this._values={},this._owner=t,this._project=t&&t._project||n||P.project,this._defaults=!t||t instanceof m?r:t instanceof D?o:i,e&&this.set(e)}};return F.each(r,function(e,c){var u=/Color$/.test(c),l="shadowOffset"===c,t=F.capitalize(c),a=n[c],h="set"+t,d="get"+t;f[h]=function(e){var t,n=this._owner,i=n&&n._children,r=i&&0<i.length&&!(n instanceof J);if(r)for(var o=0,s=i.length;o<s;o++)i[o]._style[h](e);"selectedColor"!==c&&r||!(c in this._defaults)||(t=this._values[c])!==e&&(u&&(t&&(X._setOwner(t,null),t._canvasStyle=null),e&&e.constructor===X&&(e=X._setOwner(e,n,r&&h))),this._values[c]=e,n&&n._changed(a||129))},f[d]=function(e){var t,n=this._owner,i=n&&n._children,r=i&&0<i.length&&!(n instanceof J);if(r&&!e)for(var o=0,s=i.length;o<s;o++){var a=i[o]._style[d]();if(o){if(!F.equals(t,a))return B}else t=a}else c in this._defaults&&((t=this._values[c])===B?(t=this._defaults[c])&&t.clone&&(t=t.clone()):!(e=u?X:l?A:null)||t&&t.constructor===e||(this._values[c]=t=e.read([t],0,{readNull:!0,clone:!0})));return t=t&&u?X._setOwner(t,n,r&&h):t},s[d]=function(e){return this._style[d](e)},s[h]=function(e){this._style[h](e)}}),F.each({Font:"FontFamily",WindingRule:"FillRule"},function(e,t){var n="get"+t,t="set"+t;f[n]=s[n]="#get"+e,f[t]=s[t]="#set"+e}),U.inject(s),f},{set:function(e){var t,n=e instanceof K,i=n?e._values:e;if(i)for(var r in i)r in this._defaults&&(t=i[r],this[r]=t&&n&&t.clone?t.clone():t)},equals:function(e){function t(e,t,n){var i,r=e._values,o=t._values,s=t._defaults;for(i in r){var a=r[i],c=o[i];if(!(n&&i in o||F.equals(a,c===B?s[i]:c)))return!1}return!0}return e===this||e&&this._class===e._class&&t(this,e)&&t(e,this,!0)||!1},_dispose:function(){var e=this.getFillColor();e&&(e._canvasStyle=null),(e=this.getStrokeColor())&&(e._canvasStyle=null),(e=this.getShadowColor())&&(e._canvasStyle=null)},hasFill:function(){var e=this.getFillColor();return!!e&&0<e.alpha},hasStroke:function(){var e=this.getStrokeColor();return!!e&&0<e.alpha&&0<this.getStrokeWidth()},hasShadow:function(){var e=this.getShadowColor();return!!e&&0<e.alpha&&(0<this.getShadowBlur()||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var e=this.getFontSize();return this.getFontWeight()+" "+e+(/[a-z]/i.test(e+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function e(){var t=e.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=t?t:1.2*n}}),$=new function(){function r(e,t,n,i){for(var r=["","webkit","moz","Moz","ms","o"],o=t[0].toUpperCase()+t.substring(1),s=0;s<6;s++){var a=r[s],a=a?a+o:t;if(a in e){if(!n)return e[a];e[a]=i;break}}}return{getStyles:function(e){var t=e&&9!==e.nodeType?e.ownerDocument:e,t=t&&t.defaultView;return t&&t.getComputedStyle(e,"")},getBounds:function(e,t){var n,i=e.ownerDocument,r=i.body,o=i.documentElement;try{n=e.getBoundingClientRect()}catch(e){n={left:0,top:0,width:0,height:0}}var e=n.left-(o.clientLeft||r.clientLeft||0),s=n.top-(o.clientTop||r.clientTop||0);return t||(e+=(t=i.defaultView).pageXOffset||o.scrollLeft||r.scrollLeft,s+=t.pageYOffset||o.scrollTop||r.scrollTop),new C(e,s,n.width,n.height)},getViewportBounds:function(e){var e=e.ownerDocument,t=e.defaultView,e=e.documentElement;return new C(0,0,t.innerWidth||e.clientWidth,t.innerHeight||e.clientHeight)},getOffset:function(e,t){return $.getBounds(e,t).getPoint()},getSize:function(e){return $.getBounds(e,!0).getSize()},isInvisible:function(e){return $.getSize(e).equals(new I(0,0))},isInView:function(e){return!$.isInvisible(e)&&$.getViewportBounds(e).intersects($.getBounds(e,!0))},isInserted:function(e){return M.body.contains(e)},getPrefixed:function(e,t){return e&&r(e,t)},setPrefixed:function(e,t,n){if("object"==typeof t)for(var i in t)r(e,i,!0,t[i]);else r(e,t,!0,n)}}},Q={add:function(e,t){if(e)for(var n in t)for(var i=t[n],r=n.split(/[\s,]+/g),o=0,s=r.length;o<s;o++){var a=r[o];e.addEventListener(a,i,e===M&&("touchstart"===a||"touchmove"===a)&&{passive:!1})}},remove:function(e,t){if(e)for(var n in t)for(var i=t[n],r=n.split(/[\s,]+/g),o=0,s=r.length;o<s;o++)e.removeEventListener(r[o],i,!1)},getPoint:function(e){e=e.targetTouches?(e.targetTouches.length?e.targetTouches:e.changedTouches)[0]:e;return new A(e.pageX||e.clientX+M.documentElement.scrollLeft,e.pageY||e.clientY+M.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getRelatedTarget:function(e){return e.relatedTarget||e.toElement},getOffset:function(e,t){return Q.getPoint(e).subtract($.getOffset(t||Q.getTarget(e)))}},ee=(Q.requestAnimationFrame=new function(){var t,i=$.getPrefixed(O,"requestAnimationFrame"),r=!1,o=[];function s(){var e=o;o=[];for(var t=0,n=e.length;t<n;t++)e[t]();(r=i&&o.length)&&i(s)}return function(e){o.push(e),i?r||(i(s),r=!0):t=t||setInterval(s,1e3/60)}},F.extend(e,{_class:"View",initialize:function e(t,n){function i(e){return n[e]||parseInt(n.getAttribute(e),10)}function r(){var e=$.getSize(n);return e.isNaN()||e.isZero()?new I(i("width"),i("height")):e}var o,s,a,c,u;O&&n?(this._id=n.getAttribute("id"),null==this._id&&n.setAttribute("id",this._id="paper-view-"+e._id++),Q.add(n,this._viewEvents),$.setPrefixed(n.style,{userDrag:o="none",userSelect:o,touchCallout:o,contentZooming:o,tapHighlightColor:"rgba(0,0,0,0)"}),l.hasAttribute(n,"resize")&&Q.add(O,(s=this)._windowEvents={resize:function(){s.setViewSize(r())}}),o=r(),l.hasAttribute(n,"stats")&&"undefined"!=typeof Stats&&(this._stats=new Stats,c=(a=this._stats.domElement).style,u=$.getOffset(n),c.position="absolute",c.left=u.x+"px",c.top=u.y+"px",M.body.appendChild(a))):(o=new I(n),n=null),this._project=t,this._scope=t._scope,this._element=n,this._pixelRatio||(this._pixelRatio=O&&O.devicePixelRatio||1),this._setElementSize(o.width,o.height),this._viewSize=o,e._views.push(this),((e._viewsById[this._id]=this)._matrix=new R)._owner=this,e._focused||(e._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!P.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;ee._focused===this&&(ee._focused=null),ee._views.splice(ee._views.indexOf(this),1),delete ee._viewsById[this._id];var e=this._project;return e._view===this&&(e._view=null),Q.remove(this._element,this._viewEvents),Q.remove(O,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:F.each(U._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(e){this[e]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(e){(this._autoUpdate=e)&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){var t;this._requested||(t=this,Q.requestAnimationFrame(function(){var e;t._requested=!1,t._animate&&(t.requestUpdate(),e=t._element,$.getPrefixed(M,"hidden")&&"true"!==l.getAttribute(e,"keepalive")||!$.isInView(e)||t._handleFrame()),t._autoUpdate&&t.update()}),this._requested=!0)},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){P=this._scope;var e=Date.now()/1e3,t=this._last?e-this._last:0;this._last=e,this.emit("frame",new F({delta:t,time:this._time+=t,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(e,t){var n=this._frameItems;t?(n[e._id]={item:e,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[e._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(e){for(var t in this._frameItems){t=this._frameItems[t];t.item.emit("frame",new F(e,{time:t.time+=e.delta,count:t.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=B},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var e=this._viewSize;return new i(e.width,e.height,this,"setViewSize")},setViewSize:function(){var e=I.read(arguments),t=e.subtract(this._viewSize);t.isZero()||(this._setElementSize(e.width,e.height),this._viewSize.set(e),this._changed(),this.emit("resize",{size:e,delta:t}),this._autoUpdate&&this.update())},_setElementSize:function(e,t){var n=this._element;n&&(n.width!==e&&(n.width=e),n.height!==t&&(n.height=t))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new C(new A,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return $.isInView(this._element)},isInserted:function(){return $.isInserted(this._element)},getPixelSize:function(e){var t,n,i=this._element;return i?(i=i.parentNode,(n=M.createElement("div")).style.fontSize=e,i.appendChild(n),t=parseFloat($.getStyles(n).fontSize),i.removeChild(n)):t=parseFloat(t),t},getTextWidth:function(e,t){return 0}},F.each(["rotate","scale","shear","skew"],function(n){var i="rotate"===n;this[n]=function(){var e=arguments,t=(i?F:A).read(e),e=A.read(e,0,{readNull:!0});return this.transform((new R)[n](t,e||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var e=new R;return this.transform(e.translate.apply(e,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var e=A.read(arguments);this.translate(this.getCenter().subtract(e))},getZoom:function(){var e=this._decompose().scaling;return(e.x+e.y)/2},setZoom:function(e){this.transform((new R).scale(e/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(e){var t=this.getRotation();null!=t&&null!=e&&this.rotate(e-t)},getScaling:function(){var e=this._decompose().scaling;return new u(e.x,e.y,this,"setScaling")},setScaling:function(){var e=this.getScaling(),t=A.read(arguments,0,{clone:!0,readNull:!0});e&&t&&this.scale(t.x/e.x,t.y/e.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var e=this._matrix;e.set.apply(e,arguments)},transform:function(e){this._matrix.append(e)},scrollBy:function(){this.translate(A.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(A.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(A.read(arguments))},getEventPoint:function(e){return this.viewToProject(Q.getOffset(e,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e,t){return M&&"string"==typeof t&&(t=M.getElementById(t)),new(O?te:ee)(e,t)}}},new function(){var i,r,p,o,e,s,a,t,n,g,_,u,y,w,b,C,S,v,x,T,E,c;if(O)return p=!1,o=!1,t=O.navigator,t.pointerEnabled||t.msPointerEnabled?(e="pointerdown MSPointerDown",s="pointermove MSPointerMove",a="pointerup pointercancel MSPointerUp MSPointerCancel"):(e="touchstart",s="touchmove",a="touchend touchcancel","ontouchstart"in O&&t.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(e+=" mousedown",s+=" mousemove",a+=" mouseup")),t={},n={mouseout:function(e){var t,n,i,r=ee._focused,o=Q.getRelatedTarget(e);!r||o&&"HTML"!==o.nodeName||(t=(o=Q.getOffset(e,r._element)).x,n=(i=Math.abs)(t),o.x=i(i=n-(1<<25))<n?i*(t<0?-1:1):t,d(r,e,r.viewToProject(o)))},scroll:h},t[e]=function(e){var t=ee._focused=l(e);p||(p=!0,t._handleMouseEvent("mousedown",e))},n[s]=function(e){var t,n=ee._focused;o||((t=l(e))?n!==t&&(n&&d(n,e),i=i||n,n=ee._focused=r=t):r&&r===n&&(i&&!i.isInserted()&&(i=null),n=ee._focused=i,i=null,h())),n&&d(n,e)},n[e]=function(){o=!0},n[a]=function(e){var t=ee._focused;t&&p&&t._handleMouseEvent("mouseup",e),o=p=!1},Q.add(M,n),Q.add(O,{load:h}),g=!1,_=!1,u={doubleclick:"click",mousedrag:"mousemove"},y=!1,c={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}},{_viewEvents:t,_handleMouseEvent:function(e,t,n){var i=this._itemEvents,l=i.native[e],h="mousemove"===e,r=this._scope.tool,d=this;function f(e){return i.virtual[e]||d.responds(e)||r&&r.responds(e)}h&&p&&f("mousedrag")&&(e="mousedrag"),n=n||this.getEventPoint(t);var o=this.getBounds().contains(n),s=l&&o&&d._project.hitTest(n,{tolerance:0,fill:!0,stroke:!0}),s=s&&s.item||null,a=!1,c={};if(c[e.substr(5)]=!0,l&&s!==S&&(S&&m(S,null,"mouseleave",t,n),s&&m(s,null,"mouseenter",t,n),S=s),y^o&&(m(this,null,o?"mouseenter":"mouseleave",t,n),a=!0),!o&&!c.drag||n.equals(b)||(k(this,s,h?e:"mousemove",t,n,b),a=!0),y=o,c.down&&o||c.up&&w){if(k(this,s,e,t,n,w),c.down){if(E=s===x&&Date.now()-T<300,C=x=s,!_&&s){for(var u=s;u&&!u.responds("mousedrag");)u=u._parent;u&&(v=s)}w=n}else c.up&&(_||s!==C||(T=Date.now(),k(this,s,E?"doubleclick":"click",t,n,w),E=!1),C=v=null);a=!(y=!1)}b=n,a&&r&&(g=r._handleMouseEvent(e,t,n,c)||g),!1!==t.cancelable&&(g&&!c.move||c.down&&f("mouseup"))&&t.preventDefault()},_handleKeyEvent:function(t,n,i,r){var o,s=this._scope,e=s.tool;function a(e){e.responds(t)&&(P=s,e.emit(t,o=o||new ie(t,n,i,r)))}this.isVisible()&&(a(this),e&&e.responds(t)&&a(e))},_countItemEvent:function(e,t){var n,i=this._itemEvents,r=i.native,i=i.virtual;for(n in c)r[n]=(r[n]||0)+(c[n][e]||0)*t;i[e]=(i[e]||0)+t},statics:{updateFocus:h,_resetState:function(){p=o=g=y=!1,i=r=w=b=C=S=v=x=T=E=null}}};function l(e){e=Q.getTarget(e);return e.getAttribute&&ee._viewsById[e.getAttribute("id")]}function h(){var e=ee._focused;if(!e||!e.isVisible())for(var t=0,n=ee._views.length;t<n;t++)if((e=ee._views[t]).isVisible()){ee._focused=r=e;break}}function d(e,t,n){e._handleMouseEvent("mousemove",t,n)}function m(e,i,t,r,o,s,n){var a,c=!1;for(;e&&e!==n&&!function e(t,n){if(t.responds(n)){if(a=a||new oe(n,r,o,i||t,s?o.subtract(s):null),t.emit(n,a)&&(g=!0,a.prevented&&(_=!0),a.stopped))return c=!0}else if(n=u[n])return e(t,n)}(e,t);)e=e._parent;return c}function k(e,t,n,i,r,o){return e._project.removeOn(n),_=g=!1,v&&m(v,null,n,i,r,o)||t&&t!==v&&!t.isDescendant(v)&&m(t,null,"mousedrag"===n?"mousemove":n,i,r,o,v)||m(e,v||t||e,n,i,r,o)}})),te=ee.extend({_class:"CanvasView",initialize:function(e,t){if(!(t instanceof O.HTMLCanvasElement)){var n=I.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+F.slice(arguments,1));t=le.getCanvas(n)}var i,n=this._context=t.getContext("2d");n.save(),this._pixelRatio=1,/^off|false$/.test(l.getAttribute(t,"hidpi"))||(i=O.devicePixelRatio||1,n=$.getPrefixed(n,"backingStorePixelRatio")||1,this._pixelRatio=i/n),ee.call(this,e,t),this._needsUpdate=!0},remove:function e(){return this._context.restore(),e.base.call(this)},_setElementSize:function e(t,n){var i,r,o=this._pixelRatio;e.base.call(this,t*o,n*o),1!==o&&(r=this._element,i=this._context,l.hasAttribute(r,"resize")||((r=r.style).width=t+"px",r.height=n+"px"),i.restore(),i.save(),i.scale(o,o))},getContext:function(){return this._context},getPixelSize:function e(t){var n,i,r=P.agent;return r&&r.firefox?n=e.base.call(this,t):(i=(r=this._context).font,r.font=t+" serif",n=parseFloat(r.font),r.font=i),n},getTextWidth:function(e,t){var n=this._context,i=n.font,r=0;n.font=e;for(var o=0,s=t.length;o<s;o++)r=Math.max(r,n.measureText(t[o]).width);return n.font=i,r},update:function(){if(!this._needsUpdate)return!1;var e=this._project,t=this._context;this._viewSize;return e&&e.draw(t,this._matrix,this._pixelRatio),!(this._needsUpdate=!1)}}),ne=F.extend({_class:"Event",initialize:function(e){this.event=e,this.type=e&&e.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return re.modifiers}}),ie=ne.extend({_class:"KeyEvent",initialize:function(e,t,n,i){this.type=e,this.event=t,this.key=n,this.character=i},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),re=new function(){var c,i,n={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},r={tab:"\t",space:" ",enter:"\r"},u={},l={},h=new F({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var e=P&&P.agent;return e&&e.mac?this.meta:this.control}}});function o(e){var t=e.key||e.keyIdentifier,t=/^U\+/.test(t)?String.fromCharCode(parseInt(t.substr(2),16)):/^Arrow[A-Z]/.test(t)?t.substr(5):"Unidentified"===t||t===B?String.fromCharCode(e.keyCode):t;return n[t]||(1<t.length?F.hyphenate(t):t.toLowerCase())}function d(e,t,n,i){var r,o=ee._focused;if((u[t]=e)?l[t]=n:delete l[t],1<t.length&&(r=F.camelize(t))in h){h[r]=e;var s=P&&P.agent;if("meta"===r&&s&&s.mac)if(e)c={};else{for(var a in c)a in l&&d(!1,a,c[a],i);c=null}}else e&&c&&(c[t]=n);o&&o._handleKeyEvent(e?"keydown":"keyup",i,t,n)}return Q.add(M,{keydown:function(e){var t=o(e),n=P&&P.agent;1<t.length||n&&n.chrome&&(e.altKey||n.mac&&e.metaKey||!n.mac&&e.ctrlKey)?d(!0,t,r[t]||(1<t.length?"":t),e):i=t},keypress:function(e){var t,n;i&&(t=o(e),n=32<=(n=e.charCode)?String.fromCharCode(n):1<t.length?"":t,d(!0,t=t!==i?n.toLowerCase():t,n,e),i=null)},keyup:function(e){var t=o(e);t in l&&d(!1,t,l[t],e)}}),Q.add(O,{blur:function(e){for(var t in l)d(!1,t,l[t],e)}}),{modifiers:h,isDown:function(e){return!!u[e]}}},oe=ne.extend({_class:"MouseEvent",initialize:function(e,t,n,i,r){this.type=e,this.event=t,this.point=n,this.target=i,this.delta=r},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),se=ne.extend({_class:"ToolEvent",_item:null,initialize:function(e,t,n){this.tool=e,this.type=t,this.event=n},_choosePoint:function(e,t){return e||(t?t.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){for(var t=e.item,n=t._parent;/^(Group|CompoundPath)$/.test(n._class);)n=(t=n)._parent;this._item=t}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),ae=t.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(e){t.call(this),this._moveCount=-1,this._downCount=-1,this.set(e)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){null!=(this._minDistance=e)&&null!=this._maxDistance&&e>this._maxDistance&&(this._maxDistance=e)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e,null!=this._minDistance&&null!=e&&e<this._minDistance&&(this._minDistance=e)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=this._maxDistance=e},_handleMouseEvent:function(e,t,l,s){P=this._scope,s.drag&&!this.responds(e)&&(e="mousemove");var a=s.move||s.drag,n=this.responds(e),h=this.minDistance,i=this.maxDistance,r=!1,c=this;function o(e,t){var n=l,i=a?c._point:c._downPoint||n;if(a){if(0<=c._moveCount&&n.equals(i))return;if(i&&(null!=e||null!=t)){var r=n.subtract(i),o=r.getLength();if(o<(e||0))return;t&&(n=i.add(r.normalize(Math.min(o,t))))}c._moveCount++}return c._point=n,c._lastPoint=i||n,s.down&&(c._moveCount=-1,c._downPoint=n,c._downCount++),1}function u(){n&&(r=c.emit(e,new se(c,e,t))||r)}if(s.down)o(),u();else if(s.up)o(null,i),u();else if(n)for(;o(h,i);)u();return r}}),ce=F.extend(e,{_class:"Tween",statics:{easings:new F({linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:2*(2-e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}})},initialize:function e(t,n,i,r,o,s){this.object=t;var t=typeof o,a="function"==t,t=(this.type=a?t:"string"==t?o:"linear",this.easing=a?o:e.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null,n||i);this._keys=t?Object.keys(t):[],this._parsedKeys=this._parseKeys(this._keys),this._from=t&&this._getState(n),this._to=t&&this._getState(i),!1!==s&&this.start()},then:function(e){return this._then=e,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){1<=t&&(t=1,this.running=!1);function e(e){return"function"==typeof e?e(n,t):e}for(var n=this.easing(t),i=this._keys,r=0,o=i&&i.length;r<o;r++){var s=i[r],a=e(this._from[s]),c=e(this._to[s]),c=a&&c&&a.__add&&c.__add?c.__subtract(a).__multiply(n).__add(a):(c-a)*n+a;this._setProperty(this._parsedKeys[s],c)}this.responds("update")&&this.emit("update",new F({progress:t,factor:n})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(e){var t=this._startTime,n=t?(e-t)/this.duration:0;t||(this._startTime=e),this.update(n)},_getState:function(e){for(var t=this._keys,n={},i=0,r=t.length;i<r;i++){var o,s=t[i],a=this._parsedKeys[s],c=this._getProperty(a);e?(o=this._resolveValue(c,e[s]),this._setProperty(a,o),o=(o=this._getProperty(a))&&o.clone?o.clone():o,this._setProperty(a,c)):o=c&&c.clone?c.clone():c,n[s]=o}return n},_resolveValue:function(e,t){if(t){if(Array.isArray(t)&&2===t.length)return(n=t[0])&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(e,n[0],t[1]):t;if("string"==typeof t){var n=t.match(/^[+\-*/]=(.*)/);if(n)return n=JSON.parse(n[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": ')),this._calculate(e,t[0],n)}}return t},_calculate:function(e,t,n){return P.PaperScript.calculateBinary(e,t,n)},_parseKeys:function(e){for(var t={},n=0,i=e.length;n<i;n++){var r=e[n],o=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");t[r]=o.split("/")}return t},_getProperty:function(e,t){for(var n=this.object,i=0,r=e.length-(t||0);i<r&&n;i++)n=n[e[i]];return n},_setProperty:function(e,t){var n=this._getProperty(e,1);n&&(n[e[e.length-1]]=t)}}),ue=function(n){var i=new w.XMLHttpRequest;return i.open((n.method||"get").toUpperCase(),n.url,F.pick(n.async,!0)),n.mimeType&&i.overrideMimeType(n.mimeType),i.onload=function(){var e=i.status;0===e||200===e?n.onLoad&&n.onLoad.call(i,i.responseText):i.onerror()},i.onerror=function(){var e=i.status,t='Could not load "'+n.url+'" (Status: '+e+")";if(!n.onError)throw new Error(t);n.onError(t,e)},i.send(null)},le=F.exports.CanvasProvider={canvases:[],getCanvas:function(e,t){if(!O)return null;var n,i=!0,r=("object"==typeof e&&(t=e.height,e=e.width),this.canvases.length?n=this.canvases.pop():(n=M.createElement("canvas"),i=!1),n.getContext("2d"));if(!r)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===e&&n.height===t?i&&r.clearRect(0,0,e+1,t+1):(n.width=e,n.height=t),r.save(),n},getContext:function(e,t){e=this.getCanvas(e,t);return e?e.getContext("2d"):null},release:function(e){e=e&&e.canvas?e.canvas:e;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},he=new function(){var p,g,v,S,m,_,y,x,w,b,C,s=Math.min,a=Math.max,e=Math.abs;function o(e,t,n){return.2989*e+.587*t+.114*n}function t(e,t,n,i){var r=i-o(e,t,n),i=o(w=e+r,b=t+r,C=n+r),e=s(w,b,C),t=a(w,b,C);e<0&&(w=i+(w-i)*i/(n=i-e),b=i+(b-i)*i/n,C=i+(C-i)*i/n),255<t&&(w=i+(w-i)*(r=255-i)/(e=t-i),b=i+(b-i)*r/e,C=i+(C-i)*r/e)}function n(e,t,n){return a(e,t,n)-s(e,t,n)}function i(e,t,n,i){var r=[e,t,n],o=a(e,t,n),n=s(e,t,n),e=0===s(n=n===e?0:n===t?1:2,o=o===e?0:o===t?1:2)?1===a(n,o)?2:1:0;r[o]>r[n]?(r[e]=(r[e]-r[n])*i/(r[o]-r[n]),r[o]=i):r[e]=r[o]=0,r[n]=0,w=r[0],b=r[1],C=r[2]}var T={multiply:function(){w=m*p/255,b=_*g/255,C=y*v/255},screen:function(){w=m+p-m*p/255,b=_+g-_*g/255,C=y+v-y*v/255},overlay:function(){w=m<128?2*m*p/255:255-2*(255-m)*(255-p)/255,b=_<128?2*_*g/255:255-2*(255-_)*(255-g)/255,C=y<128?2*y*v/255:255-2*(255-y)*(255-v)/255},"soft-light":function(){var e=p*m/255;w=e+m*(255-(255-m)*(255-p)/255-e)/255,b=(e=g*_/255)+_*(255-(255-_)*(255-g)/255-e)/255,C=(e=v*y/255)+y*(255-(255-y)*(255-v)/255-e)/255},"hard-light":function(){w=p<128?2*p*m/255:255-2*(255-p)*(255-m)/255,b=g<128?2*g*_/255:255-2*(255-g)*(255-_)/255,C=v<128?2*v*y/255:255-2*(255-v)*(255-y)/255},"color-dodge":function(){w=0===m?0:255===p?255:s(255,255*m/(255-p)),b=0===_?0:255===g?255:s(255,255*_/(255-g)),C=0===y?0:255===v?255:s(255,255*y/(255-v))},"color-burn":function(){w=255===m?255:0===p?0:a(0,255-255*(255-m)/p),b=255===_?255:0===g?0:a(0,255-255*(255-_)/g),C=255===y?255:0===v?0:a(0,255-255*(255-y)/v)},darken:function(){w=m<p?m:p,b=_<g?_:g,C=y<v?y:v},lighten:function(){w=p<m?m:p,b=g<_?_:g,C=v<y?y:v},difference:function(){(w=m-p)<0&&(w=-w),(b=_-g)<0&&(b=-b),(C=y-v)<0&&(C=-C)},exclusion:function(){w=m+p*(255-m-m)/255,b=_+g*(255-_-_)/255,C=y+v*(255-y-y)/255},hue:function(){i(p,g,v,n(m,_,y)),t(w,b,C,o(m,_,y))},saturation:function(){i(m,_,y,n(p,g,v)),t(w,b,C,o(m,_,y))},luminosity:function(){t(m,_,y,o(p,g,v))},color:function(){t(p,g,v,o(m,_,y))},add:function(){w=s(m+p,255),b=s(_+g,255),C=s(y+v,255)},subtract:function(){w=a(m-p,0),b=a(_-g,0),C=a(y-v,0)},average:function(){w=(m+p)/2,b=(_+g)/2,C=(y+v)/2},negation:function(){w=255-e(255-p-m),b=255-e(255-g-_),C=255-e(255-v-y)}},E=this.nativeModes=F.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(e){this[e]=!0},{}),r=le.getContext(1,1);r&&(F.each(T,function(e,t){var n="darken"===t,i=!1;r.save();try{r.fillStyle=n?"#300":"#a00",r.fillRect(0,0,1,1),r.globalCompositeOperation=t,r.globalCompositeOperation===t&&(r.fillStyle=n?"#a00":"#300",r.fillRect(0,0,1,1),i=r.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(e){}r.restore(),E[t]=i}),le.release(r)),this.process=function(e,l,t,h,n){var i=l.canvas,r="normal"===e;if(r||E[e])t.save(),t.setTransform(1,0,0,1,0,0),t.globalAlpha=h,r||(t.globalCompositeOperation=e),t.drawImage(i,n.x,n.y),t.restore();else{var d=T[e];if(d){for(var r=t.getImageData(n.x,n.y,i.width,i.height),o=r.data,s=l.getImageData(0,0,i.width,i.height).data,a=0,f=o.length;a<f;a+=4){p=s[a],m=o[a],g=s[a+1],_=o[a+1],v=s[a+2],y=o[a+2],S=s[a+3],x=o[a+3],d();var c=S*h/255,u=1-c;o[a]=c*w+u*m,o[a+1]=c*b+u*_,o[a+2]=c*C+u*y,o[a+3]=S*h+u*x}t.putImageData(r,n.x,n.y)}}}},de=new function(){var i="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",t="http://www.w3.org/1999/xlink",s={href:t,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function r(e,t,n){for(var i in t){var r=t[i],o=s[i];"number"==typeof r&&n&&(r=n.number(r)),o?e.setAttributeNS(o,i,r):e.setAttribute(i,r)}return e}return{svg:i,xmlns:e,xlink:t,create:function(e,t,n){return r(M.createElementNS(i,e),t,n)},get:function(e,t){var n=s[t];return"null"===(n=n?e.getAttributeNS(n,t):e.getAttribute(t))?null:n},set:r}},fe=F.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(e,t){return!t&&(e instanceof T||e instanceof _||e instanceof D)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(e,t){var n=F.capitalize(t),i=e[2];this[t]={type:e[1],property:t,attribute:e[0],toSVG:i,fromSVG:i&&F.each(i,function(e,t){this[e]=t},{}),exportFilter:e[3],get:"get"+n,set:"set"+n}},{});function pe(e,t,n){var i,r,o=new F,s=e.getTranslation();return t&&(e.isInvertible()?(i=(e=e._shiftless())._inverseTransform(s),s=null):i=new A,o[n?"cx":"x"]=i.x,o[n?"cy":"y"]=i.y),e.isIdentity()||((t=e.decompose())?(n=[],i=t.rotation,r=t.scaling,t=t.skewing,s&&!s.isZero()&&n.push("translate("+p.point(s)+")"),i&&n.push("rotate("+p.number(i)+")"),z.isZero(r.x-1)&&z.isZero(r.y-1)||n.push("scale("+p.point(r)+")"),t.x&&n.push("skewX("+p.number(t.x)+")"),t.y&&n.push("skewY("+p.number(t.y)+")"),o.transform=n.join(" ")):o.transform="matrix("+e.getValues().join(",")+")"),o}function ge(e,t){for(var n=pe(e._matrix),i=e._children,r=de.create("g",n,p),o=0,s=i.length;o<s;o++){var a,c=i[o],u=be(c,t);u&&(c.isClipMask()?((a=de.create("clipPath")).appendChild(u),ye(c,a,"clip"),de.set(r,{"clip-path":"url(#"+a.id+")"})):r.appendChild(u))}return r}function ve(e){var t,n=e._type,i=e._radius,r=pe(e._matrix,!0,"rectangle"!==n);return"rectangle"===n&&(n="rect",t=(e=e._size).width,e=e.height,r.x-=t/2,r.y-=e/2,r.width=t,r.height=e,i.isZero()&&(i=null)),i&&("circle"===n?r.r=i:(r.rx=i.width,r.ry=i.height)),de.create(n,r,p)}function me(r,e,t){var o={},s=!t&&r.getParent(),a=[];return null!=r._name&&(o.id=r._name),F.each(fe,function(e){var t=e.get,n=e.type,i=r[t]();(e.exportFilter?!e.exportFilter(r,i):s&&F.equals(s[t](),i))||("color"!==n||null==i||(t=i.getAlpha())<1&&(o[e.attribute+"-opacity"]=t),"style"===n?a.push(e.attribute+": "+i):o[e.attribute]=null==i?"none":"color"===n?i.gradient?function(e){var t=_e(e,"color");if(!t){for(var n,i,r=e.getGradient(),l=r._radial,o=e.getOrigin(),s=e.getDestination(),h=(l?(n={cx:o.x,cy:o.y,r:o.getDistance(s)},(i=e.getHighlight())&&(n.fx=i.x,n.fy=i.y)):n={x1:o.x,y1:o.y,x2:s.x,y2:s.y},n.gradientUnits="userSpaceOnUse",t=de.create((l?"radial":"linear")+"Gradient",n,p),r._stops),a=0,d=h.length;a<d;a++){var c=h[a],u=c._color,f=u.getAlpha(),c=c._offset;n={offset:null==c?a/(d-1):c},u&&(n["stop-color"]=u.toCSS(!0)),f<1&&(n["stop-opacity"]=f),t.appendChild(de.create("stop",n,p))}ye(e,t,"color")}return"url(#"+t.id+")"}(i):i.toCSS(!0):"array"===n?i.join(","):"lookup"===n?e.toSVG[i]:i)}),a.length&&(o.style=a.join(";")),1===o.opacity&&delete o.opacity,r._visible||(o.visibility="hidden"),de.set(e,o,p)}function _e(e,t){return o=o||{ids:{},svgs:{}},e&&o.svgs[t+"-"+(e._id||e.__id||(e.__id=a.get("svg")))]}function ye(e,t,n){o||_e();var i=o.ids[n]=(o.ids[n]||0)+1;t.id=n+"-"+i,o.svgs[n+"-"+(e._id||e.__id)]=t}function we(e,t){var n=e,i=null;if(o){for(var r in n="svg"===e.nodeName.toLowerCase()&&e,o.svgs)i||(n||(n=de.create("svg")).appendChild(e),i=n.insertBefore(de.create("defs"),n.firstChild)),i.appendChild(o.svgs[r]);o=null}return t.asString?(new w.XMLSerializer).serializeToString(n):n}function be(e,t,n){var i,r=s[e._class],r=r&&r(e,t);return r&&((i=t.onExport)&&(r=i(e,r,t)||r),(i=JSON.stringify(e._data))&&"{}"!==i&&"null"!==i&&r.setAttribute("data-paper-data",i)),r&&me(e,r,n)}function Ce(e){return p=new b((e=e||{}).precision),e}function Se(e,t,n,i,r,o){e=de.get(e,t)||o,o=null==e?i?null:n?"":0:n?e:parseFloat(e);return/%\s*$/.test(e)?o/100*(r?1:f[/x|^width/.test(t)?"width":"height"]):o}function xe(e,t,n,i,r,o,s){return t=Se(e,t||"x",!1,i,r,o),n=Se(e,n||"y",!1,i,r,s),!i||null!=t&&null!=n?new A(t,n):null}function Te(e,t,n,i,r){return t=Se(e,t||"width",!1,i,r),n=Se(e,n||"height",!1,i,r),!i||null!=t&&null!=n?new I(t,n):null}function Ee(e,t,n){return"none"===e?null:"number"===t?parseFloat(e):"array"===t?e?e.split(/[\s,]+/g).map(parseFloat):[]:"color"===t?je(e)||e:"lookup"===t?n[e]:e}function ke(e,t,l,n){var h=e.childNodes,i="clippath"===t,t="defs"===t,r=new m,o=r._project,d=o._currentStyle,f=[];if(i||t||(r=Ae(r,e,n),o._currentStyle=r._style.clone()),n)for(var p=e.querySelectorAll("defs"),s=0,a=p.length;s<a;s++)Le(p[s],l,!1);for(s=0,a=h.length;s<a;s++){var c,u=h[s];1!==u.nodeType||/^defs$/i.test(u.nodeName)||!(c=Le(u,l,!1))||c instanceof S||f.push(c)}return r.addChildren(f),i&&(r=Ae(r.reduce(),e,n)),o._currentStyle=d,(i||t)&&(r.remove(),r=null),r}function Pe(e,t){for(var n=e.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),i=[],r=0,o=n.length;r<o;r+=2)i.push(new A(parseFloat(n[r]),parseFloat(n[r+1])));e=new W(i);return"polygon"===t&&e.closePath(),e}function Oe(e,t){var n,i=(Se(e,"href",!0)||"").substring(1),t="radialgradient"===t;if(i)(n=g[i].getGradient())._radial^t&&((n=n.clone())._radial=t);else{for(var r=e.childNodes,o=[],s=0,l=r.length;s<l;s++){var a=r[s];1===a.nodeType&&o.push(Ae(new Y,a))}n=new Z(o,t)}var c,u,h,i="userSpaceOnUse"!==Se(e,"gradientUnits",!0);return t?(u=(c=xe(e,"cx","cy",!1,i,"50%","50%")).add(Se(e,"r",!1,!1,i,"50%"),0),h=xe(e,"fx","fy",!0,i)):(c=xe(e,"x1","y1",!1,i,"0%","0%"),u=xe(e,"x2","y2",!1,i,"100%","0%")),Ae(new X(n,c,u,h),e)._scaleToBounds=i,null}function Me(e,l,t,n){if(e.transform){for(var i=(n.getAttribute(t)||"").split(/\)\s*/g),r=new R,o=0,s=i.length;o<s;o++){var a=i[o];if(!a)break;for(var a=a.split(/\(\s*/),h=a[0],c=a[1].split(/[\s,]+/g),u=0,d=c.length;u<d;u++)c[u]=parseFloat(c[u]);switch(h){case"matrix":r.append(new R(c[0],c[1],c[2],c[3],c[4],c[5]));break;case"rotate":r.rotate(c[0],c[1]||0,c[2]||0);break;case"translate":r.translate(c[0],c[1]||0);break;case"scale":r.scale(c);break;case"skewX":r.skew(c[0],0);break;case"skewY":r.skew(0,c[0])}}e.transform(r)}}function Ie(e,t,n){n="fill-opacity"===n?"getFillColor":"getStrokeColor",e=e[n]&&e[n]();e&&e.setAlpha(parseFloat(t))}function Re(e,t,n){var i=e.attributes[t],i=i&&i.value;return!i&&e.style&&(t=F.camelize(t),(i=e.style[t])||n.node[t]===n.parent[t]||(i=n.node[t])),i?"none"===i?null:i:B}function Ae(i,r,e){var t=r.parentNode,o={node:$.getStyles(r)||{},parent:!e&&!/^defs$/i.test(t.tagName)&&$.getStyles(t)||{}};return F.each(n,function(e,t){var n=Re(r,t,o);i=n!==B&&e(i,n,t,r,o)||i}),i}function je(e){e=e&&e.match(/\((?:["'#]*)([^"')]+)/),e=e&&e[1],e=e&&g[O?e.replace(O.location.href.split("#")[0]+"#",""):e];return e&&e._scaleToBounds&&((e=e.clone())._scaleToBounds=!0),e}function Le(e,t,n){var i,r,o,s=e.nodeName.toLowerCase(),l="#document"!==s,h=M.body,a=(n&&l&&(f=P.getView().getSize(),f=Te(e,null,null,!0)||f,i=de.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),r=e.parentNode,o=e.nextSibling,i.appendChild(e),h.appendChild(i)),P.settings),d=a.applyMatrix,c=a.insertItems,u=(a.applyMatrix=!1,a.insertItems=!1,v[s]),u=u&&u(e,s,t,n)||null;return a.insertItems=c,a.applyMatrix=d,u&&(!l||u instanceof m||(u=Ae(u,e,n)),s=t.onImport,c=l&&e.getAttribute("data-paper-data"),s&&(u=s(e,u,t)||u),t.expandShapes&&u instanceof _&&(u.remove(),u=u.toPath()),c&&(u._data=JSON.parse(c))),i&&(h.removeChild(i),r&&(o?r.insertBefore(e,o):r.appendChild(e))),n&&(g={},u&&F.pick(t.applyMatrix,d)&&u.matrix.apply(!0,!0)),u}function De(i,r,o){if(!i)return null;r="function"==typeof r?{onLoad:r}:r||{};var e,s=P,a=null;function t(e){try{var t="object"==typeof e?e:(new w.DOMParser).parseFromString(e.trim(),"image/svg+xml");if(!t.nodeName)throw t=null,new Error("Unsupported SVG source: "+i);P=s,a=Le(t,r,!0),r&&!1===r.insert||o._insertItem(B,a);var n=r.onLoad;n&&n(a,e)}catch(e){c(e)}}function c(e,t){var n=r.onError;if(!n)throw new Error(e);n(e,t)}if("string"!=typeof i||/^[\s\S]*</.test(i)){if("undefined"!=typeof File&&i instanceof File)return(e=new FileReader).onload=function(){t(e.result)},e.onerror=function(){c(e.error)},e.readAsText(i);t(i)}else{var n=M.getElementById(i);n?t(n):ue({url:i,async:!0,onLoad:t,onError:c})}return a}s={Group:ge,Layer:ge,Raster:function(e,t){var n=pe(e._matrix,!0),i=e.getSize(),r=e.getImage();return n.x-=i.width/2,n.y-=i.height/2,n.width=i.width,n.height=i.height,n.href=0==t.embedImages&&r&&r.src||e.toDataURL(),de.create("image",n,p)},Path:function(e,t){if(c=t.matchShapes){var n=e.toShape(!1);if(n)return ve(n)}var i=e._segments,r=i.length,n=pe(e._matrix);if(c&&2<=r&&!e.hasHandles())if(2<r){for(var o=e._closed?"polygon":"polyline",s=[],a=0;a<r;a++)s.push(p.point(i[a]._point));n.points=s.join(" ")}else{o="line";var c=i[0]._point,u=i[1]._point;n.set({x1:c.x,y1:c.y,x2:u.x,y2:u.y})}else o="path",n.d=e.getPathData(null,t.precision);return de.create(o,n,p)},Shape:ve,CompoundPath:function(e,t){var n=pe(e._matrix);return(e=e.getPathData(null,t.precision))&&(n.d=e),de.create("path",n,p)},SymbolItem:function(e,t){var n=pe(e._matrix,!0),i=_e(e=e._definition,"symbol"),r=e._item,o=r.getStrokeBounds();return i||((i=de.create("symbol",{viewBox:p.rectangle(o)})).appendChild(be(r,t)),ye(e,i,"symbol")),n.href="#"+i.id,n.x+=o.x,n.y+=o.y,n.width=o.width,n.height=o.height,n.overflow="visible",de.create("use",n,p)},PointText:function(e){var t=de.create("text",pe(e._matrix,!0),p);return t.textContent=e._content,t}},U.inject({exportSVG:function(e){return we(be(this,e=Ce(e),!0),e)}}),c.inject({exportSVG:function(e){e=Ce(e);var t=this._children,n=this.getView(),i=F.pick(e.bounds,"view"),r=e.matrix||"view"===i&&n._matrix,r=r&&R.read([r]),n="view"===i?new C([0,0],n.getViewSize()):"content"===i?U._getBounds(t,r,{stroke:!0}).rect:C.read([i],0,{readNull:!0}),i={version:"1.1",xmlns:de.svg,"xmlns:xlink":de.xlink},n=(n&&(i.width=n.width,i.height=n.height,(n.x||0===n.x||n.y||0===n.y)&&(i.viewBox=p.rectangle(n))),de.create("svg",i,p)),o=n;r&&!r.isIdentity()&&(o=n.appendChild(de.create("g",pe(r),p)));for(var s=0,a=t.length;s<a;s++)o.appendChild(be(t[s],e,!0));return we(n,e)}}),g={},v={"#document":function(e,t,n,i){for(var r=e.childNodes,o=0,s=r.length;o<s;o++){var a=r[o];if(1===a.nodeType)return Le(a,n,i)}},g:ke,svg:ke,clippath:ke,polygon:Pe,polyline:Pe,path:function(e){return T.create(e.getAttribute("d"))},lineargradient:Oe,radialgradient:Oe,image:function(t){var e=new d(Se(t,"href",!0));return e.on("load",function(){var e=Te(t),e=(this.setSize(e),xe(t).add(e.divide(2)));this._matrix.append((new R).translate(e))}),e},symbol:function(e,t,n,i){return new S(ke(e,t,n,i),!0)},defs:ke,use:function(e){var t=(Se(e,"href",!0)||"").substring(1),t=g[t],e=xe(e);return t?t instanceof S?t.place(e):t.clone().translate(e):null},circle:function(e){return new _.Circle(xe(e,"cx","cy"),Se(e,"r"))},ellipse:function(e){return new _.Ellipse({center:xe(e,"cx","cy"),radius:Te(e,"rx","ry")})},rect:function(e){return new _.Rectangle(new C(xe(e),Te(e)),Te(e,"rx","ry"))},line:function(e){return new W.Line(xe(e,"x1","y1"),xe(e,"x2","y2"))},text:function(e){var t=new N(xe(e).add(xe(e,"dx","dy")));return t.setContent(e.textContent.trim()||""),t},switch:ke},n=F.set(F.each(fe,function(n){this[n.attribute]=function(e,t){e[n.set]&&(e[n.set](Ee(t,n.type,n.fromSVG)),"color"!==n.type||(t=e[n.get]())&&t._scaleToBounds&&(e=e.getBounds(),t.transform((new R).translate(e.getPoint()).scale(e.getSize()))))}},{}),{id:function(e,t){(g[t]=e).setName&&e.setName(t)},"clip-path":function(e,t){t=je(t);if(t){if((t=t.clone()).setClipMask(!0),!(e instanceof m))return new m(t,e);e.insertChild(0,t)}},gradientTransform:Me,transform:Me,"fill-opacity":Ie,"stroke-opacity":Ie,visibility:function(e,t){e.setVisible&&e.setVisible("visible"===t)},display:function(e,t){e.setVisible&&e.setVisible(null!==t)},"stop-color":function(e,t){e.setColor&&e.setColor(t)},"stop-opacity":function(e,t){e._color&&e._color.setAlpha(parseFloat(t))},offset:function(e,t){var n;e.setOffset&&(n=t.match(/(.*)%$/),e.setOffset(n?n[1]/100:parseFloat(t)))},viewBox:function(e,t,n,i,r){var o,s,t=new C(Ee(t,"array")),a=Te(i,null,null,!0);e instanceof m?(o=a?a.divide(t.getSize()):1,o=(new R).scale(o).translate(t.getPoint().negate()),s=e):e instanceof S&&(a&&t.setSize(a),s=e._item),s&&("visible"!==Re(i,"overflow",r)&&((a=new _.Rectangle(t)).setClipMask(!0),s.addChild(a)),o&&s.transform(o))}}),U.inject({importSVG:function(e,t){return De(e,t,this)}}),c.inject({importSVG:function(e,t){return this.activate(),De(e,t,this)}}),F.exports.PaperScript=function(){var e,t,n=this,i=n.acorn;if(!i&&"undefined"!=typeof require)try{i=require("acorn")}catch(e){}function m(e,t){return(n.acorn||i).parse(e,t)}i||(i=r={},e=this,t=function(e){"use strict";e.version="0.5.0",e.parse=function(e,t){p=String(e),b=p.length,o(t),Ze();var e=f.program,n=(O=M=d,f.locations&&(s=new Xe),I=R=null,h=[],et(),e||ht()),i=!0;for(e||(n.body=[]);v!==a;){var r=bt();n.body.push(r),i&&ft(r)&&ct(!0),i=!1}return y(n,"Program")};var f,p,b,n,i=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function o(e){for(var t in f=e||{},i)Object.prototype.hasOwnProperty.call(f,t)||(f[t]=i[t]);n=f.sourceFile||null}var d,g,C,S,x,v,T,E,k,P,O,M,s,I,h,R,r=e.getLineInfo=function(e,t){for(var n=1,i=0;;){qe.lastIndex=i;var r=qe.exec(e);if(!(r&&r.index<t))break;++n,i=r.index+r[0].length}return{line:n,column:t-i}};function m(e,t){var n=r(p,e),t=(t+=" ("+n.line+":"+n.column+")",new SyntaxError(t));throw t.pos=e,t.loc=n,t.raisedAt=d,t}e.tokenize=function(e,t){p=String(e),b=p.length,o(t),Ze();var n={};function i(e){return M=C,et(e),n.start=g,n.end=C,n.startLoc=S,n.endLoc=x,n.type=v,n.value=T,n}return i.jumpTo=function(e,t){var n;if(d=e,f.locations)for(k=1,P=qe.lastIndex=0;(n=qe.exec(p))&&n.index<e;)++k,P=n.index+n[0].length;E=t,$e()},i};var t,A=[],j={type:"num"},L={type:"regexp"},D={type:"string"},N={type:"name"},a={type:"eof"},B={keyword:"break"},F={keyword:"case",beforeExpr:!0},z={keyword:"catch"},U={keyword:"continue"},H={keyword:"debugger"},G={keyword:"default"},V={keyword:"do",isLoop:!0},q={keyword:"else",beforeExpr:!0},W={keyword:"finally"},J={keyword:"for",isLoop:!0},X={keyword:"function"},Z={keyword:"if"},Y={keyword:"return",beforeExpr:!0},K={keyword:"switch"},$={keyword:"throw",beforeExpr:!0},Q={keyword:"try"},ee={keyword:"var"},te={keyword:"while",isLoop:!0},ne={keyword:"with"},ie={keyword:"new",beforeExpr:!0},re={keyword:"this"},oe={keyword:"null",atomValue:null},se={keyword:"true",atomValue:!0},ae={keyword:"false",atomValue:!1},ce={keyword:"in",binop:7,beforeExpr:!0},c={break:B,case:F,catch:z,continue:U,debugger:H,default:G,do:V,else:q,finally:W,for:J,function:X,if:Z,return:Y,switch:K,throw:$,try:Q,var:ee,while:te,with:ne,null:oe,true:se,false:ae,new:ie,in:ce,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:re,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ue={type:"[",beforeExpr:!0},le={type:"]"},he={type:"{",beforeExpr:!0},de={type:"}"},fe={type:"(",beforeExpr:!0},pe={type:")"},ge={type:",",beforeExpr:!0},ve={type:";",beforeExpr:!0},me={type:":",beforeExpr:!0},_e={type:"."},ye={type:"?",beforeExpr:!0},we={binop:10,beforeExpr:!0},be={isAssign:!0,beforeExpr:!0},Ce={isAssign:!0,beforeExpr:!0},Se={postfix:!0,prefix:!0,isUpdate:!0},xe={prefix:!0,beforeExpr:!0},Te={binop:1,beforeExpr:!0},Ee={binop:2,beforeExpr:!0},ke={binop:3,beforeExpr:!0},Pe={binop:4,beforeExpr:!0},Oe={binop:5,beforeExpr:!0},Me={binop:6,beforeExpr:!0},Ie={binop:7,beforeExpr:!0},Re={binop:8,beforeExpr:!0},Ae={binop:9,prefix:!0,beforeExpr:!0},je={binop:10,beforeExpr:!0};for(t in e.tokTypes={bracketL:ue,bracketR:le,braceL:he,braceR:de,parenL:fe,parenR:pe,comma:ge,semi:ve,colon:me,dot:_e,question:ye,slash:we,eq:be,name:N,eof:a,num:j,regexp:L,string:D},c)e.tokTypes["_"+t]=c[t];function u(e){e=e.split(" ");var n="",t=[];e:for(var i=0;i<e.length;++i){for(var r=0;r<t.length;++r)if(t[r][0].length==e[i].length){t[r].push(e[i]);continue e}t.push([e[i]])}function o(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var t=0;t<e.length;++t)n+="case "+JSON.stringify(e[t])+":";n+="return true}return false;"}if(3<t.length){t.sort(function(e,t){return t.length-e.length}),n+="switch(str.length){";for(i=0;i<t.length;++i){var s=t[i];n+="case "+s[0].length+":",o(s)}n+="}"}else o(e);return new Function("str",n)}var l,Le=u("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),De=u("class enum extends super const export import"),Ne=u("implements interface let package private protected public static yield"),Be=u("eval arguments"),Fe=u("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),ze=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ue="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",He=new RegExp("["+Ue+"]"),Ge=new RegExp("["+Ue+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),Ve=/[\n\r\u2028\u2029]/,qe=/\r\n|[\n\r\u2028\u2029]/g,We=e.isIdentifierStart=function(e){return e<65?36===e:e<91||(e<97?95===e:e<123||170<=e&&He.test(String.fromCharCode(e)))},Je=e.isIdentifierChar=function(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||170<=e&&Ge.test(String.fromCharCode(e))))};function Xe(){this.line=k,this.column=d-P}function Ze(){k=1,d=P=0,E=!0,$e()}function Ye(e,t){C=d,f.locations&&(x=new Xe),v=e,$e(),T=t,E=e.beforeExpr}function Ke(){for(var e=d,t=f.onComment&&f.locations&&new Xe,n=p.charCodeAt(d+=2);d<b&&10!==n&&13!==n&&8232!==n&&8233!==n;)++d,n=p.charCodeAt(d);f.onComment&&f.onComment(!1,p.slice(e+2,d),e,d,t,f.locations&&new Xe)}function $e(){for(;d<b;){var e,t=p.charCodeAt(d);if(32===t)++d;else if(13===t)++d,10===(e=p.charCodeAt(d))&&++d,f.locations&&(++k,P=d);else if(10===t||8232===t||8233===t)++d,f.locations&&(++k,P=d);else if(8<t&&t<14)++d;else if(47===t)if(42===(e=p.charCodeAt(d+1))){n=o=r=i=void 0;var n,i=f.onComment&&f.locations&&new Xe,r=d,o=p.indexOf("*/",d+=2);if(-1===o&&m(d-2,"Unterminated comment"),d=o+2,f.locations)for(qe.lastIndex=r;(n=qe.exec(p))&&n.index<d;)++k,P=n.index+n[0].length;f.onComment&&f.onComment(!0,p.slice(r+2,o),r,d,i,f.locations&&new Xe)}else{if(47!==e)break;Ke()}else if(160===t)++d;else{if(!(5760<=t&&ze.test(String.fromCharCode(t))))break;++d}}}function Qe(e){switch(e){case 46:return 48<=(u=p.charCodeAt(d+1))&&u<=57?rt(!0):(++d,Ye(_e));case 40:return++d,Ye(fe);case 41:return++d,Ye(pe);case 59:return++d,Ye(ve);case 44:return++d,Ye(ge);case 91:return++d,Ye(ue);case 93:return++d,Ye(le);case 123:return++d,Ye(he);case 125:return++d,Ye(de);case 58:return++d,Ye(me);case 63:return++d,Ye(ye);case 48:u=p.charCodeAt(d+1);if(120===u||88===u){d+=2;var t=it(16);null==t&&m(g+2,"Expected hexadecimal number");We(p.charCodeAt(d))&&m(d,"Identifier directly after number");return Ye(j,t);return}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return rt(!1);case 34:case 39:var l=e;d++;for(var n="";;){b<=d&&m(g,"Unterminated string constant");var i=p.charCodeAt(d);if(i===l)return++d,Ye(D,n);if(92===i){i=p.charCodeAt(++d);var r=/^[0-7]+/.exec(p.slice(d,d+3));for(r=r&&r[0];r&&255<parseInt(r,8);)r=r.slice(0,-1);if(++d,r="0"===r?null:r)R&&m(d-2,"Octal literal in strict mode"),n+=String.fromCharCode(parseInt(r,8)),d+=r.length-1;else switch(i){case 110:n+="\n";break;case 114:n+="\r";break;case 120:n+=String.fromCharCode(ot(2));break;case 117:n+=String.fromCharCode(ot(4));break;case 85:n+=String.fromCharCode(ot(8));break;case 116:n+="\t";break;case 98:n+="\b";break;case 118:n+="\v";break;case 102:n+="\f";break;case 48:n+="\0";break;case 13:10===p.charCodeAt(d)&&++d;case 10:f.locations&&(P=d,++k);break;default:n+=String.fromCharCode(i)}}else 13!==i&&10!==i&&8232!==i&&8233!==i||m(g,"Unterminated string constant"),n+=String.fromCharCode(i),++d}return;case 47:return t=p.charCodeAt(d+1),E?(++d,nt()):61===t?tt(Ce,2):tt(we,1);case 37:case 42:return 61===p.charCodeAt(d+1)?tt(Ce,2):tt(je,1);case 124:case 38:return c=e,(h=p.charCodeAt(d+1))===c?tt(124===c?Te:Ee,2):61===h?tt(Ce,2):tt(124===c?ke:Oe,1);case 94:return 61===p.charCodeAt(d+1)?tt(Ce,2):tt(Pe,1);case 43:case 45:return h=e,(c=p.charCodeAt(d+1))===h?45==c&&62==p.charCodeAt(d+2)&&Ve.test(p.slice(M,d))?(d+=3,Ke(),$e(),et()):tt(Se,2):61===c?tt(Ce,2):tt(Ae,1);case 60:case 62:return o=e,s=p.charCodeAt(d+1),a=1,s===o?(a=62===o&&62===p.charCodeAt(d+2)?3:2,61===p.charCodeAt(d+a)?tt(Ce,a+1):tt(Re,a)):33==s&&60==o&&45==p.charCodeAt(d+2)&&45==p.charCodeAt(d+3)?(d+=4,Ke(),$e(),et()):(61===s&&(a=61===p.charCodeAt(d+2)?3:2),tt(Ie,a));case 61:case 33:return o=e,61===p.charCodeAt(d+1)?tt(Me,61===p.charCodeAt(d+2)?3:2):tt(61===o?be:xe,1);case 126:return tt(xe,1)}var o,s,a,c,h,u;return!1}function et(e){if(e?d=g+1:g=d,f.locations&&(S=new Xe),e)return nt();if(b<=d)return Ye(a);e=p.charCodeAt(d);if(We(e)||92===e)return at();var t=Qe(e);if(!1===t){e=String.fromCharCode(e);if("\\"===e||He.test(e))return at();m(d,"Unexpected character '"+e+"'")}return t}function tt(e,t){var n=p.slice(d,d+t);d+=t,Ye(e,n)}function nt(){for(var e,t,n=d;;){b<=d&&m(n,"Unterminated regular expression");var i=p.charAt(d);if(Ve.test(i)&&m(n,"Unterminated regular expression"),e)e=!1;else{if("["===i)t=!0;else if("]"===i&&t)t=!1;else if("/"===i&&!t)break;e="\\"===i}++d}var r=p.slice(n,d),o=(++d,st());o&&!/^[gmsiy]*$/.test(o)&&m(n,"Invalid regexp flag");try{var s=new RegExp(r,o)}catch(e){e instanceof SyntaxError&&m(n,e.message),m(e)}return Ye(L,s)}function it(e,t){for(var n=d,i=0,r=0,o=null==t?1/0:t;r<o;++r){var s=p.charCodeAt(d),s=97<=s?s-97+10:65<=s?s-65+10:48<=s&&s<=57?s-48:1/0;if(e<=s)break;++d,i=i*e+s}return d===n||null!=t&&d-n!==t?null:i}function rt(e){var t,n=d,i=!1,r=48===p.charCodeAt(d),e=(e||null!==it(10)||m(n,"Invalid number"),46===p.charCodeAt(d)&&(++d,it(10),i=!0),p.charCodeAt(d)),e=(69!==e&&101!==e||(43!==(e=p.charCodeAt(++d))&&45!==e||++d,null===it(10)&&m(n,"Invalid number"),i=!0),We(p.charCodeAt(d))&&m(d,"Identifier directly after number"),p.slice(n,d));return i?t=parseFloat(e):r&&1!==e.length?/[89]/.test(e)||R?m(n,"Invalid number"):t=parseInt(e,8):t=parseInt(e,10),Ye(j,t)}function ot(e){e=it(16,e);return null===e&&m(g,"Bad character escape sequence"),e}function st(){for(var e,t=!(l=!1),n=d;;){var i=p.charCodeAt(d);if(Je(i))l&&(e+=p.charAt(d)),++d;else{if(92!==i)break;l||(e=p.slice(n,d)),l=!0,117!=p.charCodeAt(++d)&&m(d,"Expecting Unicode escape sequence \\uXXXX"),++d;var i=ot(4),r=String.fromCharCode(i);r||m(d-1,"Invalid Unicode escape"),(t?We:Je)(i)||m(d-4,"Invalid Unicode escape"),e+=r}t=!1}return l?e:p.slice(n,d)}function at(){var e=st(),t=N;return Ye(t=!l&&Fe(e)?c[e]:t,e)}function _(){O=g,M=C,s=x,et()}function ct(e){if(R=e,d=g,f.locations)for(;d<P;)P=p.lastIndexOf("\n",P-2)+1,--k;$e(),et()}function ut(){this.type=null,this.start=g,this.end=null}function lt(){this.start=S,(this.end=null)!==n&&(this.source=n)}function ht(){var e=new ut;return f.locations&&(e.loc=new lt),f.directSourceFile&&(e.sourceFile=f.directSourceFile),f.ranges&&(e.range=[g,0]),e}function dt(e){var t=new ut;return t.start=e.start,f.locations&&(t.loc=new lt,t.loc.start=e.loc.start),f.ranges&&(t.range=[e.range[0],0]),t}function y(e,t){return e.type=t,e.end=M,f.locations&&(e.loc.end=s),f.ranges&&(e.range[1]=M),e}function ft(e){return 5<=f.ecmaVersion&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function w(e){return v===e&&(_(),1)}function pt(){return!f.strictSemicolons&&(v===a||v===de||Ve.test(p.slice(M,g)))}function gt(){w(ve)||pt()||mt()}function vt(e){(v===e?_:mt)()}function mt(){m(g,"Unexpected token")}function _t(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&m(e.start,"Assigning to rvalue"),R&&"Identifier"===e.type&&Be(e.name)&&m(e.start,"Assigning to "+e.name+" in strict mode")}var yt={kind:"loop"},wt={kind:"switch"};function bt(){(v===we||v===Ce&&"/="==T)&&et(!0);var e,t,l,n=v,i=ht();switch(n){case B:case U:_();var r=n===B;w(ve)||pt()?i.label=null:v!==N?mt():(i.label=Lt(),gt());for(var o=0;o<h.length;++o){var s=h[o];if(null==i.label||s.name===i.label.name){if(null!=s.kind&&(r||"loop"===s.kind))break;if(i.label&&r)break}}return o===h.length&&m(i.start,"Unsyntactic "+n.keyword),y(i,r?"BreakStatement":"ContinueStatement");case H:return _(),gt(),y(i,"DebuggerStatement");case V:return _(),h.push(yt),i.body=bt(),h.pop(),vt(te),i.test=Ct(),gt(),y(i,"DoWhileStatement");case J:if(_(),h.push(yt),vt(fe),v===ve)return xt(i,null);if(v===ee)return a=ht(),_(),Et(a,!0),y(a,"VariableDeclaration"),(1===a.declarations.length&&w(ce)?Tt:xt)(i,a);var a=kt(!1,!0);return w(ce)?(_t(a),Tt(i,a)):xt(i,a);case X:return _(),At(i,!0);case Z:return _(),i.test=Ct(),i.consequent=bt(),i.alternate=w(q)?bt():null,y(i,"IfStatement");case Y:return I||f.allowReturnOutsideFunction||m(g,"'return' outside of function"),_(),w(ve)||pt()?i.argument=null:(i.argument=kt(),gt()),y(i,"ReturnStatement");case K:_(),i.discriminant=Ct(),i.cases=[],vt(he),h.push(wt);for(;v!=de;)v===F||v===G?(l=v===F,e&&y(e,"SwitchCase"),i.cases.push(e=ht()),e.consequent=[],_(),l?e.test=kt():(t&&m(O,"Multiple default clauses"),t=!0,e.test=null),vt(me)):(e||mt(),e.consequent.push(bt()));return e&&y(e,"SwitchCase"),_(),h.pop(),y(i,"SwitchStatement");case $:return _(),Ve.test(p.slice(M,g))&&m(M,"Illegal newline after throw"),i.argument=kt(),gt(),y(i,"ThrowStatement");case Q:return _(),i.block=St(),i.handler=null,v===z&&(a=ht(),_(),vt(fe),a.param=Lt(),R&&Be(a.param.name)&&m(a.param.start,"Binding "+a.param.name+" in strict mode"),vt(pe),a.guard=null,a.body=St(),i.handler=y(a,"CatchClause")),i.guardedHandlers=A,i.finalizer=w(W)?St():null,i.handler||i.finalizer||m(i.start,"Missing catch or finally clause"),y(i,"TryStatement");case ee:return _(),Et(i),gt(),y(i,"VariableDeclaration");case te:return _(),i.test=Ct(),h.push(yt),i.body=bt(),h.pop(),y(i,"WhileStatement");case ne:return R&&m(g,"'with' in strict mode"),_(),i.object=Ct(),i.body=bt(),y(i,"WithStatement");case he:return St();case ve:return _(),y(i,"EmptyStatement");default:var c=T,u=kt();if(n===N&&"Identifier"===u.type&&w(me)){for(o=0;o<h.length;++o)h[o].name===c&&m(u.start,"Label '"+c+"' is already declared");a=v.isLoop?"loop":v===K?"switch":null;return h.push({name:c,kind:a}),i.body=bt(),h.pop(),i.label=u,y(i,"LabeledStatement")}return i.expression=u,gt(),y(i,"ExpressionStatement")}}function Ct(){vt(fe);var e=kt();return vt(pe),e}function St(e){var t,n=ht(),i=!0,r=!1;for(n.body=[],vt(he);!w(de);){var o=bt();n.body.push(o),i&&e&&ft(o)&&(t=r,ct(r=!0)),i=!1}return r&&!t&&ct(!1),y(n,"BlockStatement")}function xt(e,t){return e.init=t,vt(ve),e.test=v===ve?null:kt(),vt(ve),e.update=v===pe?null:kt(),vt(pe),e.body=bt(),h.pop(),y(e,"ForStatement")}function Tt(e,t){return e.left=t,e.right=kt(),vt(pe),e.body=bt(),h.pop(),y(e,"ForInStatement")}function Et(e,t){for(e.declarations=[],e.kind="var";;){var n=ht();if(n.id=Lt(),R&&Be(n.id.name)&&m(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=w(be)?kt(!0,t):null,e.declarations.push(y(n,"VariableDeclarator")),!w(ge))break}return e}function kt(e,t){var n=Pt(t);if(e||v!==ge)return n;var i=dt(n);for(i.expressions=[n];w(ge);)i.expressions.push(Pt(t));return y(i,"SequenceExpression")}function Pt(e){var t,n=function(e){var t=function(e){return function e(t,n,i){var r=v.binop;if(null!=r&&(!i||v!==ce)){var o,s;if(n<r)return(o=dt(t)).left=t,o.operator=T,s=v,_(),o.right=e(Ot(),r,i),r=y(o,s===Te||s===Ee?"LogicalExpression":"BinaryExpression"),e(r,n,i)}return t}(Ot(),-1,e)}(e);{var n;if(w(ye))return(n=dt(t)).test=t,n.consequent=kt(!0),vt(me),n.alternate=kt(!0,e),y(n,"ConditionalExpression")}return t}(e);return v.isAssign?((t=dt(n)).operator=T,t.left=n,_(),t.right=Pt(e),_t(n),y(t,"AssignmentExpression")):n}function Ot(){var e;if(v.prefix)return t=ht(),e=v.isUpdate,t.operator=T,t.prefix=!0,E=!0,_(),t.argument=Ot(),e?_t(t.argument):R&&"delete"===t.operator&&"Identifier"===t.argument.type&&m(t.start,"Deleting local variable in strict mode"),y(t,e?"UpdateExpression":"UnaryExpression");for(var t,n=Mt(It());v.postfix&&!pt();)(t=dt(n)).operator=T,t.prefix=!1,_t(t.argument=n),_(),n=y(t,"UpdateExpression");return n}function Mt(e,t){var n;return w(_e)?((n=dt(e)).object=e,n.property=Lt(!0),n.computed=!1,Mt(y(n,"MemberExpression"),t)):w(ue)?((n=dt(e)).object=e,n.property=kt(),n.computed=!0,vt(le),Mt(y(n,"MemberExpression"),t)):t||!w(fe)?e:((n=dt(e)).callee=e,n.arguments=jt(pe,!1),Mt(y(n,"CallExpression"),t))}function It(){switch(v){case re:var e=ht();return _(),y(e,"ThisExpression");case N:return Lt();case j:case D:case L:return(e=ht()).value=T,e.raw=p.slice(g,C),_(),y(e,"Literal");case oe:case se:case ae:return(e=ht()).value=v.atomValue,e.raw=v.keyword,_(),y(e,"Literal");case fe:var t=S,n=g,i=(_(),kt());return i.start=n,i.end=C,f.locations&&(i.loc.start=t,i.loc.end=x),f.ranges&&(i.range=[n,C]),vt(pe),i;case ue:e=ht();return _(),e.elements=jt(le,!0,!0),y(e,"ArrayExpression");case he:var r=ht(),l=!0,h=!1;for(r.properties=[],_();!w(de);){if(l)l=!1;else if(vt(ge),f.allowTrailingCommas&&w(de))break;var o,s={key:Rt()},d=!1;if(w(me)?(s.value=kt(!0),o=s.kind="init"):5<=f.ecmaVersion&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(d=h=!0,o=s.kind=s.key.name,s.key=Rt(),v!==fe&&mt(),s.value=At(ht(),!1)):mt(),"Identifier"===s.key.type&&(R||h))for(var a=0;a<r.properties.length;++a){var c,u=r.properties[a];u.key.name!==s.key.name||(c=(c=o==u.kind||d&&"init"===u.kind||"init"===o&&("get"===u.kind||"set"===u.kind))&&!R&&"init"===o&&"init"===u.kind?!1:c)&&m(s.key.start,"Redefinition of property")}r.properties.push(s)}return y(r,"ObjectExpression");case X:e=ht();return _(),At(e,!1);case ie:t=ht();return _(),t.callee=Mt(It(),!0),w(fe)?t.arguments=jt(pe,!1):t.arguments=A,y(t,"NewExpression");default:mt()}}function Rt(){return v===j||v===D?It():Lt(!0)}function At(e,t){v===N?e.id=Lt():t?mt():e.id=null,e.params=[];var n=!0;for(vt(fe);!w(pe);)n?n=!1:vt(ge),e.params.push(Lt());var i=I,r=h;if(I=!0,h=[],e.body=St(!0),I=i,h=r,R||e.body.body.length&&ft(e.body.body[0]))for(var o=e.id?-1:0;o<e.params.length;++o){var s=o<0?e.id:e.params[o];if((Ne(s.name)||Be(s.name))&&m(s.start,"Defining '"+s.name+"' in strict mode"),0<=o)for(var a=0;a<o;++a)s.name===e.params[a].name&&m(s.start,"Argument name clash in strict mode")}return y(e,t?"FunctionDeclaration":"FunctionExpression")}function jt(e,t,n){for(var i=[],r=!0;!w(e);){if(r)r=!1;else if(vt(ge),t&&f.allowTrailingCommas&&w(e))break;n&&v===ge?i.push(null):i.push(kt(!0))}return i}function Lt(e){var t=ht();return e&&"everywhere"==f.forbidReserved&&(e=!1),v===N?(!e&&(f.forbidReserved&&(3===f.ecmaVersion?Le:De)(T)||R&&Ne(T))&&-1==p.slice(g,C).indexOf("\\")&&m(g,"The keyword '"+T+"' is reserved"),t.name=T):e&&v.keyword?t.name=v.keyword:mt(),E=!1,_(),y(t,"Identifier")}},"object"==typeof r&&"object"==typeof r?t(r):"function"==typeof define&&define.amd?define(["exports"],t):t(e.acorn||(e.acorn={})),i.version||(i=null));var _={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},y={"-":"__negate","+":"__self"},r=F.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(e){this["__"+e]="#"+e},{__self:function(){return this}});function p(e,t,n){var i=_[t];if(e&&e[i])return i=e[i](n),"!="===t?!i:i;switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"%":return e%n;case"==":return e==n;case"!=":return e!=n}}function g(e,t){var n=y[e];if(t&&t[n])return t[n]();switch(e){case"+":return+t;case"-":return-t}}function v(c,e){if(!c)return"";var o=[];function u(e){for(var t=0,n=o.length;t<n;t++){var i=o[t];if(i[0]>=e)break;e+=i[1]}return e}function h(e){return c.substring(u(e.range[0]),u(e.range[1]))}function d(e,t){for(var n=u(e.range[0]),e=u(e.range[1]),i=0,r=o.length-1;0<=r;r--)if(n>o[r][0]){i=r+1;break}o.splice(i,0,[n,t.length-e+n]),c=c.substring(0,n)+t+c.substring(e)}function f(e,t){switch(e.type){case"UnaryExpression":e.operator in y&&"Literal"!==e.argument.type&&(n=h(e.argument),d(e,'$__("'+e.operator+'", '+n+")"));break;case"BinaryExpression":e.operator in _&&"Literal"!==e.left.type&&(i=h(e.left),r=h(e.right),s=e.left,a=e.right,s=c.substring(u(s.range[1]),u(a.range[0])),a=e.operator,d(e,"__$__("+i+","+s.replace(new RegExp("\\"+a),'"'+a+'"')+", "+r+")"));break;case"UpdateExpression":case"AssignmentExpression":var n,i,r,o,s=t&&t.type;"ForStatement"===s||"BinaryExpression"===s&&/^[=!<>]/.test(t.operator)||"MemberExpression"===s&&t.computed||("UpdateExpression"===e.type?(a=(n=h(e.argument))+" = "+(o="__$__("+n+', "'+e.operator[0]+'", 1)'),e.prefix?a="("+a+")":"AssignmentExpression"!==s&&"VariableDeclarator"!==s&&"BinaryExpression"!==s||(a=n+"; "+(a=h(t.left||t.id)===n?o:a)),d(e,a)):/^.=$/.test(e.operator)&&"Literal"!==e.left.type&&(i=h(e.left),r=h(e.right),o=i+" = __$__("+i+', "'+e.operator[0]+'", '+r+")",d(e,/^\(.*\)$/.test(h(e))?"("+o+")":o)))}var s,a}function p(e,t,n){if(e){for(var i in e)if("range"!==i&&"loc"!==i){var r=e[i];if(Array.isArray(r))for(var o=0,l=r.length;o<l;o++)p(r[o],e,n);else r&&"object"==typeof r&&p(r,e,n)}if(!1!==n.operatorOverloading&&f(e,t),!1!==n.moduleExports){var s=e;switch(s.type){case"ExportDefaultDeclaration":d({range:[s.start,s.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var a,c=s.declaration,u=s.specifiers;c?(a=c.declarations)&&(a.forEach(function(e){d(e,"module.exports."+h(e))}),d({range:[s.start,c.start+c.kind.length]},"")):!u||(a=u.map(function(e){e=h(e);return"module.exports."+e+" = "+e+"; "}).join(""))&&d(s,a)}}}}var t,n=(e=e||{}).url||"",s=e.sourceMaps,a=e.paperFeatures||{},l=e.source||c,e=e.offset||0,i=P.agent,r=i.versionNumber,g=!1,v=/\r\n|\n|\r/gm;return s&&(i.chrome&&30<=r||i.webkit&&537.76<=r||i.firefox&&23<=r||i.node)&&(i.node?e-=2:O&&n&&!O.location.href.indexOf(n)&&(e=(t=M.getElementsByTagName("html")[0].innerHTML).substr(0,t.indexOf(c)+1).match(v).length+1),(t=["AA"+function(e){var t="";for(e=(Math.abs(e)<<1)+(e<0?1:0);e||!t;){var n=31&e;(e>>=5)&&(n|=32),t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n]}return t}((g=0<e&&!(i.chrome&&36<=r||i.safari&&600<=r||i.firefox&&40<=r||i.node))?0:e)+"A"]).length=(c.match(v)||[]).length+1+(g?e:0),t={version:3,file:n,names:[],mappings:t.join(";AACA"),sourceRoot:"",sources:[n],sourcesContent:[l]}),!1===a.operatorOverloading&&!1===a.moduleExports||p(m(c,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,a),t&&(g&&(c=new Array(e+1).join("\n")+c),/^(inline|both)$/.test(s)&&(c+="\n//# sourceMappingURL=data:application/json;base64,"+w.btoa(unescape(encodeURIComponent(JSON.stringify(t))))),c+="\n//# sourceURL="+(n||"paperscript")),{url:n,source:l,code:c,map:t}}function a(i,e,t){var n,r=(P=e).getView(),o=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(i)&&!/\bnew\s+Tool\b/.test(i)?new ae:null,l=o?o._events:[],s=["onFrame","onResize"].concat(l),a=[],h=[],t="object"==typeof i?i:v(i,t);function d(e,t){for(var n in e)!t&&/^_/.test(n)||!new RegExp("([\\b\\s\\W]|^)"+n.replace(/\$/g,"\\$")+"\\b").test(i)||(a.push(n),h.push(e[n]))}i=t.code,d({__$__:p,$__:g,paper:e,tool:o},!0),d(e),i="var module = { exports: {} }; "+i;var c,f,t=F.each(s,function(e){new RegExp("\\s+"+e+"\\b").test(i)&&(a.push(e),this.push("module.exports."+e+" = "+e+";"))},[]).join("\n"),s=(t&&(i+="\n"+t),i+="\nreturn module.exports;",P.agent);M&&(s.chrome||s.firefox&&s.versionNumber<40)?(c=M.createElement("script"),f=M.head||M.getElementsByTagName("head")[0],s.firefox&&(i="\n"+i),c.appendChild(M.createTextNode("document.__paperscript__ = function("+a+") {"+i+"\n}")),f.appendChild(c),n=M.__paperscript__,delete M.__paperscript__,f.removeChild(c)):n=Function(a,i);var u=(t=n&&n.apply(e,h))||{};return F.each(l,function(e){var t=u[e];t&&(o[e]=t)}),r&&(u.onResize&&r.setOnResize(u.onResize),r.emit("resize",{size:r.size,delta:new A}),u.onFrame&&r.setOnFrame(u.onFrame),r.requestUpdate()),t}function s(e){if(/^text\/(?:x-|)paperscript$/.test(e.type)&&"true"!==l.getAttribute(e,"ignore")){var t=l.getAttribute(e,"canvas"),n=M.getElementById(t),i=e.src||e.getAttribute("data-src"),r=l.hasAttribute(e,"async"),o="data-paper-scope";if(!n)throw new Error('Unable to find canvas with id "'+t+'"');var s=l.get(n.getAttribute(o))||(new l).setup(n);return n.setAttribute(o,s._id),i?ue({url:i,async:r,mimeType:"text/plain",onLoad:function(e){a(e,s,i)}}):a(e.innerHTML,s,e.baseURI),e.setAttribute("data-paper-ignore","true"),s}}function o(){F.each(M&&M.getElementsByTagName("script"),s)}return A.inject(r),I.inject(r),X.inject(r),O&&("complete"===M.readyState?setTimeout(o):Q.add(O,{load:o})),{compile:v,execute:a,load:function(e){return e?s(e):o()},parse:m,calculateBinary:p,calculateUnary:g}}.call(this);var P=new(l.inject(F.exports,{Base:F,Numerical:z,Key:re,DomEvent:Q,DomElement:$,document:M,window:O,Symbol:S,PlacedSymbol:y}));return P.agent.node&&require("./node/extend.js")(P),"function"==typeof define&&define.amd?define("paper",P):"object"==typeof module&&module&&(module.exports=P),P}.call(this,"object"==typeof self?self:null);const MESH_ANNOTATIONS={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]},canvas_width=320,canvas_height=180,scale=4,videoElement=(window.canvas_width=canvas_width,window.canvas_height=canvas_height,document.getElementById("my-camera")),canvasElement=document.getElementById("my-canvas"),canvasCtx=canvasElement.getContext("2d"),metaCanvasElement=document.getElementById("my-meta"),metaCanvasCtx=metaCanvasElement.getContext("2d"),bgCanvasElement=document.getElementById("meta-bg"),bgCanvasCtx=bgCanvasElement.getContext("2d"),fgCanvasElement=(bgCanvasCtx.globalCompositeOperation="destination-over",document.getElementById("meta-fg")),fgCanvasCtx=fgCanvasElement.getContext("2d");function idx2pts(e,t){return e.map(e=>[t[e].x*canvas_width,t[e].y*canvas_height])}function part2pts(e,t,n){let i=idx2pts(e,n).sort((e,t)=>e[0]-t[0]);e=idx2pts(t,n).sort((e,t)=>t[0]-e[0]);return i.concat(e)}function onResults(t){if(1!=window.metaMode&&(canvasCtx.save(),canvasCtx.clearRect(0,0,canvasElement.width,canvasElement.height)),fgCanvasCtx.save(),fgCanvasCtx.clearRect(0,0,fgCanvasElement.width,fgCanvasElement.height),paper.project.clear(),window.fgState){if(2!=window.metaMode)if(1==window.metaMode){if(t.segmentationMask){fgCanvasCtx.translate(-10,-10);for(let e=0;e<3;e++){for(let e=0;e<3;e++)fgCanvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),fgCanvasCtx.translate(10,0);fgCanvasCtx.translate(-30,10)}fgCanvasCtx.restore(),fgCanvasCtx.save(),fgCanvasCtx.globalCompositeOperation="source-out",fgCanvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),bgCanvasCtx.drawImage(fgCanvasElement,0,0,canvas_width,canvas_height),fgCanvasCtx.clearRect(0,0,fgCanvasElement.width,fgCanvasElement.height),fgCanvasCtx.globalCompositeOperation="source-over"}}else window.bgState?(canvasCtx.fillStyle="#00FF00",canvasCtx.fillRect(0,0,canvasElement.width,canvasElement.height)):t.segmentationMask?(canvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="source-in",canvasCtx.fillStyle="#FFFFFF",canvasCtx.fillRect(0,0,canvasElement.width,canvasElement.height),canvasCtx.globalCompositeOperation="destination-atop",canvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="source-over"):canvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height);drawAvatar(t),1!=window.metaMode&&canvasCtx.drawImage(fgCanvasElement,0,0,canvas_width,canvas_height)}else if(2==window.metaMode)t.segmentationMask&&(canvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="source-in",canvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="source-over");else if(1==window.metaMode){if(t.segmentationMask){fgCanvasCtx.translate(-10,-10);for(let e=0;e<3;e++){for(let e=0;e<3;e++)fgCanvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),fgCanvasCtx.translate(10,0);fgCanvasCtx.translate(-30,10)}fgCanvasCtx.restore(),fgCanvasCtx.save(),fgCanvasCtx.globalCompositeOperation="source-out",fgCanvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),bgCanvasCtx.drawImage(fgCanvasElement,0,0,canvas_width,canvas_height),fgCanvasCtx.clearRect(0,0,fgCanvasElement.width,fgCanvasElement.height),fgCanvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),fgCanvasCtx.globalCompositeOperation="source-in",fgCanvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),fgCanvasCtx.globalCompositeOperation="source-over"}}else window.bgState&&(t.segmentationMask?(canvasCtx.drawImage(t.segmentationMask,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="source-in",canvasCtx.drawImage(t.image,0,0,canvas_width,canvas_height),canvasCtx.globalCompositeOperation="destination-atop",canvasCtx.fillStyle="#00FF00",canvasCtx.fillRect(0,0,canvasElement.width,canvasElement.height),canvasCtx.globalCompositeOperation="source-over"):(canvasCtx.fillStyle="#00FF00",canvasCtx.fillRect(0,0,canvasElement.width,canvasElement.height)));let e;if(1==window.metaMode){e=fgCanvasElement.toDataURL("image/webp",.2);let t={type:"image",from:window.my_stream_id,data_fg:e};Object.entries(window.peer_conns).forEach(e=>e[1].send(t))}else{var n;e=canvasElement.toDataURL("image/webp",.2),window.peer_conns&&window.canvasState&&(n={type:"image",from:window.my_stream_id,data:e,xpos:window.getState(window.my_stream_id).xpos},Object.entries(window.peer_conns).forEach(e=>e[1].send(n)))}if(1==window.metaMode){let t=[],n=Object.keys(window.peer_streams);n.sort();for(let e=0;e<n.length;e++){var i=n[e];window.getState(i).vid==window.my_stream_id&&t.push(function(i){return new Promise(function(e,t){var n=new Image;n.onload=()=>{e(n)},n.onerror=t,n.src=window.getState(i).image_fg})}(i))}Promise.all(t).then(function(e){canvasCtx.save(),canvasCtx.clearRect(0,0,canvasElement.width,canvasElement.height),canvasCtx.globalCompositeOperation="source-over",window.bgState?(canvasCtx.fillStyle="#00FF00",canvasCtx.fillRect(0,0,canvas_width,canvas_height)):canvasCtx.drawImage(bgCanvasElement,0,0,canvas_width,canvas_height),window.getState(window.my_stream_id).vid==window.my_stream_id&&canvasCtx.drawImage(fgCanvasElement,0,0,canvas_width,canvas_height);for(var t of e)canvasCtx.drawImage(t,0,0,canvas_width,canvas_height);canvasCtx.restore();var e=canvasElement.toDataURL("image/webp",.2),n={type:"image",from:window.my_stream_id,data:e};Object.entries(window.peer_conns).forEach(e=>e[1].send(n))}).catch(function(e){console.log(e)})}else if(2==window.metaMode){window.updateState(window.my_stream_id,{image:e});let n=Object.keys(window.all_peer_states),i=(n.sort(),[]);var o=Math.floor(metaCanvasElement.width/2),s=calcInitMetaX(n);let r=s[0];var a=s[1];for(let t=0;t<n.length;t++){var c=n[t],u=window.getState(c).xpos,l=0!=u&&!u;let e=l?r:u;l?c==window.my_stream_id&&window.updateState(c,{xpos:r-o}):e+=o,i.push(function(i,r){return new Promise(function(e,t){var n=new Image;n.onload=()=>{e([r,n])},n.onerror=t,n.src=window.all_peer_states[i].image})}(c,e)),r+=a}Promise.all(i).then(function(e){metaCanvasCtx.clearRect(0,0,metaCanvasElement.width,metaCanvasElement.height);for(var t of e){var n=t[0],t=t[1];metaCanvasCtx.drawImage(t,n,0,window.canvas_width,window.canvas_height)}metaCanvasCtx.globalCompositeOperation="destination-atop",metaCanvasCtx.fillStyle="#00FF00",metaCanvasCtx.fillRect(0,0,metaCanvasElement.width,metaCanvasElement.height),metaCanvasCtx.globalCompositeOperation="source-over"}).catch(function(e){console.log(e)})}1!=window.metaMode&&canvasCtx.restore(),fgCanvasCtx.restore()}function calcInitMetaX(e){var t=metaCanvasElement.width,n=Math.min(Math.floor(.65*window.canvas_width),Math.floor((t-window.canvas_width)/(e.length-1)));return[Math.floor((t-(n*(e.length-1)+window.canvas_width))/2),n,t-window.canvas_width]}function drawAvatar(t){var r=[],h=[];if(t.poseLandmarks){var n=idx2pts([11,12,24,23],t.poseLandmarks),i=n[0],o=n[1],s=[o[0]-i[0],o[1]-i[1]],a=[-s[1],s[0]],s=[i,[i[0]-.02*s[0]+.08*a[0],i[1]-.02*s[1]+.08*a[1]],[o[0]+.02*s[0]+.08*a[0],o[1]+.02*s[1]+.08*a[1]],o],a=(i[0],i[1],o[0],o[1],idx2pts([12,14,16],t.poseLandmarks)),i=idx2pts([11,13,15],t.poseLandmarks);let e=[{pts:n,strokeColor:"grey",fillColor:"grey"}];e.forEach(e=>r.push(e))}if(t.faceLandmarks){var o=part2pts(MESH_ANNOTATIONS.lipsUpperInner,MESH_ANNOTATIONS.lipsLowerInner,t.faceLandmarks),n=idx2pts(MESH_ANNOTATIONS.silhouette,t.faceLandmarks),c=idx2pts(MESH_ANNOTATIONS.leftEyeIris,t.faceLandmarks),d=idx2pts(MESH_ANNOTATIONS.rightEyeIris,t.faceLandmarks),f=idx2pts([2,1],t.faceLandmarks),p=idx2pts([MESH_ANNOTATIONS.silhouette[5],MESH_ANNOTATIONS.silhouette[MESH_ANNOTATIONS.silhouette.length-5]],t.faceLandmarks),g=(idx2pts([MESH_ANNOTATIONS.silhouette[5],MESH_ANNOTATIONS.silhouette[MESH_ANNOTATIONS.silhouette.length-5]],t.faceLandmarks),idx2pts(MESH_ANNOTATIONS.rightEyeUpper2.slice(1,-1),t.faceLandmarks)),v=idx2pts(MESH_ANNOTATIONS.leftEyeUpper2.slice(1,-1),t.faceLandmarks),u=c[0],l=d[0],l=(l[0],u[0],l[1],u[1],u[0],u[1],idx2pts([MESH_ANNOTATIONS.silhouette[15],MESH_ANNOTATIONS.silhouette[MESH_ANNOTATIONS.silhouette.length-15]],t.faceLandmarks));let e=[{pts:[[l[0][0]+20/scale,l[0][1]-20/scale],[l[0][0]+20/scale,l[0][1]+10/scale],[i[0][0]+40/scale,i[0][1]],[a[0][0]-40/scale,a[0][1]],[l[1][0]-20/scale,l[1][1]+10/scale],[l[1][0]-20/scale,l[1][1]-20/scale]],fillColor:"grey"},{pts:[g[1]],ellipse:"ellipse",fillColor:"black",radius:[100/scale,130/scale]},{pts:[v[1]],ellipse:"ellipse",fillColor:"black",radius:[100/scale,130/scale]},{pts:n,fillColor:"#FFCC99"},{pts:o,strokeColor:"black",fillColor:"black"},{pts:f,strokeColor:"black"},{pts:p,arc:"arc",fillColor:"black"},{pts:c,circle:"circle",fillColor:"black",radius:8/scale},{pts:d,circle:"circle",fillColor:"blue",radius:8/scale},{pts:g,strokeColor:"black",strokeWidth:3/scale},{pts:v,strokeColor:"blue",strokeWidth:3/scale}];e.forEach(e=>r.push(e))}if(t.poseLandmarks){u=idx2pts([15,17,19,21],t.poseLandmarks);let e=[{pts:s,strokeColor:"grey",fillColor:"black"},{pts:a,strokeColor:"black",strokeWidth:100/scale,smooth:1},{pts:[[a[0][0]-10/scale,a[0][1]-10/scale]],fillColor:"black",circle:"circle",radius:80/scale},{pts:i,strokeColor:"blue",strokeWidth:100/scale,smooth:1},{pts:[[i[0][0]-10/scale,i[0][1]-10/scale]],fillColor:"blue",circle:"circle",radius:80/scale},{pts:u,strokeColor:"black",strokeWidth:1}];e.forEach(e=>r.push(e))}if(0<r.length){for(let i=0;i<r.length;i++){let t=r[i],n=new paper.Path,e=("circle"in t?n=new paper.Path.Circle({center:t.pts[0],radius:t.radius}):"ellipse"in t?n=new paper.Path.Ellipse({center:t.pts[0],radius:t.radius}):"arc"in t||(t.pts.forEach(e=>n.add(new paper.Point(e[0],e[1]))),"smooth"in t&&n.smooth()),["strokeColor","strokeWidth","fillColor"]);e.forEach(e=>{e in t&&(n[e]=t[e])}),h.push(n)}paper.view.update()}}function logKey(n){if([45,46].includes(n.keyCode))if(2!=window.metaMode){45==n.keyCode?window.bgState=!window.bgState:46==n.keyCode&&(window.fgState=!window.fgState);var i=window.bgState||window.fgState||1==window.metaMode;if(window.canvasState!=i){i?window.frame_rate=window.frame_rate_bk:(window.frame_rate_bk=window.frame_rate,window.frame_rate=10);let e=document.getElementById("camera-col"),t=document.getElementById("canvas-col");e&&(e.className="view-col col-md-6 col-lg-6 col-md-offset-3 col-lg-offset-3"+(i?" hidden":""),t.className="view-col col-md-6 col-lg-6 col-md-offset-3 col-lg-offset-3"+(i?"":" hidden"))}window.canvasState=i;let t={type:"state",stream_id:window.my_stream_id,canvas:window.canvasState};Object.entries(window.peer_conns).forEach(e=>e[1].send(t))}else 46==n.keyCode&&(window.fgState=!window.fgState);else if([145,120,121].includes(n.keyCode)){if(145==n.keyCode){window.metaMode=(window.metaMode+1)%3,window.toggleMetaView();let e=document.getElementById("room-id");0==window.metaMode?e.innerHTML=e.innerHTML.replaceAll("Metaverse","Room"):e.innerHTML=e.innerHTML.replaceAll("Room","Metaverse")}else 120==n.keyCode?window.frame_rate+=1:121==n.keyCode&&--window.frame_rate;window.frame_rate=Math.min(Math.max(1,window.frame_rate),10),console.log("frame rate: "+window.frame_rate);let t={type:"config",config:{metaMode:window.metaMode,frame_rate:window.frame_rate}};Object.entries(window.peer_conns).forEach(e=>e[1].send(t))}else if(["{","}"].includes(n.key)){if(2==window.metaMode){i=Math.floor(metaCanvasElement.width/2);let e=window.getState(window.my_stream_id).xpos,t=(e=i+e,Object.keys(window.all_peer_states));t.sort();var r=calcInitMetaX(t),o=r[2];if(null==e&&(s=r[0],r=r[1],e=s+t.indexOf(window.my_stream_id)*r),e){e+="{"==n.key?10:-10,e%=o,e+=e<0?o:0,e-=i,window.updateState(window.my_stream_id,{xpos:e});let t={type:"state",stream_id:window.my_stream_id,xpos:e};Object.entries(window.peer_conns).forEach(e=>e[1].send(t))}}else if(1==window.metaMode){var s=window.getState(window.my_stream_id).vid||window.my_stream_id;let e=Object.keys(window.peer_streams);e.unshift(window.my_stream_id);r=e.indexOf(s),r=(r=(r+="{"==n.key?-1:1)%e.length)+(r<0?e.length:0),s=e[r];window.updateState(window.my_stream_id,{vid:s});let t={type:"state",stream_id:window.my_stream_id,vid:s};Object.entries(window.peer_conns).forEach(e=>e[1].send(t))}}else 13==n.keyCode&&window.sendMessage()}metaCanvasElement.width=window.innerWidth,window.addEventListener("resize",()=>{metaCanvasElement.width=window.innerWidth},!1),paper.setup(fgCanvasElement),window.frame_rate=10,window.frame_rate_bk=3,document.addEventListener("keydown",logKey);const holistic=new Holistic({locateFile:e=>"https://cdn.jsdelivr.net/npm/@mediapipe/holistic/"+e});holistic.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!0,smoothSegmentation:!0,refineFaceLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),holistic.onResults(onResults);var frame_cnt=0;const camera=new Camera(videoElement,{onFrame:async()=>{frame_cnt%window.frame_rate==0&&(await holistic.send({image:videoElement}),frame_cnt=0),frame_cnt+=1},width:canvas_width,height:canvas_height});camera.start();